<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>商品交易智能合约设计与实现</title>
      <link href="/2025/08/28/%E5%95%86%E5%93%81%E4%BA%A4%E6%98%93%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
      <url>/2025/08/28/%E5%95%86%E5%93%81%E4%BA%A4%E6%98%93%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在传统电子商务平台中，交易过程通常需要依赖第三方机构来确保安全和信任。而区块链技术的出现为我们提供了构建去中心化商品交易系统的可能性，通过智能合约可以实现自动化交易流程，无需中间商介入，大幅降低交易成本并提高效率。</p><p>本文将详细介绍一个基于Solidity语言开发的商品交易智能合约，该合约实现了商品上架、更新、下架、订单创建、支付等核心功能，可以作为去中心化电子商务应用的基础。</p><h2 id="智能合约代码"><a href="#智能合约代码" class="headerlink" title="智能合约代码"></a>智能合约代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.6.10;</span><br><span class="line"></span><br><span class="line">// 商品交易市场合约</span><br><span class="line">contract ProductMarket &#123;</span><br><span class="line">    // 商品结构体，存储商品的所有属性</span><br><span class="line">    struct Product &#123;</span><br><span class="line">        uint256 id;           // 商品唯一标识</span><br><span class="line">        string name;          // 商品名称</span><br><span class="line">        string description;   // 商品描述</span><br><span class="line">        uint256 price;        // 商品价格（单位：wei）</span><br><span class="line">        uint256 inventory;    // 库存数量</span><br><span class="line">        address seller;       // 卖家地址</span><br><span class="line">        bool isValid;         // 商品是否有效（未下架）</span><br><span class="line">        uint256 createTime;   // 上架时间</span><br><span class="line">        uint256 updateTime;   // 最后更新时间</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 订单结构体，记录交易信息</span><br><span class="line">    struct Order &#123;</span><br><span class="line">        uint256 orderId;      // 订单唯一标识</span><br><span class="line">        uint256 productId;    // 关联的商品ID</span><br><span class="line">        address buyer;        // 买家地址</span><br><span class="line">        uint256 quantity;     // 购买数量</span><br><span class="line">        uint256 totalPrice;   // 总价（单位：wei）</span><br><span class="line">        uint256 timestamp;    // 订单创建时间</span><br><span class="line">        bool isPaid;          // 是否已支付</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 状态变量</span><br><span class="line">    mapping(uint256 =&gt; Product) public products; // 商品ID到商品信息的映射</span><br><span class="line">    mapping(uint256 =&gt; Order) public orders;     // 订单ID到订单信息的映射</span><br><span class="line">    uint256 public productCount;                 // 商品总数（同时作为商品ID生成器）</span><br><span class="line">    uint256 public orderCount;                   // 订单总数（同时作为订单ID生成器）</span><br><span class="line">    </span><br><span class="line">    // 事件定义，用于记录合约状态变化并通知前端应用</span><br><span class="line">    event ProductListed(uint256 indexed productId, string name, uint256 price, uint256 inventory, address seller);</span><br><span class="line">    event ProductUpdated(uint256 indexed productId, string name, string description, uint256 price, uint256 inventory, uint256 updateTime);</span><br><span class="line">    event ProductRemoved(uint256 indexed productId);</span><br><span class="line">    event OrderCreated(uint256 indexed orderId, uint256 productId, address buyer, uint256 quantity, uint256 totalPrice);</span><br><span class="line">    event OrderPaid(uint256 indexed orderId, address buyer, uint256 amount);</span><br><span class="line">    </span><br><span class="line">    // 上架新商品</span><br><span class="line">    function listProduct(string memory _name, string memory _description, uint256 _price, uint256 _inventory) public returns (uint256) &#123;</span><br><span class="line">        require(_price &gt; 0, &quot;价格必须大于0&quot;);</span><br><span class="line">        require(_inventory &gt; 0, &quot;库存必须大于0&quot;);</span><br><span class="line">        </span><br><span class="line">        productCount++;</span><br><span class="line">        products[productCount] = Product(</span><br><span class="line">            productCount,</span><br><span class="line">            _name,</span><br><span class="line">            _description,</span><br><span class="line">            _price,</span><br><span class="line">            _inventory,</span><br><span class="line">            msg.sender,</span><br><span class="line">            true,</span><br><span class="line">            block.timestamp,</span><br><span class="line">            block.timestamp</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        emit ProductListed(productCount, _name, _price, _inventory, msg.sender);</span><br><span class="line">        return productCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 更新商品信息（仅卖家可操作）</span><br><span class="line">    function updateProduct(uint256 _productId, string memory _name, string memory _description, uint256 _price, uint256 _inventory) public &#123;</span><br><span class="line">        Product storage product = products[_productId];</span><br><span class="line">        </span><br><span class="line">        // 安全检查</span><br><span class="line">        require(product.isValid, &quot;商品不存在或已下架&quot;);</span><br><span class="line">        require(product.seller == msg.sender, &quot;只有卖家可以更新商品&quot;);</span><br><span class="line">        require(_price &gt; 0, &quot;价格必须大于0&quot;);</span><br><span class="line">        require(_inventory &gt;= 0, &quot;库存不能为负&quot;);</span><br><span class="line"></span><br><span class="line">        // 更新商品信息</span><br><span class="line">        product.name = _name;</span><br><span class="line">        product.description = _description;</span><br><span class="line">        product.price = _price;</span><br><span class="line">        product.inventory = _inventory;</span><br><span class="line">        product.updateTime = block.timestamp;</span><br><span class="line"></span><br><span class="line">        // 触发更新事件</span><br><span class="line">        emit ProductUpdated(_productId, _name, _description, _price, _inventory, block.timestamp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 下架商品（仅卖家可操作）</span><br><span class="line">    function removeProduct(uint256 _productId) public &#123;</span><br><span class="line">        Product storage product = products[_productId];</span><br><span class="line">        require(product.isValid, &quot;商品不存在&quot;);</span><br><span class="line">        require(product.seller == msg.sender, &quot;只有卖家可以下架商品&quot;);</span><br><span class="line">        product.isValid = false;</span><br><span class="line">        emit ProductRemoved(_productId);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 创建订单</span><br><span class="line">    function createOrder(uint256 _productId, uint256 _quantity) public returns (uint256) &#123;</span><br><span class="line">        require(products[_productId].isValid, &quot;商品不存在&quot;);</span><br><span class="line">        require(products[_productId].inventory &gt;= _quantity, &quot;库存不足&quot;);</span><br><span class="line">        require(_quantity &gt; 0, &quot;购买数量必须大于0&quot;);</span><br><span class="line">        </span><br><span class="line">        Product storage product = products[_productId];</span><br><span class="line">        uint256 totalPrice = product.price * _quantity;</span><br><span class="line">        </span><br><span class="line">        orderCount++;</span><br><span class="line">        orders[orderCount] = Order(</span><br><span class="line">            orderCount,</span><br><span class="line">            _productId,</span><br><span class="line">            msg.sender,</span><br><span class="line">            _quantity,</span><br><span class="line">            totalPrice,</span><br><span class="line">            block.timestamp,</span><br><span class="line">            false</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        // 预扣库存</span><br><span class="line">        product.inventory -= _quantity;</span><br><span class="line">        </span><br><span class="line">        emit OrderCreated(orderCount, _productId, msg.sender, _quantity, totalPrice);</span><br><span class="line">        return orderCount;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 支付订单</span><br><span class="line">    function payOrder(uint256 _orderId) public payable &#123;</span><br><span class="line">        Order storage order = orders[_orderId];</span><br><span class="line">        </span><br><span class="line">        // 安全检查</span><br><span class="line">        require(!order.isPaid, &quot;订单已支付&quot;);</span><br><span class="line">        require(order.buyer == msg.sender, &quot;只有买家可以支付订单&quot;);</span><br><span class="line">        require(msg.value == order.totalPrice, &quot;支付金额不正确&quot;);</span><br><span class="line">        </span><br><span class="line">        // 更新订单状态</span><br><span class="line">        order.isPaid = true;</span><br><span class="line">        </span><br><span class="line">        // 转账给卖家</span><br><span class="line">        address payable seller = payable(products[order.productId].seller);</span><br><span class="line">        seller.transfer(msg.value);</span><br><span class="line">        </span><br><span class="line">        // 触发支付事件</span><br><span class="line">        emit OrderPaid(_orderId, msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 查询商品信息</span><br><span class="line">    function getProduct(uint256 _productId) public view returns (</span><br><span class="line">        uint256 id,</span><br><span class="line">        string memory name,</span><br><span class="line">        string memory description,</span><br><span class="line">        uint256 price,</span><br><span class="line">        uint256 inventory,</span><br><span class="line">        address seller,</span><br><span class="line">        bool isValid,</span><br><span class="line">        uint256 createTime,</span><br><span class="line">        uint256 updateTime</span><br><span class="line">    ) &#123;</span><br><span class="line">        Product memory product = products[_productId];</span><br><span class="line">        return (</span><br><span class="line">            product.id,</span><br><span class="line">            product.name,</span><br><span class="line">            product.description,</span><br><span class="line">            product.price,</span><br><span class="line">            product.inventory,</span><br><span class="line">            product.seller,</span><br><span class="line">            product.isValid,</span><br><span class="line">            product.createTime,</span><br><span class="line">            product.updateTime</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 查询订单信息</span><br><span class="line">    function getOrder(uint256 _orderId) public view returns (</span><br><span class="line">        uint256 orderId,</span><br><span class="line">        uint256 productId,</span><br><span class="line">        address buyer,</span><br><span class="line">        uint256 quantity,</span><br><span class="line">        uint256 totalPrice,</span><br><span class="line">        uint256 timestamp,</span><br><span class="line">        bool isPaid</span><br><span class="line">    ) &#123;</span><br><span class="line">        Order memory order = orders[_orderId];</span><br><span class="line">        return (</span><br><span class="line">            order.orderId,</span><br><span class="line">            order.productId,</span><br><span class="line">            order.buyer,</span><br><span class="line">            order.quantity,</span><br><span class="line">            order.totalPrice,</span><br><span class="line">            order.timestamp,</span><br><span class="line">            order.isPaid</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合约功能详解"><a href="#合约功能详解" class="headerlink" title="合约功能详解"></a>合约功能详解</h2><h3 id="数据结构设计"><a href="#数据结构设计" class="headerlink" title="数据结构设计"></a>数据结构设计</h3><ol><li><p>**商品结构体 (Product)**：</p><ul><li>包含ID、名称、描述、价格、库存等基本信息</li><li>记录商品状态（是否有效）和时间信息（创建时间、更新时间）</li><li>关联卖家地址，实现权限控制</li></ul></li><li><p>**订单结构体 (Order)**：</p><ul><li>记录订单ID、关联商品、购买数量、总价等交易信息</li><li>保存买家地址和支付状态，确保交易安全</li></ul></li></ol><h3 id="核心功能实现"><a href="#核心功能实现" class="headerlink" title="核心功能实现"></a>核心功能实现</h3><ol><li><p><strong>商品管理</strong></p><ul><li>上架新商品 (<code>listProduct</code>)：创建并发布新商品</li><li>更新商品信息 (<code>updateProduct</code>)：修改价格、描述或库存</li><li>下架商品 (<code>removeProduct</code>)：将商品标记为无效</li></ul></li><li><p><strong>订单处理</strong></p><ul><li>创建订单 (<code>createOrder</code>)：锁定商品库存，记录交易意向</li><li>支付订单 (<code>payOrder</code>)：完成货币转移，确认交易完成</li></ul></li><li><p><strong>查询功能</strong></p><ul><li>获取商品详情 (<code>getProduct</code>)：查看完整商品信息</li><li>获取订单详情 (<code>getOrder</code>)：查看完整订单信息</li></ul></li></ol><h3 id="安全机制"><a href="#安全机制" class="headerlink" title="安全机制"></a>安全机制</h3><ol><li><p><strong>权限控制</strong>：</p><ul><li>只有卖家能更新或下架自己的商品</li><li>只有买家能支付自己创建的订单</li></ul></li><li><p><strong>状态验证</strong>：</p><ul><li>购买前检查商品是否有效及库存是否充足</li><li>支付前验证金额是否正确</li></ul></li><li><p><strong>事件通知</strong>：</p><ul><li>所有关键操作均触发事件，方便跟踪交易状态变化</li><li>便于前端应用实时更新界面</li></ul></li></ol><h2 id="实际应用场景"><a href="#实际应用场景" class="headerlink" title="实际应用场景"></a>实际应用场景</h2><p>该智能合约可用于以下去中心化应用场景：</p><ol><li><strong>去中心化电商平台</strong>：无需第三方担保，直接连接买卖双方</li><li><strong>二手商品交易</strong>：透明记录物品所有权变更</li><li><strong>数字资产交易</strong>：适用于NFT等数字藏品交易</li><li><strong>跨境贸易</strong>：无需中间机构，降低国际交易成本</li></ol><h2 id="改进方向"><a href="#改进方向" class="headerlink" title="改进方向"></a>改进方向</h2><p>虽然当前合约已具备基本功能，但仍有以下改进空间：</p><ol><li><strong>退款机制</strong>：增加取消订单和退款功能</li><li><strong>评价系统</strong>：添加交易后的评价机制</li><li><strong>安全增强</strong>：<ul><li>实现重入攻击保护</li><li>添加交易超时处理</li></ul></li><li><strong>批量操作</strong>：支持批量上架和购买功能</li><li><strong>费用模型</strong>：引入平台服务费机制</li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文介绍的商品交易智能合约展示了如何在区块链上实现基础的电子商务功能。通过Solidity语言，我们可以构建一个去中心化、自治的交易系统，无需依赖第三方中介。</p><p>智能合约的透明性和不可篡改性为交易各方提供了更高的信任度，同时区块链技术的应用也为传统电子商务带来了革命性的变化。随着技术的不断发展，我们可以期待更加完善的去中心化商业生态系统的出现。</p><hr><blockquote><p><strong>注意</strong>：本合约仅用于教学目的，实际生产环境使用前需进行安全审计和功能测试。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 区块链 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop安装</title>
      <link href="/2025/06/29/Hadoop%E5%AE%89%E8%A3%85/"/>
      <url>/2025/06/29/Hadoop%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<p>前提条件安装jdk</p><h3 id="配置hostname"><a href="#配置hostname" class="headerlink" title="配置hostname"></a>配置hostname</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi  /etc/hosts</span><br><span class="line">hostname my.hadoop.cn</span><br></pre></td></tr></table></figure><h3 id="新建用户hadoop"><a href="#新建用户hadoop" class="headerlink" title="新建用户hadoop"></a>新建用户hadoop</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">useradd hadoop</span><br><span class="line">passwd hadoop</span><br><span class="line"><span class="built_in">chmod</span> u + w /etc/sudoers</span><br><span class="line">vim /etc/sudoers</span><br><span class="line"><span class="comment">#在root ALL=(ALL)ALL下添加hadoop ALL(ALL)ALL</span></span><br><span class="line"><span class="built_in">chmod</span> u - w /etc/sudoers</span><br></pre></td></tr></table></figure><h3 id="配置ssh"><a href="#配置ssh" class="headerlink" title="配置ssh"></a>配置ssh</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -P &#x27;&#x27; -f ~/.ssh/id_rsa</span><br><span class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">chmod 0600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><h3 id="安装hadoop"><a href="#安装hadoop" class="headerlink" title="安装hadoop"></a>安装hadoop</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /soft</span><br><span class="line"></span><br><span class="line">tar -zxvf hadoop-3.3.5.tar.gz -C /soft/</span><br><span class="line"></span><br><span class="line">sudo <span class="built_in">chown</span> -R hadoop:hadoop /soft/hadoop-3.3.5</span><br></pre></td></tr></table></figure><h3 id="配置JAVA-HOME"><a href="#配置JAVA-HOME" class="headerlink" title="配置JAVA_HOME"></a>配置JAVA_HOME</h3><p><font style="color:rgb(77, 77, 77);">进入&#x2F;soft&#x2F;hadoop-3.3.5，编辑文件etc&#x2F;hadoop&#x2F;hadoop-env.sh配置JAVA_HOME</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_231-amd64</span><br></pre></td></tr></table></figure><h3 id="配置HADOOP-HOME"><a href="#配置HADOOP-HOME" class="headerlink" title="配置HADOOP_HOME"></a>配置HADOOP_HOME</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HADOOP_HOME=/soft/hadoop-3.3.5</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HADOOP_HOME</span>/bin</span><br></pre></td></tr></table></figure><h3 id="编辑etc-x2F-hadoop-x2F-core-site-xml文件"><a href="#编辑etc-x2F-hadoop-x2F-core-site-xml文件" class="headerlink" title="编辑etc&#x2F;hadoop&#x2F;core-site.xml文件"></a>编辑etc&#x2F;hadoop&#x2F;core-site.xml文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://my.hadoop.cn:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/soft/hadoop-3.3.5/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编辑etc-x2F-hadoop-x2F-hdfs-site-xml文件"><a href="#编辑etc-x2F-hadoop-x2F-hdfs-site-xml文件" class="headerlink" title="编辑etc&#x2F;hadoop&#x2F;hdfs-site.xml文件"></a>编辑etc&#x2F;hadoop&#x2F;hdfs-site.xml文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编辑文件etc-x2F-hadoop-x2F-mapred-site-xml，添加如下配置"><a href="#编辑文件etc-x2F-hadoop-x2F-mapred-site-xml，添加如下配置" class="headerlink" title="编辑文件etc&#x2F;hadoop&#x2F;mapred-site.xml，添加如下配置"></a>编辑文件etc&#x2F;hadoop&#x2F;mapred-site.xml，添加如下配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编辑文件etc-x2F-hadoop-x2F-yarn-site-xml"><a href="#编辑文件etc-x2F-hadoop-x2F-yarn-site-xml" class="headerlink" title="编辑文件etc&#x2F;hadoop&#x2F;yarn-site.xml"></a>编辑文件etc&#x2F;hadoop&#x2F;yarn-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="格式化hdfs"><a href="#格式化hdfs" class="headerlink" title="格式化hdfs"></a>格式化hdfs</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./start-all.sh</span><br></pre></td></tr></table></figure><h3 id="添加hdfs权限"><a href="#添加hdfs权限" class="headerlink" title="添加hdfs权限"></a>添加hdfs权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">chmod</span> 777 /</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对称加密（AES）</title>
      <link href="/2025/06/29/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%88AES%EF%BC%89/"/>
      <url>/2025/06/29/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%88AES%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AESUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;aes.secret.key&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String secretKey;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;aes.iv&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String iv;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">decrypt</span><span class="params">(String encryptedText)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">IvParameterSpec</span> <span class="variable">ivSpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IvParameterSpec</span>(iv.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        <span class="type">SecretKeySpec</span> <span class="variable">skeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(secretKey.getBytes(StandardCharsets.UTF_8), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS5PADDING&quot;</span>);</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE, skeySpec, ivSpec);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] original = cipher.doFinal(Base64.getDecoder().decode(encryptedText));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(original, StandardCharsets.UTF_8);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encrypt</span><span class="params">(String plainText)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">IvParameterSpec</span> <span class="variable">ivSpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IvParameterSpec</span>(iv.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        <span class="type">SecretKeySpec</span> <span class="variable">skeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(secretKey.getBytes(StandardCharsets.UTF_8), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS5PADDING&quot;</span>);</span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, skeySpec, ivSpec);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] encrypted = cipher.doFinal(plainText.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder().encodeToString(encrypted);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyspark的使用</title>
      <link href="/2025/06/29/pyspark%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2025/06/29/pyspark%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="data-csv-示例"><a href="#data-csv-示例" class="headerlink" title="data.csv 示例"></a>data.csv 示例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">员工ID,部门,工作年限,学历,沟通能力,团队协作,问题解决,学习能力,创新能力,能力得分</span><br><span class="line"><span class="number">1</span>,技术部,<span class="number">1</span>,本科,<span class="number">70</span>,<span class="number">80</span>,<span class="number">75</span>,<span class="number">85</span>,<span class="number">60</span>,<span class="number">75</span></span><br><span class="line"><span class="number">2</span>,技术部,<span class="number">2</span>,本科,<span class="number">72</span>,<span class="number">82</span>,<span class="number">77</span>,<span class="number">87</span>,<span class="number">62</span>,<span class="number">77</span></span><br><span class="line"><span class="number">3</span>,技术部,<span class="number">3</span>,硕士,<span class="number">75</span>,<span class="number">85</span>,<span class="number">80</span>,<span class="number">90</span>,<span class="number">65</span>,<span class="number">80</span></span><br><span class="line"><span class="number">4</span>,市场部,<span class="number">1</span>,大专,<span class="number">60</span>,<span class="number">70</span>,<span class="number">65</span>,<span class="number">75</span>,<span class="number">50</span>,<span class="number">65</span></span><br><span class="line"><span class="number">5</span>,市场部,<span class="number">2</span>,本科,<span class="number">62</span>,<span class="number">72</span>,<span class="number">67</span>,<span class="number">77</span>,<span class="number">52</span>,<span class="number">67</span></span><br><span class="line"><span class="number">6</span>,市场部,<span class="number">3</span>,本科,<span class="number">65</span>,<span class="number">75</span>,<span class="number">70</span>,<span class="number">80</span>,<span class="number">55</span>,<span class="number">70</span></span><br><span class="line"><span class="number">7</span>,财务部,<span class="number">1</span>,大专,<span class="number">65</span>,<span class="number">70</span>,<span class="number">75</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">70</span></span><br><span class="line"><span class="number">8</span>,财务部,<span class="number">2</span>,本科,<span class="number">67</span>,<span class="number">72</span>,<span class="number">77</span>,<span class="number">82</span>,<span class="number">62</span>,<span class="number">72</span></span><br><span class="line"><span class="number">9</span>,财务部,<span class="number">3</span>,本科,<span class="number">70</span>,<span class="number">75</span>,<span class="number">80</span>,<span class="number">85</span>,<span class="number">65</span>,<span class="number">75</span></span><br><span class="line"><span class="number">10</span>,人力资源部,<span class="number">1</span>,本科,<span class="number">70</span>,<span class="number">75</span>,<span class="number">80</span>,<span class="number">85</span>,<span class="number">70</span>,<span class="number">78</span></span><br><span class="line"><span class="number">11</span>,人力资源部,<span class="number">2</span>,本科,<span class="number">72</span>,<span class="number">77</span>,<span class="number">82</span>,<span class="number">87</span>,<span class="number">72</span>,<span class="number">80</span></span><br><span class="line"><span class="number">12</span>,人力资源部,<span class="number">3</span>,硕士,<span class="number">75</span>,<span class="number">80</span>,<span class="number">85</span>,<span class="number">90</span>,<span class="number">75</span>,<span class="number">83</span></span><br></pre></td></tr></table></figure><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author: Reisen7</span></span><br><span class="line"><span class="string">Date: 2025-03-11 18:00:09</span></span><br><span class="line"><span class="string">LastEditTime: 2025-03-11 18:27:20</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"><span class="keyword">import</span> pyspark.sql.functions <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 HADOOP_HOME 和 hadoop.home.dir 环境变量</span></span><br><span class="line">os.environ[<span class="string">&quot;HADOOP_HOME&quot;</span>] = os.path.join(BASE_DIR, <span class="string">&quot;hadoop-3.3.5&quot;</span>)</span><br><span class="line">os.environ[<span class="string">&quot;hadoop.home.dir&quot;</span>] = os.path.join(BASE_DIR, <span class="string">&quot;hadoop-3.3.5&quot;</span>)</span><br><span class="line">os.environ[<span class="string">&#x27;PYSPARK_PYTHON&#x27;</span>] = <span class="string">r&#x27;F:/usr/anaconda3/envs/hadoop_env/python.exe&#x27;</span> <span class="comment">#写你自己的路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 SparkSession</span></span><br><span class="line">spark = SparkSession.builder \</span><br><span class="line">.appName(<span class="string">&quot;TalentAnalysis&quot;</span>) \</span><br><span class="line">.config(<span class="string">&quot;spark.driver.extraClassPath&quot;</span>, <span class="string">&quot;mysql-connector-java-8.0.32.jar&quot;</span>) \</span><br><span class="line">.config(<span class="string">&quot;spark.executor.extraClassPath&quot;</span>, <span class="string">&quot;mysql-connector-java-8.0.32.jar&quot;</span>) \</span><br><span class="line">.config(<span class="string">&quot;spark.python.executable&quot;</span>, <span class="string">&quot;F:/usr/anaconda3/envs/hadoop_env/python.exe&quot;</span>) \</span><br><span class="line">.getOrCreate()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据，假设数据为 CSV 格式</span></span><br><span class="line">data = spark.read.csv(<span class="string">&quot;data.csv&quot;</span>, header=<span class="literal">True</span>, inferSchema=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库连接配置</span></span><br><span class="line">jdbc_url = <span class="string">&quot;jdbc:mysql://localhost:3306/talent_capability_analysis?useUnicode=true&amp;characterEncoding=utf-8&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=GMT%2B8&quot;</span></span><br><span class="line">connection_properties = &#123;</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    <span class="string">&quot;driver&quot;</span>: <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 不同部门员工平均能力得分（柱状图）</span></span><br><span class="line">department_avg_score = data.groupBy(<span class="string">&quot;部门&quot;</span>) \</span><br><span class="line">.agg(F.avg(<span class="string">&quot;能力得分&quot;</span>).alias(<span class="string">&quot;avg_score&quot;</span>))</span><br><span class="line">department_avg_score.write.jdbc(url=jdbc_url, table=<span class="string">&quot;department_avg_score&quot;</span>, mode=<span class="string">&quot;overwrite&quot;</span>, properties=connection_properties)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 员工能力得分随工作年限变化（折线图）</span></span><br><span class="line">score_by_work_years = data.groupBy(<span class="string">&quot;工作年限&quot;</span>) \</span><br><span class="line">.agg(F.avg(<span class="string">&quot;能力得分&quot;</span>).alias(<span class="string">&quot;avg_score&quot;</span>))</span><br><span class="line">score_by_work_years.write.jdbc(url=jdbc_url, table=<span class="string">&quot;score_by_work_years&quot;</span>, mode=<span class="string">&quot;overwrite&quot;</span>, properties=connection_properties)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 不同学历员工占比（饼图）</span></span><br><span class="line">total_count = data.count()</span><br><span class="line">education_ratio = data.groupBy(<span class="string">&quot;学历&quot;</span>) \</span><br><span class="line">.agg(F.count(<span class="string">&quot;*&quot;</span>).alias(<span class="string">&quot;count&quot;</span>)) \</span><br><span class="line">.withColumn(<span class="string">&quot;ratio&quot;</span>, F.col(<span class="string">&quot;count&quot;</span>) / total_count) \</span><br><span class="line">.select(<span class="string">&quot;学历&quot;</span>, <span class="string">&quot;ratio&quot;</span>)</span><br><span class="line">education_ratio.write.jdbc(url=jdbc_url, table=<span class="string">&quot;education_ratio&quot;</span>, mode=<span class="string">&quot;overwrite&quot;</span>, properties=connection_properties)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 员工各项能力得分分布（雷达图）</span></span><br><span class="line">ability_columns = [<span class="string">&quot;沟通能力&quot;</span>, <span class="string">&quot;团队协作&quot;</span>, <span class="string">&quot;问题解决&quot;</span>, <span class="string">&quot;学习能力&quot;</span>, <span class="string">&quot;创新能力&quot;</span>]</span><br><span class="line">ability_distribution = []</span><br><span class="line"><span class="keyword">for</span> ability <span class="keyword">in</span> ability_columns:</span><br><span class="line">    avg_score = data.agg(F.avg(ability)).collect()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ability_distribution.append((ability, avg_score))</span><br><span class="line"></span><br><span class="line">ability_distribution_df = spark.createDataFrame(ability_distribution, [<span class="string">&quot;ability&quot;</span>, <span class="string">&quot;avg_score&quot;</span>])</span><br><span class="line">ability_distribution_df.write.jdbc(url=jdbc_url, table=<span class="string">&quot;ability_distribution&quot;</span>, mode=<span class="string">&quot;overwrite&quot;</span>, properties=connection_properties)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 员工工作经验与能力得分关系（散点图）</span></span><br><span class="line">experience_score_relation = data.select(<span class="string">&quot;工作年限&quot;</span>, <span class="string">&quot;能力得分&quot;</span>)</span><br><span class="line">experience_score_relation.write.jdbc(url=jdbc_url, table=<span class="string">&quot;experience_score_relation&quot;</span>, mode=<span class="string">&quot;overwrite&quot;</span>, properties=connection_properties)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 不同部门员工能力得分分布（箱线图）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_boxplot_stats</span>(<span class="params">score_list</span>):</span><br><span class="line">    score_array = np.array(score_list)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="built_in">float</span>(np.<span class="built_in">min</span>(score_array)),</span><br><span class="line">        <span class="built_in">float</span>(np.percentile(score_array, <span class="number">25</span>)),</span><br><span class="line">        <span class="built_in">float</span>(np.percentile(score_array, <span class="number">50</span>)),</span><br><span class="line">        <span class="built_in">float</span>(np.percentile(score_array, <span class="number">75</span>)),</span><br><span class="line">        <span class="built_in">float</span>(np.<span class="built_in">max</span>(score_array))</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">udf_calculate_boxplot_stats = F.udf(calculate_boxplot_stats, <span class="string">&quot;struct&lt;minimum:float,q1:float,median:float,q3:float,maximum:float&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">department_score_distribution = data.groupBy(<span class="string">&quot;部门&quot;</span>) \</span><br><span class="line">    .agg(F.collect_list(<span class="string">&quot;能力得分&quot;</span>).alias(<span class="string">&quot;score_list&quot;</span>)) \</span><br><span class="line">    .withColumn(<span class="string">&quot;boxplot_stats&quot;</span>, udf_calculate_boxplot_stats(F.col(<span class="string">&quot;score_list&quot;</span>))) \</span><br><span class="line">    .select(<span class="string">&quot;部门&quot;</span>,</span><br><span class="line">            F.col(<span class="string">&quot;boxplot_stats.minimum&quot;</span>).alias(<span class="string">&quot;minimum&quot;</span>),</span><br><span class="line">            F.col(<span class="string">&quot;boxplot_stats.q1&quot;</span>).alias(<span class="string">&quot;q1&quot;</span>),</span><br><span class="line">            F.col(<span class="string">&quot;boxplot_stats.median&quot;</span>).alias(<span class="string">&quot;median&quot;</span>),</span><br><span class="line">            F.col(<span class="string">&quot;boxplot_stats.q3&quot;</span>).alias(<span class="string">&quot;q3&quot;</span>),</span><br><span class="line">            F.col(<span class="string">&quot;boxplot_stats.maximum&quot;</span>).alias(<span class="string">&quot;maximum&quot;</span>))</span><br><span class="line"></span><br><span class="line">department_score_distribution.write.jdbc(url=jdbc_url, table=<span class="string">&quot;department_score_distribution&quot;</span>, mode=<span class="string">&quot;overwrite&quot;</span>, properties=connection_properties)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止 SparkSession</span></span><br><span class="line">spark.stop()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java实现SHA-256加密</title>
      <link href="/2025/06/29/Java%E5%AE%9E%E7%8E%B0SHA-256%20%E5%8A%A0%E5%AF%86/"/>
      <url>/2025/06/29/Java%E5%AE%9E%E7%8E%B0SHA-256%20%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.utils;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author reisen7</span></span><br><span class="line"><span class="comment"> * Date 2025/4/17 22:53</span></span><br><span class="line"><span class="comment"> * Description</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SaltedHash</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用盐值和密码生成哈希，并在内部生成盐值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">hashPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="comment">// 生成随机盐值</span></span><br><span class="line">        <span class="type">byte</span>[] salt = generateSalt(<span class="number">16</span>); <span class="comment">// 生成16字节的盐值</span></span><br><span class="line"></span><br><span class="line">        <span class="type">MessageDigest</span> <span class="variable">md</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            md = MessageDigest.getInstance(<span class="string">&quot;SHA-256&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        md.update(salt); <span class="comment">// 添加盐值</span></span><br><span class="line">        md.update(password.getBytes()); <span class="comment">// 添加密码</span></span><br><span class="line">        <span class="type">byte</span>[] hashedPassword = md.digest();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将盐值与哈希密码一起返回</span></span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder().encodeToString(salt) + <span class="string">&quot;:&quot;</span> + Base64.getEncoder().encodeToString(hashedPassword);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成随机盐值</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] generateSalt(<span class="type">int</span> length) &#123;</span><br><span class="line">        <span class="type">SecureRandom</span> <span class="variable">sr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecureRandom</span>();</span><br><span class="line">        <span class="type">byte</span>[] salt = <span class="keyword">new</span> <span class="title class_">byte</span>[length];</span><br><span class="line">        sr.nextBytes(salt);</span><br><span class="line">        <span class="keyword">return</span> salt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证输入的密码</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">verifyPassword</span><span class="params">(String inputPassword, String storedSaltedHashedPassword)</span> &#123;</span><br><span class="line">        <span class="comment">// 从存储的盐值哈希密码中提取盐值和哈希密码</span></span><br><span class="line">        String[] parts = storedSaltedHashedPassword.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">        <span class="type">byte</span>[] salt = Base64.getDecoder().decode(parts[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">String</span> <span class="variable">storedHashedPassword</span> <span class="operator">=</span> parts[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用相同的盐值和输入密码生成哈希</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">hashedInputPassword</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        hashedInputPassword = hashPasswordWithSalt(inputPassword, salt);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 比较生成的哈希和存储的哈希</span></span><br><span class="line">        <span class="keyword">return</span> storedHashedPassword.equals(hashedInputPassword);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用给定的盐值和密码生成哈希</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">hashPasswordWithSalt</span><span class="params">(String password, <span class="type">byte</span>[] salt)</span> &#123;</span><br><span class="line">        <span class="type">MessageDigest</span> <span class="variable">md</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            md = MessageDigest.getInstance(<span class="string">&quot;SHA-256&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        md.update(salt); <span class="comment">// 添加盐值</span></span><br><span class="line">        md.update(password.getBytes()); <span class="comment">// 添加密码</span></span><br><span class="line">        <span class="type">byte</span>[] hashedPassword = md.digest();</span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder().encodeToString(hashedPassword); <span class="comment">// 返回 Base64 编码的哈希值</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成盐值哈希密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">saltedHashedPassword</span> <span class="operator">=</span> hashPassword(password);</span><br><span class="line">        System.out.println(<span class="string">&quot;Salted Hashed Password: &quot;</span> + saltedHashedPassword);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 验证密码示例</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">passwordToVerify</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>; <span class="comment">// 用户输入的密码</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isPasswordValid</span> <span class="operator">=</span> verifyPassword(passwordToVerify, saltedHashedPassword);</span><br><span class="line">        System.out.println(<span class="string">&quot;Password verification: &quot;</span> + isPasswordValid);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 测试一个无效的密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">wrongPassword</span> <span class="operator">=</span> <span class="string">&quot;wrongPassword&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isWrongPasswordValid</span> <span class="operator">=</span> verifyPassword(wrongPassword, saltedHashedPassword);</span><br><span class="line">        System.out.println(<span class="string">&quot;Wrong password verification: &quot;</span> + isWrongPasswordValid);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java邮件验证</title>
      <link href="/2025/06/29/Java%E9%82%AE%E4%BB%B6%E9%AA%8C%E8%AF%81/"/>
      <url>/2025/06/29/Java%E9%82%AE%E4%BB%B6%E9%AA%8C%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<p>添加依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 邮件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>添加配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment"># 邮件配置</span></span><br><span class="line">  <span class="attr">mail:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">Reisen7@163.com</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">TJqip9ditF9zHx8Q</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">smtp.163.com</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">465</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">mail:</span></span><br><span class="line">        <span class="attr">smtp:</span></span><br><span class="line">          <span class="attr">auth:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">starttls:</span></span><br><span class="line">            <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">            <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">socketFactory:</span></span><br><span class="line">            <span class="attr">port:</span> <span class="number">465</span></span><br><span class="line">            <span class="attr">class:</span> <span class="string">javax.net.ssl.SSLSocketFactory</span></span><br><span class="line">            <span class="attr">fallback:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">valid:</span> <span class="number">5</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">&quot;老年人健康科普信息系统 - 用户认证&quot;</span></span><br><span class="line">    <span class="attr">template:</span> <span class="string">&quot;您的动态验证码为：&lt;strong style=&#x27;color: red&#x27;&gt;%s&lt;/strong&gt;，%d分钟内有效，若非本人操作，请勿泄露。&quot;</span></span><br></pre></td></tr></table></figure><p>后端发验证码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.shanzhu.purchase.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.RandomUtil;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.mail.MessagingException;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Reisen7</span></span><br><span class="line"><span class="comment"> * Date 2025/3/16 17:29</span></span><br><span class="line"><span class="comment"> * description</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmailClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSenderImpl mailSender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送方邮箱</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.mail.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 有效时长</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.mail.valid&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer valid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 内容模版</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.mail.template&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String template;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 标题</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.mail.title&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送邮件验证码</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetEmail 目标邮箱</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 验证码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sendEmailCode</span><span class="params">(String targetEmail)</span> &#123;</span><br><span class="line">        <span class="comment">// 生成随机验证码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">verifyCode</span> <span class="operator">=</span> RandomUtil.randomNumbers(<span class="number">6</span>);</span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> mailSender.createMimeMessage();</span><br><span class="line">        <span class="type">MimeMessageHelper</span> <span class="variable">helper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            helper.setSubject(title);</span><br><span class="line">            helper.setText(String.format(template, verifyCode, valid), <span class="literal">true</span>);</span><br><span class="line">            helper.setFrom(email);</span><br><span class="line">            helper.setTo(targetEmail);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MessagingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        mailSender.send(mimeMessage);</span><br><span class="line">        <span class="keyword">return</span> verifyCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送邮箱</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetEmail 目标邮箱</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content     发送内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendEmail</span><span class="params">(String targetEmail, String title, String content)</span> &#123;</span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> mailSender.createMimeMessage();</span><br><span class="line">        <span class="type">MimeMessageHelper</span> <span class="variable">helper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            helper.setSubject(title);</span><br><span class="line">            helper.setText(content, <span class="literal">true</span>);</span><br><span class="line">            helper.setFrom(email);</span><br><span class="line">            helper.setTo(targetEmail);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MessagingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        mailSender.send(mimeMessage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>redis存验证码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.shanzhu.purchase.service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Reisen7</span></span><br><span class="line"><span class="comment"> * Date 2025/3/16 18:31</span></span><br><span class="line"><span class="comment"> * description</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisCodeService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 存储验证码到 Redis 并设置过期时间</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 存储的键，通常为与验证码关联的标识，如手机号、邮箱等</span></span><br><span class="line"><span class="comment">     *如手机号、邮箱等</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> code 验证码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCodeToRedis</span><span class="params">(String key, String code)</span> &#123;</span><br><span class="line">        <span class="comment">// 将验证码存储到 Redis 中，并设置 60 秒的过期时间</span></span><br><span class="line">        redisTemplate.opsForValue().set(key, code, <span class="number">60</span>, TimeUnit.SECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 从 Redis 中获取验证码并验证</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 存储的键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputCode 用户输入的验证码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 是否验证成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verifyCodeFromRedis</span><span class="params">(String key, String inputCode)</span> &#123;</span><br><span class="line">        <span class="comment">// 从 Redis 中获取存储的验证码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">storedCode</span> <span class="operator">=</span> redisTemplate.opsForValue().get(key);</span><br><span class="line">        System.out.println(<span class="string">&quot;=============================&quot;</span>);</span><br><span class="line">        System.out.println(storedCode);</span><br><span class="line">        <span class="comment">// 判断存储的验证码是否存在且与用户输入的验证码一致</span></span><br><span class="line">        <span class="keyword">return</span> storedCode != <span class="literal">null</span> &amp;&amp; storedCode.equals(inputCode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hive安装</title>
      <link href="/2025/06/29/Hive%E5%AE%89%E8%A3%85/"/>
      <url>/2025/06/29/Hive%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h2 id="MYSQL安装"><a href="#MYSQL安装" class="headerlink" title="MYSQL安装"></a>MYSQL安装</h2><p>详细看mysql安装的章节</p><h2 id="添加hive用户"><a href="#添加hive用户" class="headerlink" title="添加hive用户"></a>添加hive用户</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE hive;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;hiveuser&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;hivepassword&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> hive.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;hiveuser&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Hive安装"><a href="#Hive安装" class="headerlink" title="Hive安装"></a>Hive安装</h2><h3 id="安装包下载"><a href="#安装包下载" class="headerlink" title="安装包下载"></a>安装包下载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --user-agent=<span class="string">&quot;Mozilla&quot;</span> https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-4.0.1/apache-hive-4.0.1-bin.tar.gz</span><br></pre></td></tr></table></figure><h3 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf apache-hive-4.0.1-bin.tar.gz</span><br></pre></td></tr></table></figure><h3 id="到hive的conf文件夹下面"><a href="#到hive的conf文件夹下面" class="headerlink" title="到hive的conf文件夹下面"></a>到hive的conf文件夹下面</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hive-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- jdbc连接的URL --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/hive?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- jdbc连接的Driver--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- jdbc连接的username--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- jdbc连接的password --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Hive默认在HDFS的工作目录 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Hive元数据存储的验证 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 元数据存储授权  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 指定存储元数据要连接的地址 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>thrift://localhost:9083<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 指定hiveserver2连接的host --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 指定hiveserver2连接的端口号 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="下载mysql-jdbc包把它复制到hive-x2F-lib目录下"><a href="#下载mysql-jdbc包把它复制到hive-x2F-lib目录下" class="headerlink" title="下载mysql jdbc包把它复制到hive&#x2F;lib目录下"></a>下载mysql jdbc包把它复制到hive&#x2F;lib目录下</h3><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line">export HIVE_HOME=/opt/apps/hive-3.1.2</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/sbin:$HADOOP_HOME/bin:$FLINK_HOME/bin:$HIVE_HOME/bin</span><br></pre></td></tr></table></figure><h2 id="配置文件生效"><a href="#配置文件生效" class="headerlink" title="配置文件生效"></a>配置文件生效</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h2 id="HIVE初始化元数据"><a href="#HIVE初始化元数据" class="headerlink" title="HIVE初始化元数据"></a>HIVE初始化元数据</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql -verbos</span><br></pre></td></tr></table></figure><h2 id="HIVE启动"><a href="#HIVE启动" class="headerlink" title="HIVE启动"></a>HIVE启动</h2><h3 id="启动hive的服务-metastore"><a href="#启动hive的服务-metastore" class="headerlink" title="启动hive的服务: metastore"></a>启动hive的服务: metastore</h3><p>前台启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive --service metastore</span><br></pre></td></tr></table></figure><p>后台启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> hive --service metastore &amp;</span><br></pre></td></tr></table></figure><h3 id="启动hive的服务-hiveserver2服务"><a href="#启动hive的服务-hiveserver2服务" class="headerlink" title="启动hive的服务: hiveserver2服务"></a>启动hive的服务: hiveserver2服务</h3><p>前台启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive --service hiveserver2</span><br></pre></td></tr></table></figure><p>后台启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> hive --service hiveserver2 &amp;</span><br></pre></td></tr></table></figure><h2 id="本地连接"><a href="#本地连接" class="headerlink" title="本地连接"></a>本地连接</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure><h2 id="开防火墙"><a href="#开防火墙" class="headerlink" title="开防火墙"></a>开防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=9083/tcp --permanent</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 小笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue实现高德地图标点</title>
      <link href="/2025/06/29/Vue%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E6%A0%87%E7%82%B9/"/>
      <url>/2025/06/29/Vue%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE%E6%A0%87%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="依赖导入"><a href="#依赖导入" class="headerlink" title="依赖导入"></a>依赖导入</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @amap/amap-jsapi-loader --save-dev</span><br></pre></td></tr></table></figure><h2 id="创建组件"><a href="#创建组件" class="headerlink" title="创建组件"></a>创建组件</h2><p>创建一个文件GaodeMap.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AMapLoader</span> <span class="keyword">from</span> <span class="string">&#x27;@amap/amap-jsapi-loader&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;GaodeMap&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">startPoint</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">endPoint</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">emits</span>: [<span class="string">&#x27;pointsSelected&#x27;</span>],</span></span><br><span class="line"><span class="language-javascript">    data () &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">map</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">startMarker</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">endMarker</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentPosition</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">isMarkingStart</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">polyline</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">driving</span>: <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      initMap () &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">getCurrentPosition</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">position</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">currentPosition</span> = position;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">AMapLoader</span>.<span class="title function_">reset</span>()</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">AMapLoader</span>.<span class="title function_">load</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">key</span>: <span class="string">&quot;c556abdb0991ac77cecee08058465e72&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">version</span>: <span class="string">&quot;2.0&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">plugins</span>: [<span class="string">&#x27;AMap.ToolBar&#x27;</span>, <span class="string">&#x27;AMap.Scale&#x27;</span>, <span class="string">&#x27;AMap.HawkEye&#x27;</span>, <span class="string">&#x27;AMap.Driving&#x27;</span>]</span></span><br><span class="line"><span class="language-javascript">          &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">AMap</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">map</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">viewMode</span>: <span class="string">&quot;3D&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">zooms</span>: [<span class="number">4</span>, <span class="number">18</span>],</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">zoom</span>: <span class="number">16</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">center</span>: <span class="variable language_">this</span>.<span class="property">currentPosition</span></span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">ToolBar</span>());</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Scale</span>());</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">HawkEye</span>());</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">driving</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Driving</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">map</span>: <span class="variable language_">this</span>.<span class="property">map</span></span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">startPoint</span>.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">endPoint</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="title function_">setMarkers</span>(<span class="title class_">AMap</span>, <span class="variable language_">this</span>.<span class="property">startPoint</span>, <span class="variable language_">this</span>.<span class="property">endPoint</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">on</span>(<span class="string">&#x27;dblclick&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="title function_">handleDoubleClick</span>(e, <span class="title class_">AMap</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">          &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取当前位置失败:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">initMapWithDefaultCenter</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      getCurrentPosition () &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (navigator.<span class="property">geolocation</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            navigator.<span class="property">geolocation</span>.<span class="title function_">getCurrentPosition</span>(</span></span><br><span class="line"><span class="language-javascript">              <span class="function">(<span class="params">position</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> &#123; longitude, latitude &#125; = position.<span class="property">coords</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">resolve</span>([longitude, latitude]);</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">reject</span>(error);</span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">            );</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;浏览器不支持地理定位&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      initMapWithDefaultCenter () &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">AMapLoader</span>.<span class="title function_">load</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">key</span>: <span class="string">&quot;填写高德的key&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">version</span>: <span class="string">&quot;2.0&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">plugins</span>: [<span class="string">&#x27;AMap.ToolBar&#x27;</span>, <span class="string">&#x27;AMap.Scale&#x27;</span>, <span class="string">&#x27;AMap.HawkEye&#x27;</span>, <span class="string">&#x27;AMap.Driving&#x27;</span>]</span></span><br><span class="line"><span class="language-javascript">        &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">AMap</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">map</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">viewMode</span>: <span class="string">&quot;3D&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">zooms</span>: [<span class="number">4</span>, <span class="number">18</span>],</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">zoom</span>: <span class="number">16</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">center</span>: [<span class="number">105.602725</span>, <span class="number">37.076636</span>]</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">ToolBar</span>());</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Scale</span>());</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">HawkEye</span>());</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">driving</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Driving</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">map</span>: <span class="variable language_">this</span>.<span class="property">map</span></span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">startPoint</span>.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">endPoint</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="title function_">setMarkers</span>(<span class="title class_">AMap</span>, <span class="variable language_">this</span>.<span class="property">startPoint</span>, <span class="variable language_">this</span>.<span class="property">endPoint</span>);</span></span><br><span class="line"><span class="language-javascript">                            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">map</span>.<span class="title function_">on</span>(<span class="string">&#x27;dblclick&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">handleDoubleClick</span>(e, <span class="title class_">AMap</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    setMarkers (<span class="title class_">AMap</span>, start, end) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">startMarker</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">startMarker</span>.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">startMarker</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Marker</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">position</span>: start,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">title</span>: <span class="string">&#x27;起点&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">icon</span>: <span class="string">&#x27;https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">startMarker</span>.<span class="title function_">setMap</span>(<span class="variable language_">this</span>.<span class="property">map</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">endMarker</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">endMarker</span>.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">endMarker</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Marker</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">position</span>: end,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">title</span>: <span class="string">&#x27;终点&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">icon</span>: <span class="string">&#x27;https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">endMarker</span>.<span class="title function_">setMap</span>(<span class="variable language_">this</span>.<span class="property">map</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">getDrivingRoute</span>(<span class="title class_">AMap</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    handleDoubleClick (e, <span class="title class_">AMap</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> point = [e.<span class="property">lnglat</span>.<span class="title function_">getLng</span>(), e.<span class="property">lnglat</span>.<span class="title function_">getLat</span>()];</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isMarkingStart</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">startMarker</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">startMarker</span>.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">startMarker</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Marker</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">position</span>: point,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">title</span>: <span class="string">&#x27;起点&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">icon</span>: <span class="string">&#x27;https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">startMarker</span>.<span class="title function_">setMap</span>(<span class="variable language_">this</span>.<span class="property">map</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">isMarkingStart</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">polyline</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">polyline</span>.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">polyline</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">endMarker</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">endMarker</span>.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">endMarker</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Marker</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">position</span>: point,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">title</span>: <span class="string">&#x27;终点&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">icon</span>: <span class="string">&#x27;https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">endMarker</span>.<span class="title function_">setMap</span>(<span class="variable language_">this</span>.<span class="property">map</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">isMarkingStart</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">getDrivingRoute</span>(<span class="title class_">AMap</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> start = <span class="variable language_">this</span>.<span class="property">startMarker</span>.<span class="title function_">getPosition</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> end = <span class="variable language_">this</span>.<span class="property">endMarker</span>.<span class="title function_">getPosition</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> startPoint = [start.<span class="title function_">getLng</span>(), start.<span class="title function_">getLat</span>()];</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> endPoint = [end.<span class="title function_">getLng</span>(), end.<span class="title function_">getLat</span>()];</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$emit(<span class="string">&#x27;pointsSelected&#x27;</span>, &#123; startPoint, endPoint &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    getDrivingRoute (<span class="title class_">AMap</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">startMarker</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">endMarker</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> startPoint = <span class="variable language_">this</span>.<span class="property">startMarker</span>.<span class="title function_">getPosition</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> endPoint = <span class="variable language_">this</span>.<span class="property">endMarker</span>.<span class="title function_">getPosition</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(startPoint);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(endPoint);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">driving</span>.<span class="title function_">search</span>(startPoint, endPoint, <span class="function">(<span class="params">status, result</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (status === <span class="string">&#x27;complete&#x27;</span> &amp;&amp; result.<span class="property">info</span> === <span class="string">&#x27;OK&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> path = result.<span class="property">routes</span>[<span class="number">0</span>].<span class="property">path</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> pathCoords = path.<span class="title function_">map</span>(<span class="function">(<span class="params">p</span>) =&gt;</span> [p.<span class="property">lng</span>, p.<span class="property">lat</span>]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">polyline</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">polyline</span>.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">polyline</span> = <span class="keyword">new</span> <span class="title class_">AMap</span>.<span class="title class_">Polyline</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">path</span>: pathCoords,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">strokeColor</span>: <span class="string">&quot;#FF33FF&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">strokeOpacity</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">strokeStyle</span>: <span class="string">&quot;solid&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">polyline</span>.<span class="title function_">setMap</span>(<span class="variable language_">this</span>.<span class="property">map</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取驾车路线失败:&#x27;</span>, result);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  mounted () &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">initMap</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-id">#container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="引入组件"><a href="#引入组件" class="headerlink" title="引入组件"></a>引入组件</h2><p>在使用的地方引入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">gaode-map</span> <span class="attr">:startPoint</span>=<span class="string">&quot;savedStartPoint&quot;</span> <span class="attr">:endPoint</span>=<span class="string">&quot;savedEndPoint&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">pointsSelected</span>=<span class="string">&quot;handlePointsSelected&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">gaode-map</span>&gt;</span></span><br></pre></td></tr></table></figure><p>script导入</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">GaodeMap</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/GaodeMap.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">savedStartPoint</span>: [],</span><br><span class="line">      <span class="attr">savedEndPoint</span>: [],</span><br><span class="line">      <span class="attr">ruleFoem</span>:&#123;</span><br><span class="line">        <span class="attr">startPoint</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">endPoint</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">GaodeMap</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>:&#123;</span><br><span class="line">  handlePointsSelected (&#123; startPoint, endPoint &#125;) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">ruleForm</span>.<span class="property">startPoint</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(startPoint);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">ruleForm</span>.<span class="property">endPoint</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(endPoint);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mahout实现协同过滤推荐</title>
      <link href="/2025/06/29/mahout%E5%AE%9E%E7%8E%B0%E5%8D%8F%E5%90%8C%E8%BF%87%E6%BB%A4%E6%8E%A8%E8%8D%90/"/>
      <url>/2025/06/29/mahout%E5%AE%9E%E7%8E%B0%E5%8D%8F%E5%90%8C%E8%BF%87%E6%BB%A4%E6%8E%A8%E8%8D%90/</url>
      
        <content type="html"><![CDATA[<h2 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入推荐引擎mahout，注意要先全部引入，再使用exclusion标签--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.mahout<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mahout-mr<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.12.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-jcl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-analyzers-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-apache-client4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey.contribs<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="创建对应的实体类"><a href="#创建对应的实体类" class="headerlink" title="创建对应的实体类"></a>创建对应的实体类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserItemOperation</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long itemId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer value;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="创建对应的Xml"><a href="#创建对应的Xml" class="headerlink" title="创建对应的Xml"></a>创建对应的Xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.dao.UserItemDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUserPreference&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.entity.UserItemOperation&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            a.id userid,</span><br><span class="line">            c.id itemId,</span><br><span class="line">            count( a.id ) `value`</span><br><span class="line">        FROM</span><br><span class="line">            yonghu a</span><br><span class="line">                JOIN gangweishenqing b ON a.yonghuming = b.yonghuming join zhaopinxinxi c on</span><br><span class="line">                b.zhaopingangwei = c.zhaopingangwei</span><br><span class="line">        GROUP BY</span><br><span class="line">            a.id,</span><br><span class="line">            b.qiyezhanghao</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="基于用户的推荐算法代码"><a href="#基于用户的推荐算法代码" class="headerlink" title="基于用户的推荐算法代码"></a>基于用户的推荐算法代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecommendUtil</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserItemDao userItemDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Long&gt; <span class="title function_">recommend</span><span class="params">(Long userId)</span> <span class="keyword">throws</span> TasteException &#123;</span><br><span class="line">        List&lt;UserItemOperation&gt; userList = userItemDao.getAllUserPreference();</span><br><span class="line">        <span class="comment">//创建数据模型</span></span><br><span class="line">        System.out.println(userList);</span><br><span class="line">        <span class="type">DataModel</span> <span class="variable">dataModel</span> <span class="operator">=</span> <span class="built_in">this</span>.createDataModel(userList);</span><br><span class="line">        <span class="comment">//获取用户相似程度</span></span><br><span class="line">        <span class="type">UserSimilarity</span> <span class="variable">similarity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UncenteredCosineSimilarity</span>(dataModel);</span><br><span class="line">        <span class="comment">//获取用户邻居</span></span><br><span class="line">        <span class="type">UserNeighborhood</span> <span class="variable">userNeighborhood</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NearestNUserNeighborhood</span>(<span class="number">2</span>, similarity, dataModel);</span><br><span class="line">        <span class="comment">//构建推荐器</span></span><br><span class="line">        <span class="type">Recommender</span> <span class="variable">recommender</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericUserBasedRecommender</span>(dataModel, userNeighborhood, similarity);</span><br><span class="line">        <span class="comment">//推荐2个</span></span><br><span class="line">        List&lt;RecommendedItem&gt; recommendedItems = recommender.recommend(userId, <span class="number">5</span>);</span><br><span class="line">        List&lt;Long&gt; itemIds = recommendedItems.stream().map(RecommendedItem::getItemID).collect(Collectors.toList());</span><br><span class="line">        <span class="keyword">return</span> itemIds;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> DataModel <span class="title function_">createDataModel</span><span class="params">(List&lt;UserItemOperation&gt; userItemOperations)</span> &#123;</span><br><span class="line">        FastByIDMap&lt;PreferenceArray&gt; fastByIdMap = <span class="keyword">new</span> <span class="title class_">FastByIDMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;Long, List&lt;UserItemOperation&gt;&gt; map = userItemOperations.stream().collect(Collectors.groupingBy(UserItemOperation::getUserId));</span><br><span class="line">        Collection&lt;List&lt;UserItemOperation&gt;&gt; list = map.values();</span><br><span class="line">        <span class="keyword">for</span>(List&lt;UserItemOperation&gt; userPreferences : list)&#123;</span><br><span class="line">            GenericPreference[] array = <span class="keyword">new</span> <span class="title class_">GenericPreference</span>[userPreferences.size()];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; userPreferences.size(); i++)&#123;</span><br><span class="line">                <span class="type">UserItemOperation</span> <span class="variable">userPreference</span> <span class="operator">=</span> userPreferences.get(i);</span><br><span class="line">                System.out.println(userPreference);</span><br><span class="line">                <span class="type">GenericPreference</span> <span class="variable">item</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericPreference</span>(userPreference.getUserId(), userPreference.getItemId(), userPreference.getValue());</span><br><span class="line">                array[i] = item;</span><br><span class="line">            &#125;</span><br><span class="line">            fastByIdMap.put(array[<span class="number">0</span>].getUserID(), <span class="keyword">new</span> <span class="title class_">GenericUserPreferenceArray</span>(Arrays.asList(array)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GenericDataModel</span>(fastByIdMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="基于物品的推荐算法"><a href="#基于物品的推荐算法" class="headerlink" title="基于物品的推荐算法"></a>基于物品的推荐算法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecommendUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserItemDao userItemDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Long&gt; <span class="title function_">recommend</span><span class="params">(Long userId)</span> <span class="keyword">throws</span> TasteException &#123;</span><br><span class="line">        List&lt;UserItemOperation&gt; userList = userItemDao.getAllUserPreference();</span><br><span class="line">        <span class="comment">// 创建数据模型</span></span><br><span class="line">        <span class="type">DataModel</span> <span class="variable">dataModel</span> <span class="operator">=</span> <span class="built_in">this</span>.createDataModel(userList);</span><br><span class="line">        <span class="comment">// 获取物品相似程度</span></span><br><span class="line">        <span class="type">ItemSimilarity</span> <span class="variable">similarity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UncenteredCosineSimilarity</span>(dataModel);</span><br><span class="line">        <span class="comment">// 构建推荐器</span></span><br><span class="line">        <span class="type">Recommender</span> <span class="variable">recommender</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericItemBasedRecommender</span>(dataModel, similarity);</span><br><span class="line">        <span class="comment">// 推荐5个</span></span><br><span class="line">        List&lt;RecommendedItem&gt; recommendedItems = recommender.recommend(userId, <span class="number">5</span>);</span><br><span class="line">        List&lt;Long&gt; itemIds = recommendedItems.stream().map(RecommendedItem::getItemID).collect(Collectors.toList());</span><br><span class="line">        <span class="keyword">return</span> itemIds;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DataModel <span class="title function_">createDataModel</span><span class="params">(List&lt;UserItemOperation&gt; userItemOperations)</span> &#123;</span><br><span class="line">        FastByIDMap&lt;PreferenceArray&gt; fastByIdMap = <span class="keyword">new</span> <span class="title class_">FastByIDMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;Long, List&lt;UserItemOperation&gt;&gt; map = userItemOperations.stream().collect(Collectors.groupingBy(UserItemOperation::getUserId));</span><br><span class="line">        Collection&lt;List&lt;UserItemOperation&gt;&gt; list = map.values();</span><br><span class="line">        <span class="keyword">for</span> (List&lt;UserItemOperation&gt; userPreferences : list) &#123;</span><br><span class="line">            GenericPreference[] array = <span class="keyword">new</span> <span class="title class_">GenericPreference</span>[userPreferences.size()];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; userPreferences.size(); i++) &#123;</span><br><span class="line">                <span class="type">UserItemOperation</span> <span class="variable">userPreference</span> <span class="operator">=</span> userPreferences.get(i);</span><br><span class="line">                <span class="type">GenericPreference</span> <span class="variable">item</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericPreference</span>(userPreference.getUserId(), userPreference.getItemId(), userPreference.getValue());</span><br><span class="line">                array[i] = item;</span><br><span class="line">            &#125;</span><br><span class="line">            fastByIdMap.put(array[<span class="number">0</span>].getUserID(), <span class="keyword">new</span> <span class="title class_">GenericUserPreferenceArray</span>(Arrays.asList(array)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GenericDataModel</span>(fastByIdMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spark分析案例</title>
      <link href="/2025/06/29/Spark%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/"/>
      <url>/2025/06/29/Spark%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spark Core and SQL --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-slf4j-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.janino<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>janino<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.janino<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-compiler<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.janino<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>janino<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.janino<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-compiler<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jul-to-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jcl-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-slf4j-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="添加配置文件"><a href="#添加配置文件" class="headerlink" title="添加配置文件"></a>添加配置文件</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spark:</span></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">ECommerceAnalysis</span></span><br><span class="line">  <span class="attr">home:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  <span class="attr">master:</span></span><br><span class="line">    <span class="attr">uri:</span> <span class="string">spark://my.hadoop.cn:7077</span></span><br><span class="line">  <span class="attr">driver:</span></span><br><span class="line">    <span class="attr">memory:</span> <span class="string">450m</span></span><br><span class="line">    <span class="attr">maxResultSize:</span> <span class="string">450m</span></span><br><span class="line">  <span class="attr">worker:</span></span><br><span class="line">    <span class="attr">memory:</span> <span class="string">450m</span></span><br><span class="line">  <span class="attr">executor:</span></span><br><span class="line">    <span class="attr">cores:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">memory:</span> <span class="string">450m</span></span><br><span class="line">    <span class="attr">heartbeatInterval:</span> <span class="number">1000000</span></span><br><span class="line">  <span class="attr">num:</span></span><br><span class="line">    <span class="attr">executors:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">network:</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">1474830</span></span><br><span class="line">  <span class="attr">rpc:</span></span><br><span class="line">    <span class="attr">message:</span></span><br><span class="line">      <span class="attr">maxSize:</span> <span class="number">1024</span></span><br></pre></td></tr></table></figure><h2 id="添加spark的Spingboot配置"><a href="#添加spark的Spingboot配置" class="headerlink" title="添加spark的Spingboot配置"></a>添加spark的Spingboot配置</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SparkConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.app.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String appName;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.home&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkHome;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.master.uri&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkMasterUri;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.driver.memory&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkDriverMemory;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.worker.memory&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkWorkerMemory;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.executor.memory&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkExecutorMemory;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.executor.cores&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkExecutorCores;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.num.executors&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkExecutorsNum;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.network.timeout&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String networkTimeout;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.executor.heartbeatInterval&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String heartbeatIntervalTime;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.driver.maxResultSize&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String maxResultSize;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spark.rpc.message.maxSize&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sparkRpcMessageMaxSize;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SparkConf <span class="title function_">sparkConf</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">SparkConf</span> <span class="variable">sparkConf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SparkConf</span>()</span><br><span class="line">                .setAppName(appName)</span><br><span class="line">                .setMaster(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">                .set(<span class="string">&quot;spark.driver.memory&quot;</span>,sparkDriverMemory)</span><br><span class="line">                .set(<span class="string">&quot;spark.driver.maxResultSize&quot;</span>,maxResultSize)</span><br><span class="line">                .set(<span class="string">&quot;spark.worker.memory&quot;</span>,sparkWorkerMemory) <span class="comment">//&quot;26g&quot;</span></span><br><span class="line">                .set(<span class="string">&quot;spark.executor.memory&quot;</span>,sparkExecutorMemory)</span><br><span class="line">                .set(<span class="string">&quot;spark.executor.cores&quot;</span>,sparkExecutorCores)</span><br><span class="line">                .set(<span class="string">&quot;spark.executor.heartbeatInterval&quot;</span>,heartbeatIntervalTime)</span><br><span class="line">                .set(<span class="string">&quot;spark.num.executors&quot;</span>,sparkExecutorsNum)</span><br><span class="line">                .set(<span class="string">&quot;spark.network.timeout&quot;</span>,networkTimeout)</span><br><span class="line">                .set(<span class="string">&quot;spark.rpc.message.maxSize&quot;</span>,sparkRpcMessageMaxSize);</span><br><span class="line">        <span class="comment">//                .set(&quot;spark.shuffle.memoryFraction&quot;,&quot;0&quot;) //默认0.2</span></span><br><span class="line">        <span class="keyword">return</span> sparkConf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean(JavaSparkContext.class)</span></span><br><span class="line">    <span class="keyword">public</span> JavaSparkContext <span class="title function_">javaSparkContext</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">JavaSparkContext</span>(sparkConf());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SparkSession <span class="title function_">sparkSession</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SparkSession</span><br><span class="line">                .builder()</span><br><span class="line">                .sparkContext(javaSparkContext().sc())</span><br><span class="line">                .appName(appName)</span><br><span class="line">                .getOrCreate();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> PropertySourcesPlaceholderConfigurer <span class="title function_">propertySourcesPlaceholderConfigurer</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PropertySourcesPlaceholderConfigurer</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="spark的数据分析"><a href="#spark的数据分析" class="headerlink" title="spark的数据分析"></a>spark的数据分析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.io.hadoop.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.log4j.Log4j;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.apache.spark.sql.functions.col;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.apache.spark.sql.functions.count;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.apache.spark.sql.functions.sum;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author reisen7</span></span><br><span class="line"><span class="comment"> * Date 2025/4/4 13:03</span></span><br><span class="line"><span class="comment"> * Description</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataAnalysisService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.datasource.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String jdbcUrl;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.datasource.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.datasource.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">LIMIT</span> <span class="operator">=</span> <span class="number">100</span>; <span class="comment">// 可根据需求调整这个值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performAnalysis</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">connectionProperties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        connectionProperties.put(<span class="string">&quot;user&quot;</span>, username);</span><br><span class="line">        connectionProperties.put(<span class="string">&quot;password&quot;</span>, password);</span><br><span class="line">        log.info(<span class="string">&quot;连接: &#123;&#125; &quot;</span>, jdbcUrl);</span><br><span class="line">        log.info(<span class="string">&quot;开始分析数据&quot;</span>);</span><br><span class="line">        <span class="comment">// 读取 MySQL 数据</span></span><br><span class="line">        Dataset&lt;Row&gt; goodsDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;goods&quot;</span>, connectionProperties);</span><br><span class="line">        Dataset&lt;Row&gt; orderGoodsDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;order_goods&quot;</span>, connectionProperties);</span><br><span class="line">        Dataset&lt;Row&gt; tOderDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;t_order&quot;</span>, connectionProperties);</span><br><span class="line">        Dataset&lt;Row&gt; userDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;t_user&quot;</span>, connectionProperties);</span><br><span class="line">        Dataset&lt;Row&gt; cartDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;cart&quot;</span>, connectionProperties);</span><br><span class="line">        Dataset&lt;Row&gt; collectDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;collect&quot;</span>, connectionProperties);</span><br><span class="line">        Dataset&lt;Row&gt; categoryDF = sparkSession.read()</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;category&quot;</span>, connectionProperties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 维度 1：各商品分类的销售总量</span></span><br><span class="line">        Dataset&lt;Row&gt; categorySales = orderGoodsDF.join(goodsDF, orderGoodsDF.col(<span class="string">&quot;goods_id&quot;</span>).equalTo(goodsDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .join(categoryDF, goodsDF.col(<span class="string">&quot;category_id&quot;</span>).equalTo(categoryDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .groupBy(categoryDF.col(<span class="string">&quot;name&quot;</span>))</span><br><span class="line">                .agg(sum(orderGoodsDF.col(<span class="string">&quot;count&quot;</span>)).alias(<span class="string">&quot;total_sales&quot;</span>))</span><br><span class="line">                .orderBy(col(<span class="string">&quot;total_sales&quot;</span>).desc())</span><br><span class="line">                .limit(LIMIT);</span><br><span class="line">        categorySales.write()</span><br><span class="line">                .mode(SaveMode.Overwrite)</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;spark_category_sales&quot;</span>, connectionProperties);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 维度 2：各用户的购物车商品总数</span></span><br><span class="line">        Dataset&lt;Row&gt; userCartTotal = cartDF.join(userDF, cartDF.col(<span class="string">&quot;user_id&quot;</span>).equalTo(userDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .groupBy(userDF.col(<span class="string">&quot;username&quot;</span>))</span><br><span class="line">                .agg(sum(cartDF.col(<span class="string">&quot;count&quot;</span>)).alias(<span class="string">&quot;total_cart_items&quot;</span>))</span><br><span class="line">                .orderBy(col(<span class="string">&quot;total_cart_items&quot;</span>).desc())</span><br><span class="line">                .limit(LIMIT);</span><br><span class="line">        userCartTotal.write()</span><br><span class="line">                .mode(SaveMode.Overwrite)</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;spark_user_cart_total&quot;</span>, connectionProperties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 维度 3：各商品的收藏次数</span></span><br><span class="line">        Dataset&lt;Row&gt; goodsCollectCount = collectDF.join(goodsDF ,collectDF.col(<span class="string">&quot;goods_id&quot;</span>).equalTo(goodsDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .groupBy(goodsDF.col(<span class="string">&quot;name&quot;</span>))</span><br><span class="line">                .agg(count(collectDF.col(<span class="string">&quot;id&quot;</span>)).alias(<span class="string">&quot;collect_count&quot;</span>))</span><br><span class="line">                .orderBy(col(<span class="string">&quot;collect_count&quot;</span>).desc())</span><br><span class="line">                .limit(LIMIT);</span><br><span class="line">        goodsCollectCount.write()</span><br><span class="line">                .mode(SaveMode.Overwrite)</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;spark_goods_collect_count&quot;</span>, connectionProperties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 维度 4：各用户的订单数量</span></span><br><span class="line">        Dataset&lt;Row&gt; userOrderCount = orderGoodsDF.join(tOderDF, orderGoodsDF.col(<span class="string">&quot;order_id&quot;</span>).equalTo(tOderDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .join(userDF, tOderDF.col(<span class="string">&quot;user_id&quot;</span>).equalTo(userDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .groupBy(userDF.col(<span class="string">&quot;username&quot;</span>))</span><br><span class="line">                .agg(count(orderGoodsDF.col(<span class="string">&quot;order_id&quot;</span>)).alias(<span class="string">&quot;order_count&quot;</span>))</span><br><span class="line">                .orderBy(col(<span class="string">&quot;order_count&quot;</span>).desc())</span><br><span class="line">                .limit(LIMIT);</span><br><span class="line">        userOrderCount.write()</span><br><span class="line">                .mode(SaveMode.Overwrite)</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;spark_user_order_count&quot;</span>, connectionProperties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 维度 5：各商品分类的商品数量</span></span><br><span class="line">        Dataset&lt;Row&gt; categoryGoodsCount = goodsDF.join(categoryDF, goodsDF.col(<span class="string">&quot;category_id&quot;</span>).equalTo(categoryDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .groupBy(categoryDF.col(<span class="string">&quot;name&quot;</span>))</span><br><span class="line">                .agg(count(goodsDF.col(<span class="string">&quot;id&quot;</span>)).alias(<span class="string">&quot;goods_count&quot;</span>))</span><br><span class="line">                .orderBy(col(<span class="string">&quot;goods_count&quot;</span>).desc())</span><br><span class="line">                .limit(LIMIT);</span><br><span class="line">        categoryGoodsCount.write()</span><br><span class="line">                .mode(SaveMode.Overwrite)</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;spark_category_goods_count&quot;</span>, connectionProperties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 维度 6：各用户的收藏商品数量</span></span><br><span class="line">        Dataset&lt;Row&gt; userCollectCount = collectDF.join(userDF, collectDF.col(<span class="string">&quot;user_id&quot;</span>).equalTo(userDF.col(<span class="string">&quot;id&quot;</span>)))</span><br><span class="line">                .groupBy(userDF.col(<span class="string">&quot;username&quot;</span>))</span><br><span class="line">                .agg(count(collectDF.col(<span class="string">&quot;id&quot;</span>)).alias(<span class="string">&quot;collect_goods_count&quot;</span>))</span><br><span class="line">                .orderBy(col(<span class="string">&quot;collect_goods_count&quot;</span>).desc())</span><br><span class="line">                .limit(LIMIT);</span><br><span class="line">        userCollectCount.write()</span><br><span class="line">                .mode(SaveMode.Overwrite)</span><br><span class="line">                .jdbc(jdbcUrl, <span class="string">&quot;spark_user_collect_count&quot;</span>, connectionProperties);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>仿Deepseek页面的聊天窗口</title>
      <link href="/2025/06/29/%E4%BB%BFDeepseek%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%81%8A%E5%A4%A9%E7%AA%97%E5%8F%A3/"/>
      <url>/2025/06/29/%E4%BB%BFDeepseek%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%81%8A%E5%A4%A9%E7%AA%97%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="先到阿里云控制台注册token"><a href="#先到阿里云控制台注册token" class="headerlink" title="先到阿里云控制台注册token"></a>先到阿里云控制台注册token</h2><blockquote><p><a href="https://bailian.console.aliyun.com/">https://bailian.console.aliyun.com/</a></p></blockquote><p><img src="/img/posts/436be6ffea8d4559b8640e49175c49d0.png"></p><h2 id="后端代码"><a href="#后端代码" class="headerlink" title="后端代码"></a>后端代码</h2><h3 id="python-Django"><a href="#python-Django" class="headerlink" title="python Django"></a>python Django</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> StreamingHttpResponse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_only_api</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        content = request.GET.get(<span class="string">&#x27;content&#x27;</span>)</span><br><span class="line">        client = OpenAI(</span><br><span class="line">            api_key=<span class="string">&quot;申请的token&quot;</span>,</span><br><span class="line">            base_url=<span class="string">&quot;https://dashscope.aliyuncs.com/compatible-mode/v1&quot;</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">event_stream</span>():</span><br><span class="line">            reasoning_content = <span class="string">&quot;&quot;</span></span><br><span class="line">            answer_content = <span class="string">&quot;&quot;</span></span><br><span class="line">            is_answering = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">            completion = client.chat.completions.create(</span><br><span class="line">                model=<span class="string">&quot;deepseek-r1&quot;</span>,</span><br><span class="line">                messages=[</span><br><span class="line">                    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: content&#125;</span><br><span class="line">                ],</span><br><span class="line">                stream=<span class="literal">True</span></span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> chunk <span class="keyword">in</span> completion:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> chunk.choices:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                delta = chunk.choices[<span class="number">0</span>].delta</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hasattr</span>(delta, <span class="string">&#x27;reasoning_content&#x27;</span>) <span class="keyword">and</span> delta.reasoning_content <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    reasoning_content += delta.reasoning_content</span><br><span class="line">                    data = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;msg1&#x27;</span>: delta.reasoning_content&#125;</span><br><span class="line">                    <span class="keyword">yield</span> <span class="string">f&quot;data: <span class="subst">&#123;json.dumps(data)&#125;</span>\n\n&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> delta.content != <span class="string">&quot;&quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> is_answering:</span><br><span class="line">                        is_answering = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">if</span> delta.content:</span><br><span class="line">                        answer_content += delta.content</span><br><span class="line">                        <span class="built_in">print</span>(delta.content)</span><br><span class="line">                        data = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: delta.content, <span class="string">&#x27;msg1&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">                        <span class="keyword">yield</span> <span class="string">f&quot;data: <span class="subst">&#123;json.dumps(data)&#125;</span>\n\n&quot;</span></span><br><span class="line"></span><br><span class="line">        response = StreamingHttpResponse(event_stream(), content_type=<span class="string">&#x27;text/event-stream&#x27;</span>)</span><br><span class="line">        response[<span class="string">&#x27;Cache-Control&#x27;</span>] = <span class="string">&#x27;no-cache&#x27;</span></span><br><span class="line">        <span class="comment"># 跨域</span></span><br><span class="line">        response[<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>] = <span class="string">&#x27;设置成你的前端地址&#x27;</span>  <span class="comment"># 设置允许的来源</span></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        response = JsonResponse(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Method not allowed&quot;</span>&#125;, status=<span class="number">405</span>)</span><br><span class="line">        <span class="comment"># 跨域</span></span><br><span class="line">        response[<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>] = <span class="string">&#x27;设置成你的前端地址&#x27;</span>  <span class="comment"># 设置允许的来源</span></span><br><span class="line">        <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><h3 id="java-Springboot"><a href="#java-Springboot" class="headerlink" title="java Springboot"></a>java Springboot</h3><ul><li>Maven依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dashscope-sdk-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.18.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>代码</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dashscope.aigc.generation.Generation;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dashscope.aigc.generation.GenerationParam;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dashscope.common.Message;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dashscope.common.Role;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.method.annotation.SseEmitter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author reisen7</span></span><br><span class="line"><span class="comment"> * Date 2025/4/9 1:12</span></span><br><span class="line"><span class="comment"> * Description </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/deepSeek&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeepSeekController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(DeepSeekController.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newCachedThreadPool();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> GenerationParam <span class="title function_">buildGenerationParam</span><span class="params">(Message userMsg)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> GenerationParam.builder()</span><br><span class="line">                .apiKey(<span class="string">&quot;sk-xxxxxx&quot;</span>)</span><br><span class="line">                .model(<span class="string">&quot;deepseek-r1&quot;</span>)</span><br><span class="line">                .messages(Arrays.asList(userMsg))</span><br><span class="line">                .resultFormat(GenerationParam.ResultFormat.MESSAGE)</span><br><span class="line">                .incrementalOutput(<span class="literal">true</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/query&quot;, produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line">    <span class="keyword">public</span> SseEmitter <span class="title function_">getBotContent</span><span class="params">(<span class="meta">@RequestParam</span> String question)</span> &#123;</span><br><span class="line">        <span class="type">SseEmitter</span> <span class="variable">emitter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SseEmitter</span>(<span class="number">60_000L</span>); <span class="comment">// 60秒超时</span></span><br><span class="line"></span><br><span class="line">        executor.execute(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 先发送思考中状态</span></span><br><span class="line">                Map&lt;String, Object&gt; thinkingResponse = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">                thinkingResponse.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">                thinkingResponse.put(<span class="string">&quot;msg1&quot;</span>, <span class="string">&quot;正在分析您的问题...&quot;</span>);</span><br><span class="line">                emitter.send(SseEmitter.event().data(thinkingResponse));</span><br><span class="line"></span><br><span class="line">                <span class="type">Generation</span> <span class="variable">gen</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Generation</span>();</span><br><span class="line">                <span class="type">Message</span> <span class="variable">userMsg</span> <span class="operator">=</span> Message.builder()</span><br><span class="line">                        .role(Role.USER.getValue())</span><br><span class="line">                        .content(question)</span><br><span class="line">                        .build();</span><br><span class="line"></span><br><span class="line">                <span class="type">GenerationParam</span> <span class="variable">param</span> <span class="operator">=</span> buildGenerationParam(userMsg);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 处理流式响应</span></span><br><span class="line">                gen.streamCall(param).blockingForEach(message -&gt; &#123;</span><br><span class="line">                    Map&lt;String, Object&gt; response = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">                    response.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="type">String</span> <span class="variable">reasoning</span> <span class="operator">=</span> message.getOutput().getChoices().get(<span class="number">0</span>).getMessage().getReasoningContent();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> message.getOutput().getChoices().get(<span class="number">0</span>).getMessage().getContent();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (reasoning != <span class="literal">null</span> &amp;&amp; !reasoning.isEmpty()) &#123;</span><br><span class="line">                        response.put(<span class="string">&quot;msg1&quot;</span>, reasoning);</span><br><span class="line">                        emitter.send(SseEmitter.event().data(response));</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (content != <span class="literal">null</span> &amp;&amp; !content.isEmpty()) &#123;</span><br><span class="line">                        response.remove(<span class="string">&quot;msg1&quot;</span>);</span><br><span class="line">                        response.put(<span class="string">&quot;msg&quot;</span>, content);</span><br><span class="line">                        emitter.send(SseEmitter.event().data(response));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                emitter.complete();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.error(<span class="string">&quot;Error in streaming response&quot;</span>, e);</span><br><span class="line">                Map&lt;String, Object&gt; errorResponse = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">                errorResponse.put(<span class="string">&quot;code&quot;</span>, <span class="number">500</span>);</span><br><span class="line">                errorResponse.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;处理请求时发生错误: &quot;</span> + e.getMessage());</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    emitter.send(SseEmitter.event().data(errorResponse));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ex);</span><br><span class="line">                &#125;</span><br><span class="line">                emitter.completeWithError(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> emitter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="前端仿Deepseek页面"><a href="#前端仿Deepseek页面" class="headerlink" title="前端仿Deepseek页面"></a>前端仿Deepseek页面</h2><p>这只是实现了弹窗的内容，需要引入到使用的页面中，这里不再补充可以参考之前的代码</p><blockquote><p><a href="https://blog.csdn.net/qq_46150074/article/details/144575355?spm=1001.2014.3001.5502">https://blog.csdn.net/qq_46150074&#x2F;article&#x2F;details&#x2F;144575355?spm&#x3D;1001.2014.3001.5502</a></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-bg&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;show&quot;</span> @<span class="attr">mousemove</span>=<span class="string">&quot;modelMove&quot;</span> @<span class="attr">mouseup</span>=<span class="string">&quot;cancelMove&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-header&quot;</span> @<span class="attr">mousedown</span>=<span class="string">&quot;setStartingPoint&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; title &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-main&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;item.id == 2 ? &#x27;atalk&#x27; : &#x27;btalk&#x27;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; item.content &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; display: flex;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;wordone&quot;</span> <span class="attr">class</span>=<span class="string">&quot;inputword&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;sendmsg&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;isButtonDisabled&quot;</span> <span class="attr">round</span> @<span class="attr">click</span>=<span class="string">&quot;sendmsg&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;btnsend&quot;</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-footer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">round</span> @<span class="attr">click</span>=<span class="string">&quot;cancel&quot;</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">title</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="string">&#x27;deepseek&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">x</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">y</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">node</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">isCanMove</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">isButtonDisabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">list</span>: [],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">wordone</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">wordtow</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">eventSource</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentIndex</span>: <span class="number">0</span>, <span class="comment">// 当前显示的字符索引</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentMessage</span>: <span class="literal">null</span>, <span class="comment">// 当前正在显示的消息对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">typingTimer</span>: <span class="literal">null</span> <span class="comment">// 逐字显示定时器</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">node</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.model-container&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">sendmsg</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> == <span class="literal">false</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 重置相关状态变量</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">currentMessage</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">typingTimer</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;sigtuna&#x27;</span>, <span class="attr">content</span>: <span class="variable language_">this</span>.<span class="property">wordone</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">scrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">getBotContent</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">wordone</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">getBotContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 添加思考中的提示</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;正在思考中...&#x27;</span>, <span class="attr">isThinking</span>: <span class="literal">true</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 改成后端的接口</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">eventSource</span> = <span class="keyword">new</span> <span class="title class_">EventSource</span>(<span class="string">`/api/ai?content=<span class="subst">$&#123;<span class="variable language_">this</span>.wordone&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="property">onmessage</span> = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (data.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (data.<span class="property">msg1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 处理思考问题消息</span></span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentMessage</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">id</span> !== <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 如果当前没有正在显示的思考问题消息，或者当前消息不是思考问题消息，或者当前思考问题消息已结束</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">currentMessage</span> = &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;思考问题：&#x27;</span> + data.<span class="property">msg1</span>, <span class="attr">isThinking</span>: <span class="literal">true</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">currentMessage</span>);</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前正在显示思考问题消息，追加内容</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> += data.<span class="property">msg1</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (data.<span class="property">msg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 处理回答消息</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentMessage</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">id</span> !== <span class="number">2</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">isThinking</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前没有正在显示的回答消息，或者当前消息不是回答消息，或者当前是思考问题消息</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span> = &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;回答问题：&#x27;</span> + data.<span class="property">msg</span>, <span class="attr">isThinking</span>: <span class="literal">false</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">currentMessage</span>);</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前正在显示回答消息，追加内容</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> += data.<span class="property">msg</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="title function_">scrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="property">onerror</span> = <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 添加新的方法用于处理内容更新时的滚动</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">scrollToBottom</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span></span><br><span class="line"><span class="language-javascript">                div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">startTyping</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">typingTimer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentIndex</span> &lt; <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span>.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> = <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span>.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">currentIndex</span> + <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">currentIndex</span>++;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span></span><br><span class="line"><span class="language-javascript">                    div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">50</span>); <span class="comment">// 控制逐字显示速度，可调整</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">cancel</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">eventSource</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;cancel&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">submit</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;submit&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setStartingPoint</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">x</span> = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">offsetLeft</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">y</span> = e.<span class="property">clientY</span> - <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">offsetTop</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">isCanMove</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">modelMove</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isCanMove</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">style</span>.<span class="property">left</span> = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="property">x</span> + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">style</span>.<span class="property">top</span> = e.<span class="property">clientY</span> - <span class="variable language_">this</span>.<span class="property">y</span> + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">cancelMove</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">isCanMove</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-bg</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a1a1a</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">900px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">60vh</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-height</span>: <span class="number">800px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">30px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="number">#2a2a2a</span>, <span class="number">#1a1a1a</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: move;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-header</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">1px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">#444</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>));</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-main</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a1a1a</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">scrollbar-width</span>: thin;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">scrollbar-color</span>: <span class="number">#444</span> <span class="number">#1a1a1a</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-main</span>::-webkit-scrollbar &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-main</span>::-webkit-scrollbar-track &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a1a1a</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-main</span>::-webkit-scrollbar-thumb &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-footer</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a1a1a</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-footer</span> <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.model-footer</span> <span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.atalk</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">15px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: flex-start;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.atalk</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>: <span class="string">&quot;🤖&quot;</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.atalk</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#2a2a2a</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#e0e0e0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">12px</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btalk</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">15px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: flex-end;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btalk</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>: <span class="string">&quot;👤&quot;</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btalk</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#0078d4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">12px</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.input-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a1a1a</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.inputword</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#444</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#2a2a2a</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">outline</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.inputword</span><span class="selector-pseudo">:focus</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-color</span>: <span class="number">#0078d4</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btnsend</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#0078d4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: all <span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btnsend</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#0063b1</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btnsend</span><span class="selector-pseudo">:disabled</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#555</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: not-allowed;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 思考中样式 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.atalk</span><span class="selector-class">.thinking</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#aaa</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-style</span>: italic;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#2a2a2a</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 问题样式 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.atalk</span><span class="selector-class">.question</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#4fc3f7</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 打字效果 */</span></span></span><br><span class="line"><span class="language-css"><span class="keyword">@keyframes</span> blink &#123;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">    <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="number">50%</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">opacity</span>: <span class="number">0.5</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.typing-cursor</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>: <span class="string">&quot;|&quot;</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation</span>: blink <span class="number">1s</span> infinite;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#4fc3f7</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="实际效果"><a href="#实际效果" class="headerlink" title="实际效果"></a>实际效果</h2><p><img src="/img/posts/2cdfea6540dd46c0ac183d985fd40a7e.png"></p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>流式输出响应数据</title>
      <link href="/2025/06/29/%E6%B5%81%E5%BC%8F%E8%BE%93%E5%87%BA%E5%93%8D%E5%BA%94%E6%95%B0%E6%8D%AE/"/>
      <url>/2025/06/29/%E6%B5%81%E5%BC%8F%E8%BE%93%E5%87%BA%E5%93%8D%E5%BA%94%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="maven依赖"><a href="#maven依赖" class="headerlink" title="maven依赖"></a>maven依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/dashscope-sdk-java --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dashscope-sdk-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.18.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 使用最新版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Springboot"><a href="#Springboot" class="headerlink" title="Springboot"></a>Springboot</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(AIController.class);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newCachedThreadPool();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> GenerationParam <span class="title function_">buildGenerationParam</span><span class="params">(Message userMsg)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> GenerationParam.builder()</span><br><span class="line">            .apiKey(<span class="string">&quot;sk-20b654c8d6d24f20a17a7349fa9a8641&quot;</span>)</span><br><span class="line">            .model(<span class="string">&quot;deepseek-r1&quot;</span>)</span><br><span class="line">            .messages(Arrays.asList(userMsg))</span><br><span class="line">            .resultFormat(GenerationParam.ResultFormat.MESSAGE)</span><br><span class="line">            .incrementalOutput(<span class="literal">true</span>)</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/query&quot;, produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line"><span class="keyword">public</span> SseEmitter <span class="title function_">getBotContent</span><span class="params">(<span class="meta">@RequestParam</span> String question)</span> &#123;</span><br><span class="line">    <span class="type">SseEmitter</span> <span class="variable">emitter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SseEmitter</span>(<span class="number">60_000L</span>); <span class="comment">// 60秒超时</span></span><br><span class="line"></span><br><span class="line">    executor.execute(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 先发送思考中状态</span></span><br><span class="line">            Map&lt;String, Object&gt; thinkingResponse = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            thinkingResponse.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            thinkingResponse.put(<span class="string">&quot;msg1&quot;</span>, <span class="string">&quot;正在分析您的问题...&quot;</span>);</span><br><span class="line">            emitter.send(SseEmitter.event().data(thinkingResponse));</span><br><span class="line"></span><br><span class="line">            <span class="type">Generation</span> <span class="variable">gen</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Generation</span>();</span><br><span class="line">            <span class="type">Message</span> <span class="variable">userMsg</span> <span class="operator">=</span> Message.builder()</span><br><span class="line">                    .role(Role.USER.getValue())</span><br><span class="line">                    .content(question)</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">            <span class="type">GenerationParam</span> <span class="variable">param</span> <span class="operator">=</span> buildGenerationParam(userMsg);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 处理流式响应</span></span><br><span class="line">            gen.streamCall(param).blockingForEach(message -&gt; &#123;</span><br><span class="line">                Map&lt;String, Object&gt; response = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">                response.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">                <span class="type">String</span> <span class="variable">reasoning</span> <span class="operator">=</span> message.getOutput().getChoices().get(<span class="number">0</span>).getMessage().getReasoningContent();</span><br><span class="line">                <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> message.getOutput().getChoices().get(<span class="number">0</span>).getMessage().getContent();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (reasoning != <span class="literal">null</span> &amp;&amp; !reasoning.isEmpty()) &#123;</span><br><span class="line">                    response.put(<span class="string">&quot;msg1&quot;</span>, reasoning);</span><br><span class="line">                    emitter.send(SseEmitter.event().data(response));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (content != <span class="literal">null</span> &amp;&amp; !content.isEmpty()) &#123;</span><br><span class="line">                    response.remove(<span class="string">&quot;msg1&quot;</span>);</span><br><span class="line">                    response.put(<span class="string">&quot;msg&quot;</span>, content);</span><br><span class="line">                    emitter.send(SseEmitter.event().data(response));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            emitter.complete();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(<span class="string">&quot;Error in streaming response&quot;</span>, e);</span><br><span class="line">            Map&lt;String, Object&gt; errorResponse = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            errorResponse.put(<span class="string">&quot;code&quot;</span>, <span class="number">500</span>);</span><br><span class="line">            errorResponse.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;处理请求时发生错误: &quot;</span> + e.getMessage());</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                emitter.send(SseEmitter.event().data(errorResponse));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ex);</span><br><span class="line">            &#125;</span><br><span class="line">            emitter.completeWithError(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> emitter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-chat-container&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;show&quot;</span> @<span class="attr">mousemove</span>=<span class="string">&quot;modelMove&quot;</span> @<span class="attr">mouseup</span>=<span class="string">&quot;cancelMove&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-chat-window&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-header&quot;</span> @<span class="attr">mousedown</span>=<span class="string">&quot;setStartingPoint&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-logo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-title&quot;</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-close&quot;</span> @<span class="attr">click.stop</span>=<span class="string">&quot;cancel&quot;</span>&gt;</span>×<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-messages&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:class</span>=<span class="string">&quot;[&#x27;message&#x27;, item.id == 2 ? &#x27;bot-message&#x27; : &#x27;user-message&#x27;]&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message-content&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message-text&quot;</span>&gt;</span>&#123;&#123; item.content &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;isButtonDisabled&quot;</span> <span class="attr">class</span>=<span class="string">&quot;typing-indicator&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;dot&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;dot&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;dot&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;doubao-input-area&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;wordone&quot;</span> <span class="attr">class</span>=<span class="string">&quot;doubao-input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入消息...&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;sendmsg&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;doubao-send-btn&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;isButtonDisabled&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;sendmsg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">svg</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span> <span class="attr">width</span>=<span class="string">&quot;20&quot;</span> <span class="attr">height</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M2.01 21L23 12 2.01 3 2 10l15 2-15 2z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">title</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">default</span>: <span class="string">&#x27;deepseek&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">x</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">y</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">node</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">isCanMove</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">isButtonDisabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">list</span>: [],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">wordone</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">wordtow</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">eventSource</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentIndex</span>: <span class="number">0</span>, <span class="comment">// 当前显示的字符索引</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentMessage</span>: <span class="literal">null</span>, <span class="comment">// 当前正在显示的消息对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">typingTimer</span>: <span class="literal">null</span> <span class="comment">// 逐字显示定时器</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">node</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.model-container&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">sendmsg</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> == <span class="literal">false</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 重置相关状态变量</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">currentMessage</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">typingTimer</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;sigtuna&#x27;</span>, <span class="attr">content</span>: <span class="variable language_">this</span>.<span class="property">wordone</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">scrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">getBotContent</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">wordone</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">getBotContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 添加思考中的提示</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;正在思考中...&#x27;</span>, <span class="attr">isThinking</span>: <span class="literal">true</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">eventSource</span> = <span class="keyword">new</span> <span class="title class_">EventSource</span>(<span class="string">`http://localhost:8080/api/deepSeek/query?question=<span class="subst">$&#123;<span class="variable language_">this</span>.wordone&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="property">onmessage</span> = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (data.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (data.<span class="property">msg1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 处理思考问题消息</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentMessage</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">id</span> !== <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前没有正在显示的思考问题消息，或者当前消息不是思考问题消息，或者当前思考问题消息已结束</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span> = &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;思考问题：&#x27;</span> + data.<span class="property">msg1</span>, <span class="attr">isThinking</span>: <span class="literal">true</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">currentMessage</span>);</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前正在显示思考问题消息，追加内容</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> += data.<span class="property">msg1</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (data.<span class="property">msg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 处理回答消息</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentMessage</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">id</span> !== <span class="number">2</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">isThinking</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前没有正在显示的回答消息，或者当前消息不是回答消息，或者当前是思考问题消息</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span> = &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;回答问题：&#x27;</span> + data.<span class="property">msg</span>, <span class="attr">isThinking</span>: <span class="literal">false</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">currentMessage</span>);</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前正在显示回答消息，追加内容</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> += data.<span class="property">msg</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="title function_">scrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="property">onerror</span> = <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 添加新的方法用于处理内容更新时的滚动</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">scrollToBottom</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span></span><br><span class="line"><span class="language-javascript">                div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">startTyping</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">typingTimer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentIndex</span> &lt; <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span>.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> = <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span>.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">currentIndex</span> + <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">currentIndex</span>++;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">const</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span></span><br><span class="line"><span class="language-javascript">                    div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">50</span>); <span class="comment">// 控制逐字显示速度，可调整</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">cancel</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">eventSource</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;cancel&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">submit</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;submit&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setStartingPoint</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">x</span> = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">offsetLeft</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">y</span> = e.<span class="property">clientY</span> - <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">offsetTop</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">isCanMove</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">modelMove</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isCanMove</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">style</span>.<span class="property">left</span> = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="property">x</span> + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">style</span>.<span class="property">top</span> = e.<span class="property">clientY</span> - <span class="variable language_">this</span>.<span class="property">y</span> + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">cancelMove</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">isCanMove</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-chat-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-chat-window</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="string">&quot;Segoe UI&quot;</span>, Roboto, Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="number">#6e8efb</span>, <span class="number">#a777e3</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: move;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-logo</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-right</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-title</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-close</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: background <span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-close</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-messages</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f5f7fb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.user-message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-self</span>: flex-end;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bot-message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">12px</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.user-message</span> <span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top-right-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bot-message</span> <span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top-left-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-input-area</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#e5e5e5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-input</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e5e5e5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">outline</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: border <span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-input</span><span class="selector-pseudo">:focus</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-color</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-send-btn</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-left</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: background <span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-send-btn</span><span class="selector-pseudo">:disabled</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#cccccc</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: not-allowed;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-send-btn</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:disabled</span>)<span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#5a7df4</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.typing-indicator</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-top</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#a777e3</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation</span>: bounce <span class="number">1.4s</span> infinite ease-in-out;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation-delay</span>: <span class="number">0s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation-delay</span>: <span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation-delay</span>: <span class="number">0.4s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="keyword">@keyframes</span> bounce &#123;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">    <span class="number">60%</span>,</span></span><br><span class="line"><span class="language-css">    <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="number">30%</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">5px</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 滚动条样式 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-messages</span>::-webkit-scrollbar &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-messages</span>::-webkit-scrollbar-track &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-messages</span>::-webkit-scrollbar-thumb &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#c1c1c1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-messages</span>::-webkit-scrollbar-thumb:hover &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#a8a8a8</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="同时在主页面中引入"><a href="#同时在主页面中引入" class="headerlink" title="同时在主页面中引入"></a>同时在主页面中引入</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Model</span> <span class="attr">:show</span>=<span class="string">&quot;show&quot;</span> @<span class="attr">cancel</span>=<span class="string">&quot;cancel&quot;</span> @<span class="attr">submit</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Model</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">Model</span> <span class="keyword">from</span> <span class="string">&#x27;./Model.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">Model</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">cancel</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">submit</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">diaglog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="uni-app"><a href="#uni-app" class="headerlink" title="uni-app"></a>uni-app</h3><p>下载依赖</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import uniIcons from <span class="string">&#x27;@dcloudio/uni-ui/lib/uni-icons/uni-icons.vue&#x27;</span></span><br></pre></td></tr></table></figure><p>页面代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;doubao-page&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;doubao-header&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;doubao-logo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;doubao-title&quot;</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;doubao-messages&quot;</span> <span class="attr">scroll-y</span>=<span class="string">&quot;true&quot;</span> <span class="attr">:scroll-top</span>=<span class="string">&quot;scrollTop&quot;</span> <span class="attr">scroll-with-animation</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:class</span>=<span class="string">&quot;[&#x27;message-container&#x27;, item.id == 2 ? &#x27;bot-container&#x27; : &#x27;user-container&#x27;]&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;message-content&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;item.id == 2 ? &#x27;bot-message&#x27; : &#x27;user-message&#x27;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;message-text&quot;</span>&gt;</span>&#123;&#123; item.content &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">&quot;isButtonDisabled&quot;</span> <span class="attr">class</span>=<span class="string">&quot;typing-indicator&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;dot&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;dot&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;dot&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;doubao-input-area&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;wordone&quot;</span> <span class="attr">class</span>=<span class="string">&quot;doubao-input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入消息...&quot;</span> @<span class="attr">confirm</span>=<span class="string">&quot;sendmsg&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;doubao-send-btn&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;isButtonDisabled&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;sendmsg&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">uni-icons</span> <span class="attr">type</span>=<span class="string">&quot;paperplane&quot;</span> <span class="attr">size</span>=<span class="string">&quot;20&quot;</span> <span class="attr">color</span>=<span class="string">&quot;#fff&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">uni-icons</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> uniIcons <span class="keyword">from</span> <span class="string">&#x27;@dcloudio/uni-ui/lib/uni-icons/uni-icons.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      uniIcons</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">title</span>: <span class="string">&#x27;deepseek&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">isButtonDisabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">list</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">content</span>: <span class="string">&#x27;您好！我是智能助手，有什么可以帮您的吗？&#x27;</span> &#125;</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">wordone</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">scrollTop</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentIndex</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">currentMessage</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">typingTimer</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">eventSource</span>: <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">sendmsg</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> || !<span class="variable language_">this</span>.<span class="property">wordone</span>.<span class="title function_">trim</span>()) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 清除之前的定时器和状态</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">eventSource</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">currentMessage</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">typingTimer</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 添加用户消息</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">content</span>: <span class="variable language_">this</span>.<span class="property">wordone</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">scrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 获取机器人回复</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">getBotContent</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">wordone</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">getBotContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 添加思考中的提示</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;正在思考中...&#x27;</span>, <span class="attr">isThinking</span>: <span class="literal">true</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">eventSource</span> = <span class="keyword">new</span> <span class="title class_">EventSource</span>(<span class="string">`http://localhost:8080/api/deepSeek/query?question=<span class="subst">$&#123;<span class="variable language_">this</span>.wordone&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="property">onmessage</span> = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (data.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (data.<span class="property">msg1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="comment">// 处理思考问题消息</span></span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentMessage</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">id</span> !== <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前没有正在显示的思考问题消息，或者当前消息不是思考问题消息，或者当前思考问题消息已结束</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span> = &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;思考问题：&#x27;</span> + data.<span class="property">msg1</span>, <span class="attr">isThinking</span>: <span class="literal">true</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">currentMessage</span>);</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前正在显示思考问题消息，追加内容</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> += data.<span class="property">msg1</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (data.<span class="property">msg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 处理回答消息</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">currentMessage</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">id</span> !== <span class="number">2</span> || <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">isThinking</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前没有正在显示的回答消息，或者当前消息不是回答消息，或者当前是思考问题消息</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span> = &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;回答问题：&#x27;</span> + data.<span class="property">msg</span>, <span class="attr">isThinking</span>: <span class="literal">false</span> &#125;;</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">currentMessage</span>);</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentIndex</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 如果当前正在显示回答消息，追加内容</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> += data.<span class="property">msg</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="title function_">forceScrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="property">onerror</span> = <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">scrollToBottom</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">scrollTop</span> = <span class="number">999999</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 强效滚动到底部方法</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">forceScrollToBottom</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> query = uni.<span class="title function_">createSelectorQuery</span>().<span class="title function_">in</span>(<span class="variable language_">this</span>);</span></span><br><span class="line"><span class="language-javascript">                query.<span class="title function_">select</span>(<span class="string">&#x27;.doubao-messages&#x27;</span>).<span class="title function_">boundingClientRect</span>();</span></span><br><span class="line"><span class="language-javascript">                query.<span class="title function_">select</span>(<span class="string">&#x27;.doubao-messages&#x27;</span>).<span class="title function_">scrollOffset</span>();</span></span><br><span class="line"><span class="language-javascript">                query.<span class="title function_">exec</span>(<span class="function">(<span class="params">rects</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (rects &amp;&amp; rects[<span class="number">1</span>]) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">const</span> scrollHeight = rects[<span class="number">0</span>].<span class="property">height</span>;</span></span><br><span class="line"><span class="language-javascript">                        uni.<span class="title function_">pageScrollTo</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">scrollTop</span>: scrollHeight,</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">duration</span>: <span class="number">300</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;);</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">startTyping</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">typingTimer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">currentIndex</span> &lt; <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span>.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span> = <span class="variable language_">this</span>.<span class="property">currentMessage</span>.<span class="property">content</span>.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">currentIndex</span> + <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">currentIndex</span>++;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="title function_">scrollToBottom</span>();</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">50</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">onUnload</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 页面卸载时关闭连接</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">eventSource</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">eventSource</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">typingTimer</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">typingTimer</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-page</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">90vh</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#f5f7fb</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">120</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="number">#6e8efb</span>, <span class="number">#a777e3</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: sticky;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">10</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-logo</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">64</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">64</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-right</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-title</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-messages</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f5f7fb</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.user-message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-self</span>: flex-end;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bot-message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">24</span>rpx <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.user-message</span> <span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top-right-radius</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bot-message</span> <span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4</span>rpx <span class="number">16</span>rpx <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top-left-radius</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-input-area</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#e5e5e5</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-input</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#e5e5e5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-send-btn</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.doubao-send-btn</span><span class="selector-attr">[disabled]</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#cccccc</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.typing-indicator</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">16</span>rpx <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4</span>rpx <span class="number">16</span>rpx <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-top</span>: <span class="number">16</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">16</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">16</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#a777e3</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation</span>: bounce <span class="number">1.4s</span> infinite ease-in-out;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation-delay</span>: <span class="number">0s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation-delay</span>: <span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.dot</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation-delay</span>: <span class="number">0.4s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="keyword">@keyframes</span> bounce &#123;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="number">0%</span>,</span></span><br><span class="line"><span class="language-css">    <span class="number">60%</span>,</span></span><br><span class="line"><span class="language-css">    <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="number">30%</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">10</span>rpx);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.message-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.user-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: flex-end;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bot-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: flex-start;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 修改原有消息样式 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.message-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">24</span>rpx <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.user-message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#6e8efb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top-right-radius</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-bottom-left-radius</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bot-message</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4</span>rpx <span class="number">16</span>rpx <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top-left-radius</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-bottom-right-radius</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>css中grid的使用</title>
      <link href="/2025/06/29/css%E4%B8%ADgrid%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2025/06/29/css%E4%B8%ADgrid%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="CSS-Grid-布局完全指南"><a href="#CSS-Grid-布局完全指南" class="headerlink" title="CSS Grid 布局完全指南"></a>CSS Grid 布局完全指南</h2><ol><li>基本概念</li></ol><p>CSS Grid 布局是 CSS 中最强大的二维布局系统，它允许我们通过行和列的方式来创建复杂的网页布局。</p><p>核心特点：<br>• 二维布局：同时控制行和列</p><p>• 精准定位：可以精确控制每个网格项的位置</p><p>• 响应式友好：轻松创建适应不同屏幕尺寸的布局</p><p>• 代码简洁：减少布局所需的HTML结构和CSS代码</p><ol start="2"><li>基础语法</li></ol><p>2.1 创建网格容器</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid; <span class="comment">/* 或 inline-grid */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.2 定义网格轨道</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">100px</span> <span class="number">200px</span> <span class="number">1</span>fr; <span class="comment">/* 3列 */</span></span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">50px</span> auto <span class="number">100px</span>; <span class="comment">/* 3行 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>网格属性详解</li></ol><p>3.1 容器属性</p><table><thead><tr><th>属性</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td><code>grid-template-columns</code></td><td>定义列宽</td><td><code>repeat(4, 1fr)</code></td></tr><tr><td><code>grid-template-rows</code></td><td>定义行高</td><td><code>100px minmax(200px, auto)</code></td></tr><tr><td><code>grid-template-areas</code></td><td>定义命名网格区域</td><td><code>&quot;header header&quot; &quot;sidebar main&quot;</code></td></tr><tr><td><code>gap</code></td><td>网格间距</td><td><code>gap: 20px 10px</code> (行 列)</td></tr><tr><td><code>justify-items</code></td><td>网格项水平对齐</td><td>&#96;start</td></tr><tr><td><code>align-items</code></td><td>网格项垂直对齐</td><td>&#96;start</td></tr><tr><td><code>grid-auto-flow</code></td><td>自动放置算法</td><td>&#96;row</td></tr></tbody></table><p>3.2 网格项属性</p><table><thead><tr><th>属性</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td><code>grid-column</code></td><td>跨列控制</td><td><code>1 / 3</code> 或 <code>span 2</code></td></tr><tr><td><code>grid-row</code></td><td>跨行控制</td><td><code>2 / 4</code> 或 <code>span 3</code></td></tr><tr><td><code>grid-area</code></td><td>指定命名区域</td><td><code>header</code></td></tr><tr><td><code>justify-self</code></td><td>单项水平对齐</td><td>&#96;start</td></tr><tr><td><code>align-self</code></td><td>单项垂直对齐</td><td>&#96;start</td></tr></tbody></table><ol start="4"><li>实用布局模式</li></ol><p>4.1 经典12列布局</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(<span class="number">12</span>, <span class="number">1</span>fr);</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item-4col</span> &#123;</span><br><span class="line">  <span class="attribute">grid-column</span>: span <span class="number">4</span>; <span class="comment">/* 占4列 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item-6col</span> &#123;</span><br><span class="line">  <span class="attribute">grid-column</span>: span <span class="number">6</span>; <span class="comment">/* 占6列 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.2 响应式网格</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.grid</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="built_in">minmax</span>(<span class="number">250px</span>, <span class="number">1</span>fr));</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.3 大屏仪表盘布局</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.dashboard</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template</span>:</span><br><span class="line">    <span class="string">&quot;header header header&quot;</span> <span class="number">80px</span></span><br><span class="line">    <span class="string">&quot;sidebar chart chart&quot;</span> <span class="number">1</span>fr</span><br><span class="line">    <span class="string">&quot;sidebar stats stats&quot;</span> auto</span><br><span class="line">    / <span class="number">250px</span> <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123; <span class="attribute">grid-area</span>: header; &#125;</span><br><span class="line"><span class="selector-class">.sidebar</span> &#123; <span class="attribute">grid-area</span>: sidebar; &#125;</span><br><span class="line"><span class="selector-class">.chart</span> &#123; <span class="attribute">grid-area</span>: chart; &#125;</span><br><span class="line"><span class="selector-class">.stats</span> &#123; <span class="attribute">grid-area</span>: stats; &#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>高级技巧</li></ol><p>5.1 隐式网格</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">grid-auto-rows</span>: <span class="number">100px</span>; <span class="comment">/* 隐式行高 */</span></span><br><span class="line">  <span class="attribute">grid-auto-columns</span>: <span class="number">1</span>fr; <span class="comment">/* 隐式列宽 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.2 重叠元素</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item1</span> &#123;</span><br><span class="line">  <span class="attribute">grid-column</span>: <span class="number">1</span> / <span class="number">3</span>;</span><br><span class="line">  <span class="attribute">grid-row</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item2</span> &#123;</span><br><span class="line">  <span class="attribute">grid-column</span>: <span class="number">2</span> / <span class="number">4</span>;</span><br><span class="line">  <span class="attribute">grid-row</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.3 子网格</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: subgrid; <span class="comment">/* 继承父网格 */</span></span><br><span class="line">  <span class="attribute">grid-column</span>: span <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>最佳实践</li><li>命名网格线提高可读性：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">grid-template-columns</span>: [start] <span class="number">1</span>fr [center] <span class="number">1</span>fr [end];</span><br></pre></td></tr></table></figure><ol start="8"><li>结合CSS变量实现动态布局：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--columns</span>: <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.grid</span> &#123;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(<span class="built_in">var</span>(--columns), <span class="number">1</span>fr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="9"><li>渐进增强策略：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left; <span class="comment">/* 旧浏览器回退 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">25%</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">@supports</span> (<span class="attribute">display</span>: <span class="attribute">grid</span>) &#123;</span><br><span class="line">    <span class="attribute">float</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: auto;</span><br><span class="line">    <span class="attribute">grid-column</span>: span <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="10"><li>浏览器支持</li></ol><p>• 所有现代浏览器完全支持（包括Edge 16+）</p><p>• IE10&#x2F;11支持旧版语法（加<code>-ms-</code>前缀）</p><p>• 推荐使用Autoprefixer处理兼容性</p><ol start="8"><li>学习资源</li><li><a href="https://css-tricks.com/snippets/css/complete-guide-grid/">CSS Tricks Grid完全指南</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Grid_Layout">MDN Grid布局</a></li><li><a href="https://gridbyexample.com/">Grid by Example</a></li></ol><hr><p>这份文档涵盖了CSS Grid的核心知识点，建议保存为Markdown文件(.md)以便随时查阅。需要任何部分的详细解释或具体示例，可以随时告诉我！</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java实现Argon2加密</title>
      <link href="/2025/06/29/Java%E5%AE%9E%E7%8E%B0Argon2%E5%8A%A0%E5%AF%86/"/>
      <url>/2025/06/29/Java%E5%AE%9E%E7%8E%B0Argon2%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<p>以下是使用 Argon2 算法的 Java 实现，用于安全密码哈希存储。Argon2 是密码哈希竞赛（PHC）的获胜者，被公认为当前最安全的密码哈希算法之一。</p><hr><h2 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h2><p>首先，在 <code>pom.xml</code> 中添加 <a href="https://www.bouncycastle.org/">Bouncy Castle</a> 或 <a href="https://github.com/phxql/argon2-jvm">Argon2 JVM</a> 支持：</p><p><strong>选项1：Bouncy Castle（推荐）</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.bouncycastle<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>bcprov-jdk15on<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.70<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>选项2：Argon2 JVM</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.mkammerer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>argon2-jvm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="2-完整代码实现（基于-Bouncy-Castle）"><a href="#2-完整代码实现（基于-Bouncy-Castle）" class="headerlink" title="2. 完整代码实现（基于 Bouncy Castle）"></a>2. 完整代码实现（基于 Bouncy Castle）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.generators.Argon2BytesGenerator;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.params.Argon2Parameters;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Argon2PasswordHasher</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Argon2 配置参数（可根据硬件性能调整）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ITERATIONS</span> <span class="operator">=</span> <span class="number">10</span>;          <span class="comment">// 迭代次数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MEMORY</span> <span class="operator">=</span> <span class="number">65536</span>;          <span class="comment">// 内存消耗（KB）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PARALLELISM</span> <span class="operator">=</span> <span class="number">1</span>;         <span class="comment">// 并行线程数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SALT_LENGTH</span> <span class="operator">=</span> <span class="number">16</span>;        <span class="comment">// 盐值长度（字节）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">HASH_LENGTH</span> <span class="operator">=</span> <span class="number">32</span>;        <span class="comment">// 哈希输出长度（字节）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成 Argon2 哈希密码（格式：盐值:哈希值）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">hashPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="comment">// 生成随机盐值</span></span><br><span class="line">        <span class="type">byte</span>[] salt = generateSalt(SALT_LENGTH);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 配置 Argon2 参数</span></span><br><span class="line">        Argon2Parameters.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Argon2Parameters</span>.Builder(Argon2Parameters.ARGON2_id)</span><br><span class="line">                .withSalt(salt)</span><br><span class="line">                .withIterations(ITERATIONS)</span><br><span class="line">                .withMemoryAsKB(MEMORY)</span><br><span class="line">                .withParallelism(PARALLELISM);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成哈希</span></span><br><span class="line">        <span class="type">Argon2BytesGenerator</span> <span class="variable">generator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Argon2BytesGenerator</span>();</span><br><span class="line">        generator.init(builder.build());</span><br><span class="line">        <span class="type">byte</span>[] hash = <span class="keyword">new</span> <span class="title class_">byte</span>[HASH_LENGTH];</span><br><span class="line">        generator.generateBytes(password.toCharArray(), hash);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回 Base64 编码的盐值和哈希</span></span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder().encodeToString(salt) + <span class="string">&quot;:&quot;</span> + </span><br><span class="line">               Base64.getEncoder().encodeToString(hash);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证密码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">verifyPassword</span><span class="params">(String inputPassword, String storedHash)</span> &#123;</span><br><span class="line">        <span class="comment">// 拆分盐值和哈希</span></span><br><span class="line">        String[] parts = storedHash.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">        <span class="type">byte</span>[] salt = Base64.getDecoder().decode(parts[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">byte</span>[] originalHash = Base64.getDecoder().decode(parts[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用相同盐值重新计算哈希</span></span><br><span class="line">        Argon2Parameters.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Argon2Parameters</span>.Builder(Argon2Parameters.ARGON2_id)</span><br><span class="line">                .withSalt(salt)</span><br><span class="line">                .withIterations(ITERATIONS)</span><br><span class="line">                .withMemoryAsKB(MEMORY)</span><br><span class="line">                .withParallelism(PARALLELISM);</span><br><span class="line"></span><br><span class="line">        <span class="type">Argon2BytesGenerator</span> <span class="variable">generator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Argon2BytesGenerator</span>();</span><br><span class="line">        generator.init(builder.build());</span><br><span class="line">        <span class="type">byte</span>[] newHash = <span class="keyword">new</span> <span class="title class_">byte</span>[HASH_LENGTH];</span><br><span class="line">        generator.generateBytes(inputPassword.toCharArray(), newHash);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对比哈希值</span></span><br><span class="line">        <span class="keyword">return</span> MessageDigest.isEqual(originalHash, newHash);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成随机盐值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] generateSalt(<span class="type">int</span> length) &#123;</span><br><span class="line">        <span class="type">SecureRandom</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecureRandom</span>();</span><br><span class="line">        <span class="type">byte</span>[] salt = <span class="keyword">new</span> <span class="title class_">byte</span>[length];</span><br><span class="line">        random.nextBytes(salt);</span><br><span class="line">        <span class="keyword">return</span> salt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试示例</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;MySecurePassword123!&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 哈希密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">hashedPassword</span> <span class="operator">=</span> hashPassword(password);</span><br><span class="line">        System.out.println(<span class="string">&quot;Hashed Password: &quot;</span> + hashedPassword);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 验证密码</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isValid</span> <span class="operator">=</span> verifyPassword(password, hashedPassword);</span><br><span class="line">        System.out.println(<span class="string">&quot;Password Valid: &quot;</span> + isValid); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">        isValid = verifyPassword(<span class="string">&quot;WrongPassword&quot;</span>, hashedPassword);</span><br><span class="line">        System.out.println(<span class="string">&quot;Wrong Password Valid: &quot;</span> + isValid); <span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="3-关键参数说明"><a href="#3-关键参数说明" class="headerlink" title="3. 关键参数说明"></a>3. 关键参数说明</h2><table><thead><tr><th>参数</th><th>推荐值</th><th>作用</th></tr></thead><tbody><tr><td>ITERATIONS</td><td>10-20</td><td>增加计算时间，防御暴力破解</td></tr><tr><td>MEMORY</td><td>64MB-1GB (65536 KB)</td><td>增加内存消耗，防御GPU&#x2F;ASIC攻击</td></tr><tr><td>PARALLELISM</td><td>1-2</td><td>并行线程数（通常1即可）</td></tr><tr><td>SALT_LENGTH</td><td>16字节</td><td>确保每个密码哈希唯一</td></tr><tr><td>HASH_LENGTH</td><td>32字节</td><td>输出哈希长度（与SHA-256一致）</td></tr></tbody></table><hr><h2 id="4-为什么选择-Argon2？"><a href="#4-为什么选择-Argon2？" class="headerlink" title="4. 为什么选择 Argon2？"></a>4. 为什么选择 Argon2？</h2><ol><li>抗GPU&#x2F;ASIC：内存密集型设计，显著增加硬件攻击成本。</li><li>灵活配置：可调整时间&#x2F;内存&#x2F;线程参数，适应不同硬件。</li><li>PHC获胜者：学术界和工业界公认的最安全密码哈希算法。</li></ol><hr><h2 id="5-注意事项"><a href="#5-注意事项" class="headerlink" title="5. 注意事项"></a>5. 注意事项</h2><p>• 参数调优：根据服务器性能调整 <code>ITERATIONS</code> 和 <code>MEMORY</code>（目标：哈希耗时约0.5-1秒）。</p><p>• 密码编码：建议明确指定字符集（如 <code>password.getBytes(StandardCharsets.UTF_8)</code>）。</p><p>• 依赖更新：定期检查 Bouncy Castle 的<a href="https://www.bouncycastle.org/latest_releases.html">安全公告</a>。</p><hr><h2 id="6-性能对比（示例）"><a href="#6-性能对比（示例）" class="headerlink" title="6. 性能对比（示例）"></a>6. 性能对比（示例）</h2><table><thead><tr><th>算法</th><th>哈希耗时（1核CPU）</th><th>抗GPU攻击能力</th></tr></thead><tbody><tr><td>SHA-256</td><td>0.01ms</td><td>❌</td></tr><tr><td>PBKDF2</td><td>100ms</td><td>⚠️中等</td></tr><tr><td>Argon2</td><td>500ms</td><td>✅最强</td></tr></tbody></table><hr><p>以上实现可直接用于生产环境，如需进一步强化，可结合加密（如AES）存储盐值。</p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Navicat密码破解</title>
      <link href="/2025/06/29/Navicat%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3/"/>
      <url>/2025/06/29/Navicat%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">namespace</span> <span class="title class_">FatSmallTools</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NavicatPassword</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$version</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$aesKey</span> = <span class="string">&#x27;libcckeylibcckey&#x27;</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$aesIv</span> = <span class="string">&#x27;libcciv libcciv &#x27;</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$blowString</span> = <span class="string">&#x27;3DC5CA39&#x27;</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$blowKey</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$blowIv</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$version</span> = <span class="number">12</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;version = <span class="variable">$version</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;blowKey = <span class="title function_ invoke__">sha1</span>(<span class="string">&#x27;3DC5CA39&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;blowIv = <span class="title function_ invoke__">hex2bin</span>(<span class="string">&#x27;d9c7c3c8870d64bd&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="literal">FALSE</span>;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">$this</span>-&gt;version) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">      <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encryptEleven</span>(<span class="variable">$string</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">      <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encryptTwelve</span>(<span class="variable">$string</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">encryptEleven</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$round</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">floor</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$string</span>) / <span class="number">8</span>));</span><br><span class="line">    <span class="variable">$leftLength</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$string</span>) % <span class="number">8</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$currentVector</span> = <span class="variable language_">$this</span>-&gt;blowIv;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$round</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">      <span class="variable">$temp</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encryptBlock</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">xorBytes</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$string</span>, <span class="number">8</span> * <span class="variable">$i</span>, <span class="number">8</span>), <span class="variable">$currentVector</span>));</span><br><span class="line">      <span class="variable">$currentVector</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">xorBytes</span>(<span class="variable">$currentVector</span>, <span class="variable">$temp</span>);</span><br><span class="line">      <span class="variable">$result</span> .= <span class="variable">$temp</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$leftLength</span>) &#123;</span><br><span class="line">      <span class="variable">$currentVector</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encryptBlock</span>(<span class="variable">$currentVector</span>);</span><br><span class="line">      <span class="variable">$result</span> .= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">xorBytes</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$string</span>, <span class="number">8</span> * <span class="variable">$i</span>, <span class="variable">$leftLength</span>), <span class="variable">$currentVector</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strtoupper</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$result</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">encryptBlock</span>(<span class="params"><span class="variable">$block</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$block</span>, <span class="string">&#x27;BF-ECB&#x27;</span>, <span class="variable">$this</span>-&gt;blowKey, OPENSSL_RAW_DATA|OPENSSL_NO_PADDING); </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">decryptBlock</span>(<span class="params"><span class="variable">$block</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$block</span>, <span class="string">&#x27;BF-ECB&#x27;</span>, <span class="variable">$this</span>-&gt;blowKey, OPENSSL_RAW_DATA|OPENSSL_NO_PADDING); </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">xorBytes</span>(<span class="params"><span class="variable">$str1</span>, <span class="variable">$str2</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$str1</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">      <span class="variable">$result</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$str1</span>[<span class="variable">$i</span>]) ^ <span class="title function_ invoke__">ord</span>(<span class="variable">$str2</span>[<span class="variable">$i</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">encryptTwelve</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$string</span>, <span class="string">&#x27;AES-128-CBC&#x27;</span>, <span class="variable">$this</span>-&gt;aesKey, OPENSSL_RAW_DATA, <span class="variable">$this</span>-&gt;aesIv);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">strtoupper</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$result</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="literal">FALSE</span>;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">$this</span>-&gt;version) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">      <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">decryptEleven</span>(<span class="variable">$string</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">      <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">decryptTwelve</span>(<span class="variable">$string</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">decryptEleven</span>(<span class="params"><span class="variable">$upperString</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$upperString</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$round</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">floor</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$string</span>) / <span class="number">8</span>));</span><br><span class="line">    <span class="variable">$leftLength</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$string</span>) % <span class="number">8</span>;</span><br><span class="line">        <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$currentVector</span> = <span class="variable language_">$this</span>-&gt;blowIv;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$round</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$encryptedBlock</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$string</span>, <span class="number">8</span> * <span class="variable">$i</span>, <span class="number">8</span>);</span><br><span class="line">            <span class="variable">$temp</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">xorBytes</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">decryptBlock</span>(<span class="variable">$encryptedBlock</span>), <span class="variable">$currentVector</span>);</span><br><span class="line">            <span class="variable">$currentVector</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">xorBytes</span>(<span class="variable">$currentVector</span>, <span class="variable">$encryptedBlock</span>);</span><br><span class="line">            <span class="variable">$result</span> .= <span class="variable">$temp</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$leftLength</span>) &#123;</span><br><span class="line">            <span class="variable">$currentVector</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encryptBlock</span>(<span class="variable">$currentVector</span>);</span><br><span class="line">            <span class="variable">$result</span> .= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">xorBytes</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$string</span>, <span class="number">8</span> * <span class="variable">$i</span>, <span class="variable">$leftLength</span>), <span class="variable">$currentVector</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">decryptTwelve</span>(<span class="params"><span class="variable">$upperString</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$string</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$upperString</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$string</span>, <span class="string">&#x27;AES-128-CBC&#x27;</span>, <span class="variable">$this</span>-&gt;aesKey, OPENSSL_RAW_DATA, <span class="variable">$this</span>-&gt;aesIv);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">use</span> <span class="title">FatSmallTools</span>\<span class="title">NavicatPassword</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//需要指定版本，11或12</span></span><br><span class="line"><span class="variable">$navicatPassword</span> = <span class="keyword">new</span> <span class="title class_">NavicatPassword</span>(<span class="number">12</span>);</span><br><span class="line"><span class="comment">//$navicatPassword = new NavicatPassword(11);</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//解密</span></span><br><span class="line"><span class="variable">$decode</span> = <span class="variable">$navicatPassword</span>-&gt;<span class="title function_ invoke__">decrypt</span>(<span class="string">&#x27;83FE5103FF5714ABDC150F4DF889D435&#x27;</span>);</span><br><span class="line"><span class="comment">//$decode = $navicatPassword-&gt;decrypt(&#x27;83FE5103FF5714ABDC150F4DF889D435&#x27;);</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$decode</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ECharts View 可视化 IDEA 插件</title>
      <link href="/2025/06/09/ECharts%20View%20%E5%8F%AF%E8%A7%86%E5%8C%96%20IDEA%20%E6%8F%92%E4%BB%B6/"/>
      <url>/2025/06/09/ECharts%20View%20%E5%8F%AF%E8%A7%86%E5%8C%96%20IDEA%20%E6%8F%92%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="ECharts-View-可视化-IDEA-插件"><a href="#ECharts-View-可视化-IDEA-插件" class="headerlink" title="ECharts View 可视化 IDEA 插件"></a>ECharts View 可视化 IDEA 插件</h1><p>本插件基于 JCEF，为 JetBrains IDEA 系列 IDE 提供 ECharts option 的一键可视化能力。支持自动 mock&#x2F;清理 option 中的非法内容（如变量、表达式、函数等），让复杂 option 也能顺利渲染为图表，极大提升前端&#x2F;数据可视化开发体验。</p><h2 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h2><p>在IDEA的插件市场安装Jtool<br><img src="/img/posts/c3c3dba1fb2e4f24b93a3e05c87b1baf.png" alt="在这里插入图片描述"><br>安装之后，在仓库地址里面下载jar包</p><blockquote><p><a href="https://github.com/jtools-plugins/jtool-echarts-view">https://github.com/jtools-plugins/jtool-echarts-view</a></p></blockquote><p><img src="/img/posts/927143dc112245c5ae25139987661b4d.png" alt="在这里插入图片描述"></p><p>下载完成之后，导入jar包<br><img src="/img/posts/c2c8ec94d7b34e99ad52dc78a0953024.png" alt="在这里插入图片描述"></p><p>jar包往这里面拖拽就行</p><h2 id="插件使用"><a href="#插件使用" class="headerlink" title="插件使用"></a>插件使用</h2><h3 id="一般使用"><a href="#一般使用" class="headerlink" title="一般使用"></a>一般使用</h3><p><img src="/img/posts/018e7df9fe1c470599b14881b17f10f7.png" alt="在这里插入图片描述"><br>在左边框选住echarts的option配置，插件右边点击可视化，即可查看图表的样式</p><h3 id="变量自动获取"><a href="#变量自动获取" class="headerlink" title="变量自动获取"></a>变量自动获取</h3><p><img src="/img/posts/c2c195047cba46a0b87730fc9c302893.png" alt="在这里插入图片描述"><br>如上所示，data1与data2的变量的值，并未在选择框中，但是插件会进行全文索引，获取这两变量的值方便开发者进行调试，开发者只需要在意调试图表样式即可，其他的交给插件</p><h2 id="功能特性"><a href="#功能特性" class="headerlink" title="功能特性"></a>功能特性</h2><ul><li><strong>选区可视化</strong>：在编辑器中选中 ECharts option（支持 JSON&#x2F;JSON5&#x2F;JS 对象），点击“可视化”按钮即可渲染图表。</li><li><strong>智能 mock</strong>：自动 mock&#x2F;清理 option 里的 <code>data</code>、<code>formatter</code> 等字段的非法内容，支持变量查找和 mock 替换，最大程度保证 option 可被 JSON5 解析。</li><li><strong>JCEF 内嵌渲染</strong>：基于 JCEF 内嵌 ECharts 前端页面，支持丰富的交互和美观的图表展示。</li><li><strong>兼容复杂 option</strong>：支持 option 中存在变量、表达式、函数、this.xxx、new 表达式等复杂 JS 代码，自动降级为 mock 数据。</li><li><strong>保留字符串 formatter</strong>：只清理函数&#x2F;表达式类型的 <code>formatter</code>，字符串类型的 formatter 会被保留。</li></ul><h2 id="安装与构建"><a href="#安装与构建" class="headerlink" title="安装与构建"></a>安装与构建</h2><h3 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h3><ul><li>IntelliJ IDEA 2022.3 及以上（推荐 2024.1+）</li><li>JDK 17</li><li>Gradle</li></ul><h3 id="构建插件"><a href="#构建插件" class="headerlink" title="构建插件"></a>构建插件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew build</span><br></pre></td></tr></table></figure><p>生成的插件包位于 <code>build/libs/</code> 目录下，可直接在 IDEA 中安装。</p><h3 id="运行-x2F-调试"><a href="#运行-x2F-调试" class="headerlink" title="运行&#x2F;调试"></a>运行&#x2F;调试</h3><ol><li>使用 IDEA 打开本项目。</li><li>运行 <code>PluginImpl</code> 或使用 Gradle 的 <code>runIde</code> 任务启动开发版 IDE，自动加载插件。</li></ol><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ol><li>在代码区选中 ECharts 的 option（支持 JSON&#x2F;JS&#x2F;JSON5 格式）。</li><li>打开插件工具窗口，点击“可视化”按钮。</li><li>插件会自动 mock&#x2F;清理非法内容，并在右侧渲染图表和 option JSON。</li></ol><h2 id="主要实现说明"><a href="#主要实现说明" class="headerlink" title="主要实现说明"></a>主要实现说明</h2><ul><li><strong>核心类</strong>：<ul><li><code>PluginImpl.java</code>：插件主入口，负责 UI、事件绑定、JCEF 加载和 option 处理。</li><li><code>OptionMocker.java</code>：智能 mock&#x2F;清理 option 字段，支持变量查找、堆栈法提取 JS 值、mock 替换等。</li><li><code>echarts_view.html</code> + <code>static/echarts.min.js</code>：前端页面和 ECharts 渲染核心。</li></ul></li><li><strong>mock 逻辑</strong>：<ul><li>支持从整个文件内容中查找变量声明，自动替换 option 里的 <code>data: xxx</code> 为 mock 数组或变量值。</li><li>递归清理 option 中的函数、表达式、this.xxx、new 等非法内容，最大程度保证 JSON5 可解析。</li><li>保留字符串类型的 <code>formatter</code>，只 mock&#x2F;清理函数类型的 formatter。</li></ul></li></ul><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">src/</span><br><span class="line">  main/</span><br><span class="line">    java/org/example/</span><br><span class="line">      PluginImpl.java         // 插件主入口</span><br><span class="line">      OptionMocker.java       // option mock/清理核心</span><br><span class="line">      EchartsToolWindowFactory.java</span><br><span class="line">      DynamicLanguageTextField.java</span><br><span class="line">      Main.java</span><br><span class="line">    resources/</span><br><span class="line">      echarts_view.html       // 前端页面</span><br><span class="line">      static/</span><br><span class="line">        echarts.min.js        // ECharts 核心库</span><br><span class="line">        index.min.js          // 前端交互逻辑</span><br><span class="line">      META-INF/</span><br><span class="line">      *.svg                   // 插件图标</span><br><span class="line">      test.js</span><br><span class="line">build.gradle                 // 构建脚本</span><br><span class="line">pluginInfo.json              // 插件元信息</span><br></pre></td></tr></table></figure><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><ul><li><strong>option 依然无法渲染？</strong><br>极端复杂的 option 可能仍有无法完全 mock 的情况，建议尽量使用标准 JSON 格式的 option。</li><li><strong>JCEF 加载失败？</strong><br>请确保 IDEA 版本支持 JCEF，或升级到 2022.3 及以上。</li></ul><h2 id="贡献与反馈"><a href="#贡献与反馈" class="headerlink" title="贡献与反馈"></a>贡献与反馈</h2><p>欢迎 issue、PR 或建议！</p><hr><p>如需更详细的使用说明或遇到具体问题，欢迎随时反馈！</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Django跨域问题</title>
      <link href="/2025/06/09/Django%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
      <url>/2025/06/09/Django%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>先安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django-cors-headers</span><br></pre></td></tr></table></figure><p>修改内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setting.py 修改以下内容</span></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&#x27;django.contrib.admin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.auth&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.contenttypes&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.staticfiles&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;corsheaders&#x27;</span>, <span class="comment"># 注册app corsheaders</span></span><br><span class="line">    <span class="string">&#x27;app01&#x27;</span>,<span class="comment"># 你的app</span></span><br><span class="line">]</span><br><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">&#x27;django.middleware.security.SecurityMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions.middleware.SessionMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;corsheaders.middleware.CorsMiddleware&#x27;</span>, <span class="comment"># 加入中间键 位置必须在这里 不能在其他位置</span></span><br><span class="line">    <span class="string">&#x27;django.middleware.common.CommonMiddleware&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;django.middleware.csrf.CsrfViewMiddleware&#x27;, 如果你的项目没有考虑到 csrf 网络攻击,可注释掉,否则会报错没有传递 csrf cookie</span></span><br><span class="line">    <span class="string">&#x27;django.contrib.auth.middleware.AuthenticationMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages.middleware.MessageMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.middleware.clickjacking.XFrameOptionsMiddleware&#x27;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 setting.py 末尾添加以下设置</span></span><br><span class="line">CORS_ALLOW_CREDENTIALS = <span class="literal">True</span></span><br><span class="line">CORS_ALLOW_ALL_ORIGINS = <span class="literal">True</span></span><br><span class="line">CORS_ALLOW_HEADERS = (<span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Django </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JPA总结</title>
      <link href="/2025/06/09/JPA%E6%80%BB%E7%BB%93/"/>
      <url>/2025/06/09/JPA%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="JPA总结"><a href="#JPA总结" class="headerlink" title="JPA总结"></a>JPA总结</h1><h2 id="1-JPA简介"><a href="#1-JPA简介" class="headerlink" title="1. JPA简介"></a>1. JPA简介</h2><p>JPA（Java Persistence API）是Java官方提出的ORM（对象关系映射）规范，主要用于简化Java应用中的数据持久化开发。常见实现有Hibernate、EclipseLink等。Spring Data JPA对JPA进行了进一步封装，极大简化了数据库操作。</p><h2 id="2-配置示例"><a href="#2-配置示例" class="headerlink" title="2. 配置示例"></a>2. 配置示例</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/testdb?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">admin123</span></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">database-platform:</span> <span class="string">org.hibernate.dialect.MySQL8Dialect</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">update</span></span><br><span class="line">      <span class="attr">naming:</span></span><br><span class="line">        <span class="attr">physical-strategy:</span> <span class="string">org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl</span></span><br><span class="line">    <span class="attr">show-sql:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(basePackages = &#123;&quot;com.dao&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EntityScan(basePackages = &quot;com.entity&quot;)</span> <span class="comment">// 指定实体类所在包</span></span><br><span class="line"><span class="meta">@EnableJpaRepositories(basePackages = &quot;com.dao&quot;)</span> <span class="comment">// 指定仓库接口所在包</span></span><br><span class="line"><span class="meta">@EnableJpaAuditing</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootSchemaApplication</span> <span class="keyword">extends</span> <span class="title class_">SpringBootServletInitializer</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpringbootSchemaApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> SpringApplicationBuilder <span class="title function_">configure</span><span class="params">(SpringApplicationBuilder applicationBuilder)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> applicationBuilder.sources(SpringbootSchemaApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-常用JPA注解说明"><a href="#3-常用JPA注解说明" class="headerlink" title="3. 常用JPA注解说明"></a>3. 常用JPA注解说明</h2><ul><li><code>@Entity</code>：标记为实体类</li><li><code>@Table</code>：指定表名</li><li><code>@Id</code>：主键</li><li><code>@GeneratedValue</code>：主键生成策略</li><li><code>@Column</code>：字段映射</li><li><code>@Lob</code>&#x2F;<code>@Basic</code>：大字段及懒加载</li><li><code>@CreatedDate</code>&#x2F;<code>@LastModifiedDate</code>：自动填充创建&#x2F;更新时间</li><li><code>@EntityListeners</code>：监听实体变化</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.annotation.CreatedDate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.annotation.LastModifiedDate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.domain.support.AuditingEntityListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author reisen7</span></span><br><span class="line"><span class="comment"> * Date 2025/4/22 12:30</span></span><br><span class="line"><span class="comment"> * Description</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@DynamicUpdate</span></span><br><span class="line"><span class="meta">@Table(name = &quot;user_evaluation&quot;)</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@EntityListeners(value = AuditingEntityListener.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserEvaluation</span> <span class="keyword">extends</span> <span class="title class_">Profile</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Lob</span></span><br><span class="line">    <span class="meta">@Basic(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;evaluation&quot; , columnDefinition = &quot;text&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String evaluation;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;user_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CreatedDate</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;create_time&quot;, nullable = false, updatable = false)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LastModifiedDate</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;update_time&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-Repository接口与常用方法"><a href="#4-Repository接口与常用方法" class="headerlink" title="4. Repository接口与常用方法"></a>4. Repository接口与常用方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.entity.UserEvaluation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserEvaluationRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;UserEvaluation, Long&gt; &#123;</span><br><span class="line">    <span class="comment">// 按用户ID查询</span></span><br><span class="line">    List&lt;UserEvaluation&gt; <span class="title function_">getUserEvaluationByUserId</span><span class="params">(Long userId)</span>;</span><br><span class="line">    <span class="comment">// 还可以自定义更多方法，如：</span></span><br><span class="line">    <span class="comment">// List&lt;UserEvaluation&gt; findByEvaluationContaining(String keyword);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>save(entity)</code> 保存或更新</li><li><code>findById(id)</code> 按ID查找</li><li><code>findAll()</code> 查询全部</li><li><code>deleteById(id)</code> 按ID删除</li><li><code>count()</code> 统计数量</li></ul><h2 id="5-分组与复杂查询"><a href="#5-分组与复杂查询" class="headerlink" title="5. 分组与复杂查询"></a>5. 分组与复杂查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;GoodsPlatformPrice&gt; <span class="title function_">getPriceByGoodsId</span><span class="params">(Long goodsId)</span> &#123;</span><br><span class="line">    Specification&lt;GoodsPlatformPrice&gt; specification = (root, query, criteriaBuilder) -&gt; &#123;</span><br><span class="line">        <span class="comment">// 1. 构建查询：选择平台名称和最低价格</span></span><br><span class="line">        query.multiselect(</span><br><span class="line">            root.get(<span class="string">&quot;platformName&quot;</span>),</span><br><span class="line">            criteriaBuilder.min(root.get(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// 2. 添加商品ID条件</span></span><br><span class="line">        <span class="type">Predicate</span> <span class="variable">goodsPredicate</span> <span class="operator">=</span> criteriaBuilder.equal(root.get(<span class="string">&quot;goodsId&quot;</span>), goodsId);</span><br><span class="line">        <span class="comment">// 3. 添加分组条件</span></span><br><span class="line">        query.groupBy(root.get(<span class="string">&quot;platformName&quot;</span>));</span><br><span class="line">        <span class="comment">// 4. 添加排序条件（可选）</span></span><br><span class="line">        query.orderBy(criteriaBuilder.asc(root.get(<span class="string">&quot;platformName&quot;</span>)));</span><br><span class="line">        <span class="keyword">return</span> goodsPredicate;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> repository.findAll(specification);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>说明：上述代码通过JPA的Specification实现分组、聚合、排序等复杂查询，适用于动态条件场景。</p><h2 id="6-常见问题与优化建议"><a href="#6-常见问题与优化建议" class="headerlink" title="6. 常见问题与优化建议"></a>6. 常见问题与优化建议</h2><ul><li><strong>实体类必须有无参构造方法</strong>，否则JPA无法实例化。</li><li><strong>@EntityScan&#x2F;@EnableJpaRepositories</strong> 路径要配置正确，否则扫描不到实体或仓库接口。</li><li><strong>懒加载异常</strong>：建议在Service层处理数据，避免在Controller层直接访问懒加载属性。</li><li><strong>批量操作优化</strong>：可用<code>@Modifying</code>和<code>@Query</code>自定义SQL实现批量更新&#x2F;删除。</li><li><strong>分页查询</strong>：可用<code>Pageable</code>参数，返回<code>Page&lt;T&gt;</code>类型。</li></ul><h2 id="7-参考资料"><a href="#7-参考资料" class="headerlink" title="7. 参考资料"></a>7. 参考资料</h2><ul><li><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/">Spring Data JPA 官方文档</a></li><li><a href="https://docs.jboss.org/hibernate/orm/current/userguide/html_single/Hibernate_User_Guide.html">Hibernate 官方文档</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用electron打包静态页面</title>
      <link href="/2024/12/28/%E4%BD%BF%E7%94%A8electron%E6%89%93%E5%8C%85%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/12/28/%E4%BD%BF%E7%94%A8electron%E6%89%93%E5%8C%85%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<ol><li><p>先到静态页面包外面安装<code>electron-packager</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">npm install electron</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>再安装<code>electron-packager</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-packager</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>到静态页面文件夹里面创建<code>main.js</code> 文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;app,<span class="title class_">BrowserWindow</span>&#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>); <span class="comment">//引入electron</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> win;</span><br><span class="line"><span class="keyword">let</span> windowConfig = &#123;</span><br><span class="line">        <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="number">600</span></span><br><span class="line">&#125;; <span class="comment">//窗口配置程序运行窗口的大小</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">   win = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(windowConfig); <span class="comment">//创建一个窗口</span></span><br><span class="line">   win.<span class="title function_">loadURL</span>(<span class="string">`file://<span class="subst">$&#123;__dirname&#125;</span>/index.html`</span>); <span class="comment">//在窗口内要展示的内容index.html 就是打包生成的index.html</span></span><br><span class="line"> <span class="comment">//win.webContents.openDevTools(); //开启调试工具</span></span><br><span class="line">   win.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//回收BrowserWindow对象</span></span><br><span class="line">   win = <span class="literal">null</span>;</span><br><span class="line">   &#125;);</span><br><span class="line">   win.<span class="title function_">on</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   win.<span class="title function_">reload</span>();</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;ready&#x27;</span>, createWindow);</span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;window-all-closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">app.<span class="title function_">quit</span>();</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;activate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (win == <span class="literal">null</span>) &#123;</span><br><span class="line"> <span class="title function_">createWindow</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">   </span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>在静态文件夹里面创建文件<code>package.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;productName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;reisen&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;a electron demo&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;pack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder --dir&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;dist&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;postinstall&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder install-app-deps&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;electronVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11.5.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;win&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;requestedExecutionLevel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;highestAvailable&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">       <span class="punctuation">&#123;</span></span><br><span class="line">         <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nsis&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;arch&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">           <span class="string">&quot;x64&quot;</span></span><br><span class="line">         <span class="punctuation">]</span></span><br><span class="line">       <span class="punctuation">&#125;</span></span><br><span class="line">     <span class="punctuation">]</span></span><br><span class="line">   <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;appId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;artifactName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo-version−&#123;arch&#125;.$&#123;ext&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;nsis&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;artifactName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo-version−&#123;arch&#125;.$&#123;ext&#125;&quot;</span></span><br><span class="line">   <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;extraResources&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">     <span class="punctuation">&#123;</span></span><br><span class="line">       <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;to&quot;</span><span class="punctuation">:</span> <span class="string">&quot;app-server&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;filter&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">         <span class="string">&quot;**/*&quot;</span></span><br><span class="line">       <span class="punctuation">]</span></span><br><span class="line">     <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;publish&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">     <span class="punctuation">&#123;</span></span><br><span class="line">       <span class="attr">&quot;provider&quot;</span><span class="punctuation">:</span> <span class="string">&quot;generic&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;reisen&quot;</span></span><br><span class="line">     <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;electron&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^31.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;electron-builder&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^24.13.3&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;core-js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.4.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;electron-packager&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^12.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;electron-updater&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;fs-extra&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;install.js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;moment&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.18.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;moment-es6&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.0.0&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>然后在静态文件夹外面的<code>package.json</code>里修改如下script</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line"> <span class="string">&quot;serve&quot;</span>: <span class="string">&quot;vue-cli-service serve&quot;</span>,</span><br><span class="line"> <span class="string">&quot;build&quot;</span>: <span class="string">&quot;vue-cli-service build&quot;</span>,</span><br><span class="line"> <span class="string">&quot;test&quot;</span>: <span class="string">&quot;vue-cli-service build --mode test&quot;</span>,</span><br><span class="line"> <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;vue-cli-service lint&quot;</span>,</span><br><span class="line"> <span class="string">&quot;electron_dev&quot;</span>: <span class="string">&quot;npm run build &amp;&amp; electron main.js&quot;</span>,</span><br><span class="line"> <span class="string">&quot;electron_build&quot;</span>: <span class="string">&quot;electron-packager ./dist demo --platform=win32 --arch=x64 --overwrite&quot;</span>,</span><br><span class="line">  </span><br><span class="line"> <span class="string">&quot;dist&quot;</span>: <span class="string">&quot;electron-packager ./dist name --platform=win32 --arch=ia32 --overwrite&quot;</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>最后执行这个<code>electron_build</code>就能完成打包了，打完包能看到一个demo.exe启动就ok了</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/12/28/hello-world/"/>
      <url>/2024/12/28/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>layui 使用cron可视化组件</title>
      <link href="/2024/12/18/layui%20%E4%BD%BF%E7%94%A8cron%E5%8F%AF%E8%A7%86%E5%8C%96%E7%BB%84%E4%BB%B6/"/>
      <url>/2024/12/18/layui%20%E4%BD%BF%E7%94%A8cron%E5%8F%AF%E8%A7%86%E5%8C%96%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>layui版本一定是最新版</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">layui</span><br><span class="line">  .<span class="title function_">config</span>(&#123;</span><br><span class="line">    <span class="attr">base</span>: <span class="string">&quot;../static/layui_exts/&quot;</span>, <span class="comment">// 扩展组件跟路径</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">cron</span>: <span class="string">&quot;cron/cron&quot;</span> <span class="comment">// 扩展组件</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">use</span>([<span class="string">&quot;cron&quot;</span>], <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> $ = layui.<span class="property">$</span>,</span><br><span class="line">      cron = layui.<span class="property">cron</span>;</span><br><span class="line">    cron.<span class="title function_">render</span>(&#123;</span><br><span class="line">      <span class="attr">elem</span>: <span class="string">&quot;#cron&quot;</span>, <span class="comment">// 绑定元素</span></span><br><span class="line">      <span class="attr">run</span>: <span class="string">&quot;../static/json/run.json&quot;</span>, <span class="comment">// 获取最近运行时间的接口</span></span><br><span class="line">      <span class="attr">done</span>: <span class="keyword">function</span>(<span class="params">cronStr</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(cronStr);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>页面上使用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;layui-input&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cron&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0/20 * * * * ?&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Layui </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEA快速部署到docker中</title>
      <link href="/2024/12/17/IDEA%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E5%88%B0docker%E4%B8%AD/"/>
      <url>/2024/12/17/IDEA%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E5%88%B0docker%E4%B8%AD/</url>
      
        <content type="html"><![CDATA[<h3 id="服务器上部署docker"><a href="#服务器上部署docker" class="headerlink" title="服务器上部署docker"></a>服务器上部署docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># step 1: 安装必要的一些系统工具</span></span><br><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="comment"># Step 2: 添加软件源信息</span></span><br><span class="line">sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="comment"># Step 3</span></span><br><span class="line">sudo sed -i <span class="string">&#x27;s+download.docker.com+mirrors.aliyun.com/docker-ce+&#x27;</span> /etc/yum.repos.d/docker-ce.repo</span><br><span class="line"><span class="comment"># Step 4: 更新并安装Docker-CE</span></span><br><span class="line">sudo yum makecache fast</span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"><span class="comment"># Step 4: 开启Docker服务</span></span><br><span class="line">sudo service docker start</span><br><span class="line"><span class="comment"># 开机自启动</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><h3 id="docker镜像"><a href="#docker镜像" class="headerlink" title="docker镜像"></a>docker镜像</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;https://docker.hpcloud.cloud&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://docker.m.daocloud.io&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://docker.unsee.tech&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://docker.1panel.live&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://mirrors.ustc.edu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://docker.chenby.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;http://mirror.azure.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://dockerpull.org&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://dockerhub.icu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;https://hub.rat.dev&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="开启Docker的远程连接"><a href="#开启Docker的远程连接" class="headerlink" title="开启Docker的远程连接"></a>开启Docker的远程连接</h3><ul><li>先status看docker在哪</li><li><img src="/img/posts/c7b72b6fdbf820137cf55943aa19e944.png"></li><li>把该文件里面的参数修改</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock</span><br></pre></td></tr></table></figure><ul><li>重启</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload </span><br><span class="line">systemctl restart docker.service</span><br></pre></td></tr></table></figure><h3 id="IDEA下载docker插件，配置docker服务器"><a href="#IDEA下载docker插件，配置docker服务器" class="headerlink" title="IDEA下载docker插件，配置docker服务器"></a>IDEA下载docker插件，配置docker服务器</h3><p><img src="/img/posts/bd22d8c2237ac0cf0f61556f489042b2.png"></p><p>根据dockerfile文件能直接部署到容器中了</p><hr><p>如果build出现<code>Failed to deploy &#39;exam Dockerfile: Dockerfile&#39;: Not connected to docker</code>则需要用管理员打开IDEA</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python将print输出重定向到tkinter页面</title>
      <link href="/2024/12/17/Python%E5%B0%86print%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0tkinter%E9%A1%B5%E9%9D%A2/"/>
      <url>/2024/12/17/Python%E5%B0%86print%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0tkinter%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> Text, END</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StdoutRedirector</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, text_widget: Text</span>):</span><br><span class="line">        self.text_widget = text_widget</span><br><span class="line">        self.last_line_start = <span class="number">0</span>  <span class="comment"># 跟踪最后一行的起始位置</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">self, output: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="keyword">if</span> output.startswith(<span class="string">&#x27;/r&#x27;</span>):</span><br><span class="line">            <span class="comment"># 去除前缀 &#x27;/r&#x27;</span></span><br><span class="line">            output = output[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 删除最后一行内容</span></span><br><span class="line">            <span class="keyword">if</span> self.last_line_start != <span class="number">0</span>:</span><br><span class="line">                self.text_widget.delete(<span class="string">f&quot;<span class="subst">&#123;self.last_line_start&#125;</span>.0&quot;</span>, END)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 插入新内容</span></span><br><span class="line">            self.text_widget.insert(END, output)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 更新最后一行的起始位置</span></span><br><span class="line">            self.last_line_start = <span class="built_in">int</span>(self.text_widget.index(<span class="string">&#x27;end-1c&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 正常写入</span></span><br><span class="line">            self.text_widget.insert(END, output)</span><br><span class="line">            <span class="keyword">if</span> output.endswith(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">                self.last_line_start = <span class="built_in">int</span>(self.text_widget.index(<span class="string">&#x27;end-1c&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]) + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.last_line_start = <span class="built_in">int</span>(self.text_widget.index(<span class="string">&#x27;end-1c&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 滚动到文本组件的末尾</span></span><br><span class="line">        self.text_widget.see(END)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">flush</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        刷新缓冲区，确保所有数据被立即写出。</span></span><br><span class="line"><span class="string">        对于Tkinter的Text组件来说，这通常意味着确保所有已写入的内容立即显示给用户。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 在Tkinter的Text组件中，实际上并没有真正的“刷新”概念，</span></span><br><span class="line">        <span class="comment"># 因为写入操作是立即可见的。但为了保持接口一致性，我们仍然提供这个方法。</span></span><br><span class="line">        <span class="comment"># 如果需要，这里可以添加代码来强制更新GUI。</span></span><br><span class="line">        self.text_widget.update_idletasks()  <span class="comment"># 强制刷新GUI，确保所有挂起的任务都被处理</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例用法</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line"></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    text = tk.Text(root, wrap=<span class="string">&#x27;word&#x27;</span>)  <span class="comment"># 设置wrap为&#x27;word&#x27;以防止单词被分割</span></span><br><span class="line">    text.pack(fill=tk.BOTH, expand=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 重定向stdout到text widget</span></span><br><span class="line">    sys.stdout = StdoutRedirector(text)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 测试</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这是第一行&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;/r这是替换后的第一行&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这是第二行&quot;</span>)</span><br><span class="line"></span><br><span class="line">    root.mainloop()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YUM安装docker-compose</title>
      <link href="/2024/12/17/YUM%E5%AE%89%E8%A3%85docker-compose/"/>
      <url>/2024/12/17/YUM%E5%AE%89%E8%A3%85docker-compose/</url>
      
        <content type="html"><![CDATA[<h2 id="Docker-Compose简介"><a href="#Docker-Compose简介" class="headerlink" title="Docker Compose简介"></a>Docker Compose简介</h2><p>Docker Compose是一个用于定义和运行多容器Docker应用程序的工具。通过Compose，您可以使用YAML文件来配置应用程序的服务，然后使用一个命令创建并启动所有服务。它极大地简化了容器编排工作，特别适合开发、测试和CI工作流程。</p><h2 id="安装前提"><a href="#安装前提" class="headerlink" title="安装前提"></a>安装前提</h2><p>在安装Docker Compose之前，请确保您的系统已经安装了Docker。您可以通过以下命令检查Docker是否已安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker --version</span><br></pre></td></tr></table></figure><p>如果未安装Docker，请先安装Docker：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><h2 id="使用YUM安装Docker-Compose"><a href="#使用YUM安装Docker-Compose" class="headerlink" title="使用YUM安装Docker Compose"></a>使用YUM安装Docker Compose</h2><h3 id="1-添加EPEL源"><a href="#1-添加EPEL源" class="headerlink" title="1. 添加EPEL源"></a>1. 添加EPEL源</h3><p>EPEL (Extra Packages for Enterprise Linux) 是为企业级Linux提供额外软件包的仓库，它包含了许多在标准仓库中不可用的软件包，包括docker-compose。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y epel-release</span><br></pre></td></tr></table></figure><h3 id="2-安装Docker-Compose"><a href="#2-安装Docker-Compose" class="headerlink" title="2. 安装Docker Compose"></a>2. 安装Docker Compose</h3><p>安装完EPEL源后，可以直接使用yum命令安装docker-compose：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker-compose</span><br></pre></td></tr></table></figure><h3 id="3-验证安装"><a href="#3-验证安装" class="headerlink" title="3. 验证安装"></a>3. 验证安装</h3><p>安装完成后，可以通过查看版本号来验证docker-compose是否安装成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure><p>如果安装成功，将显示类似以下的输出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose version 1.29.2, build unknown</span><br></pre></td></tr></table></figure><h2 id="使用Docker-Compose"><a href="#使用Docker-Compose" class="headerlink" title="使用Docker Compose"></a>使用Docker Compose</h2><h3 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h3><ol><li><p><strong>创建并启动容器</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li><li><p><strong>停止并移除容器</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down</span><br></pre></td></tr></table></figure></li><li><p><strong>查看运行中的服务</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure></li><li><p><strong>查看服务日志</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose logs</span><br></pre></td></tr></table></figure></li></ol><h3 id="示例docker-compose-yml文件"><a href="#示例docker-compose-yml文件" class="headerlink" title="示例docker-compose.yml文件"></a>示例docker-compose.yml文件</h3><p>以下是一个简单的docker-compose.yml示例，用于部署WordPress和MySQL：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db_data:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">rootpassword</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">wordpress:</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">wordpress:latest</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:80&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_HOST:</span> <span class="string">db:3306</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_NAME:</span> <span class="string">wordpress</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">db_data:</span></span><br></pre></td></tr></table></figure><h2 id="故障排除"><a href="#故障排除" class="headerlink" title="故障排除"></a>故障排除</h2><ol><li><p><strong>如果安装失败</strong>，可能是因为EPEL源未正确配置，尝试更新源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure></li><li><p><strong>如果版本过低</strong>，可以考虑使用官方安装脚本安装最新版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></li><li><p><strong>权限问题</strong>：确保当前用户在docker组中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -aG docker $(<span class="built_in">whoami</span>)</span><br></pre></td></tr></table></figure></li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>使用YUM安装Docker Compose是在CentOS&#x2F;RHEL系统上快速部署Docker Compose的简便方法。通过EPEL源，您可以轻松获取和安装Docker Compose，从而简化多容器应用程序的管理。</p><p>Docker Compose极大地简化了开发和部署流程，使得定义、运行和扩展多容器应用变得更加容易。无论是开发环境还是生产环境，Docker Compose都是容器编排的有力工具。</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>富文本及formatter的使用</title>
      <link href="/2024/12/17/%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8F%8Aformatter%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/12/17/%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8F%8Aformatter%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>先看效果图：该饼图统计总共的数据，其中每块饼图旁边显示了3条相应的详细数据</p><p><img src="/img/posts/885888ffc5b8d7fbccc880f14d88f398.png"></p><h3 id="其中后端提供的数据结构如下"><a href="#其中后端提供的数据结构如下" class="headerlink" title="其中后端提供的数据结构如下"></a>其中后端提供的数据结构如下</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;code&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;randomSelectedList&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;北京大学-悉尼大学食物安全和农业可持续发展联合中心揭牌仪式暨学术研讨会举行&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;“沉浸式传播视域下传统文化+虚拟现实的创新路径”研讨会在北京大学举行&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;美国气象学会理事长访问北京大学&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;巴基斯坦前总理阿巴西访问北京大学&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;张辛：小雪&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;“异彩同风，共鸣未名”——北京大学第二十一届国际文化节举行&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;电子学院张志勇教授团队在碳基高灵敏红外探测领域取得进展&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;校领导率队赴云南弥渡推进定点帮扶工作&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;“国别和区域研究视域下的库尔德问题”研讨会暨《伊拉克库尔德问题研究（1958—2003）》新书发布会举行&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;北京大学召开党纪学习教育动员暨2024年深化全面从严治党工作会议&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a2&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;北京大学格致论坛（第23讲）暗物质粒子寻找的科学之旅&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a2&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;田晖：我们的目光，正跃出太阳系&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a2&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;“国别和区域研究视域下的库尔德问题”研讨会暨《伊拉克库尔德问题研究（1958—2003）》新书发布会举行&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a3&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;“国别和区域研究视域下的库尔德问题”研讨会暨《伊拉克库尔德问题研究（1958—2003）》新书发布会举行&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a3&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;校领导率队赴云南弥渡推进定点帮扶工作&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;a3&quot;</span>,</span><br><span class="line">      <span class="string">&quot;newsName&quot;</span>: <span class="string">&quot;弘工匠精神，展后勤风采——北京大学首届后勤系统职工职业技能大赛举行&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="对data数据进行如下的处理"><a href="#对data数据进行如下的处理" class="headerlink" title="对data数据进行如下的处理"></a>对data数据进行如下的处理</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res = data.<span class="property">list</span>;</span><br><span class="line"><span class="keyword">let</span> randomSelectedList = data.<span class="property">randomSelectedList</span></span><br><span class="line"><span class="keyword">let</span> yAxis = [];</span><br><span class="line"><span class="keyword">let</span> xAxis = [];</span><br><span class="line"><span class="keyword">var</span> option = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> paraData = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; res.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  yAxis.<span class="title function_">push</span>(res[i].<span class="property">userCollection</span>);</span><br><span class="line">  xAxis.<span class="title function_">push</span>(res[i].<span class="property">username</span>);</span><br><span class="line">  <span class="keyword">let</span> details = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; randomSelectedList.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (res[i].<span class="property">username</span> == randomSelectedList[j].<span class="property">username</span>) &#123;</span><br><span class="line">      details.<span class="title function_">push</span>(randomSelectedList[j].<span class="property">newsName</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  paraData.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: res[i].<span class="property">username</span>,</span><br><span class="line">    <span class="attr">value</span>: res[i].<span class="property">userCollection</span>,</span><br><span class="line">    <span class="attr">details</span>: details</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="对应的option"><a href="#对应的option" class="headerlink" title="对应的option"></a>对应的option</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">  <span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;收藏统计&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">tooltip</span>: &#123;</span><br><span class="line">    <span class="attr">trigger</span>: <span class="string">&#x27;item&#x27;</span>,</span><br><span class="line">    <span class="attr">formatter</span>: <span class="string">&#x27;&#123;a&#125; &lt;br/&gt;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;收藏数&#x27;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;pie&#x27;</span>,</span><br><span class="line">      <span class="attr">radius</span>: <span class="string">&#x27;65%&#x27;</span>,</span><br><span class="line">      <span class="attr">center</span>: [<span class="string">&#x27;50%&#x27;</span>, <span class="string">&#x27;50%&#x27;</span>],</span><br><span class="line">      <span class="attr">selectedMode</span>: <span class="string">&#x27;single&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: paraData,</span><br><span class="line">      <span class="attr">emphasis</span>: &#123;</span><br><span class="line">        <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">          <span class="attr">shadowBlur</span>: <span class="number">10</span>,</span><br><span class="line">          <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">shadowColor</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.5)&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">label</span>: &#123;</span><br><span class="line">        <span class="attr">formatter</span>: <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">          <span class="keyword">let</span> data = params.<span class="property">data</span></span><br><span class="line">          <span class="keyword">var</span> arr = </span><br><span class="line">            <span class="string">&#x27;&#123;title|用户名：&#x27;</span>+ data.<span class="property">name</span> +<span class="string">&#x27;&#125;&#123;abg|&#125;\n&#x27;</span>+</span><br><span class="line">            <span class="string">&#x27;&#123;weatherHead|收藏的新闻&#125;\n&#x27;</span>+</span><br><span class="line">            <span class="string">&#x27;&#123;hr|&#125;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">var</span> length = data.<span class="property">details</span>.<span class="property">length</span></span><br><span class="line">          <span class="keyword">var</span> detail = data.<span class="property">details</span></span><br><span class="line">          <span class="keyword">if</span>(length &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            length = <span class="number">3</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i =<span class="number">0</span> ;i&lt;length;i++)&#123;</span><br><span class="line">            arr = arr +<span class="string">&#x27; &#123;value|&#x27;</span>+ detail[i] +<span class="string">&#x27;&#125;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br><span class="line">          <span class="keyword">return</span> arr;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// formatter: [</span></span><br><span class="line">        <span class="comment">//   &#x27;&#123;title|&#123;b&#125;&#125;&#123;abg|&#125;&#x27;,</span></span><br><span class="line">        <span class="comment">//   &#x27;  &#123;weatherHead|收藏的新闻&#125;&#x27;,</span></span><br><span class="line">        <span class="comment">//   &#x27;&#123;hr|&#125;&#x27;,</span></span><br><span class="line">        <span class="comment">//   &#x27;  &#123;value|&#125;&#x27;,</span></span><br><span class="line">        <span class="comment">//   &#x27;  &#123;value|142&#125;&#x27;,</span></span><br><span class="line">        <span class="comment">//   &#x27;  &#123;value|21&#125;&#x27;</span></span><br><span class="line">        <span class="comment">// ].join(&#x27;\n&#x27;),</span></span><br><span class="line">        <span class="attr">backgroundColor</span>: <span class="string">&#x27;#eee&#x27;</span>,</span><br><span class="line">        <span class="attr">borderColor</span>: <span class="string">&#x27;#777&#x27;</span>,</span><br><span class="line">        <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">borderRadius</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">rich</span>: &#123;</span><br><span class="line">          <span class="attr">title</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#eee&#x27;</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">abg</span>: &#123;</span><br><span class="line">            <span class="attr">backgroundColor</span>: <span class="string">&#x27;#333&#x27;</span>,</span><br><span class="line">            <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line">            <span class="attr">height</span>: <span class="number">25</span>,</span><br><span class="line">            <span class="attr">borderRadius</span>: [<span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="title class_">Sunny</span>: &#123;</span><br><span class="line">            <span class="attr">height</span>: <span class="number">30</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">            <span class="attr">backgroundColor</span>: &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="title class_">Cloudy</span>: &#123;</span><br><span class="line">            <span class="attr">height</span>: <span class="number">30</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">            <span class="attr">backgroundColor</span>: &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="title class_">Showers</span>: &#123;</span><br><span class="line">            <span class="attr">height</span>: <span class="number">30</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">            <span class="attr">backgroundColor</span>: &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">weatherHead</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span>,</span><br><span class="line">            <span class="attr">height</span>: <span class="number">24</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">hr</span>: &#123;</span><br><span class="line">            <span class="attr">borderColor</span>: <span class="string">&#x27;#777&#x27;</span>,</span><br><span class="line">            <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">            <span class="attr">borderWidth</span>: <span class="number">0.5</span>,</span><br><span class="line">                        <span class="attr">height</span>: <span class="number">0</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">value</span>: &#123;</span><br><span class="line">                        <span class="attr">width</span>: <span class="number">40</span>,</span><br><span class="line">                        <span class="attr">padding</span>: [<span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">30</span>],</span><br><span class="line">                        <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">valueHead</span>: &#123;</span><br><span class="line">                        <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span>,</span><br><span class="line">                        <span class="attr">width</span>: <span class="number">20</span>,</span><br><span class="line">                        <span class="attr">padding</span>: [<span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">30</span>],</span><br><span class="line">                        <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">rate</span>: &#123;</span><br><span class="line">                        <span class="attr">width</span>: <span class="number">40</span>,</span><br><span class="line">                        <span class="attr">align</span>: <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line">                        <span class="attr">padding</span>: [<span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">rateHead</span>: &#123;</span><br><span class="line">                        <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span>,</span><br><span class="line">                        <span class="attr">width</span>: <span class="number">40</span>,</span><br><span class="line">                        <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">                        <span class="attr">padding</span>: [<span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><strong>定义富文本样式</strong>：<ul><li>在<code>label.rich</code>中，定义了多个样式名称（如<code>title</code>, <code>abg</code>, <code>weatherHead</code>, <code>hr</code>, <code>value</code>等），并为每个样式指定了属性（如颜色、对齐方式、背景颜色、宽度、高度、边框颜色、边框宽度、内边距等）。</li><li>这些样式名称可以在<code>formatter</code>函数中被引用，以应用特定的样式到文本的某一部分。</li></ul></li><li><strong>使用富文本样式</strong>：<ul><li>在<code>formatter</code>函数中，通过模板字符串（使用反引号<code>`</code>）和占位符（如<code>&#123;title|用户名：...&#125;</code>）来构建标签的文本内容。</li><li>每个占位符中的第一个部分（如<code>title</code>）是<code>rich</code>中定义的样式名称，后面的部分（如<code>用户名：...</code>）是要显示的文本。</li><li>这种方式允许在标签的不同部分应用不同的样式。</li></ul></li><li><strong>动态内容</strong>：<ul><li><code>formatter</code>函数可以根据数据（<code>params.data</code>）动态生成标签内容。</li><li>在这个例子中，它用于显示用户的收藏统计，包括用户名、收藏的新闻标题，以及（如果可用的话）前三条新闻标题。</li></ul></li><li><strong>特殊样式</strong>：<ul><li><code>abg</code>样式被用作一个特殊的背景块，可能用于分隔文本或提供视觉上的层次感。</li><li><code>hr</code>样式模拟了一个水平分隔线，通过指定宽度、边框颜色、边框宽度和高度来实现。</li></ul></li><li><strong>未使用的样式</strong>：<ul><li>在<code>rich</code>中定义了一些样式（如<code>Sunny</code>, <code>Cloudy</code>, <code>Showers</code>），但在<code>formatter</code>函数中并未使用。这些可能是为了其他目的而预留的，或者是在示例中被省略了。</li></ul></li><li><strong>调试</strong>：<ul><li><code>console.log(arr)</code>语句用于在控制台输出构建的标签文本，这有助于调试和验证<code>formatter</code>函数的输出。</li></ul></li></ol><p>综上所述，富文本的使用在ECharts中提供了一种灵活的方式来定制图表标签的样式和内容，使其能够更直观地展示数据和提供用户友好的界面。</p><blockquote><p>echarts官网来源： <a href="https://echarts.apache.org/examples/zh/editor.html?c=pie-rich-text">https://echarts.apache.org/examples/zh/editor.html?c=pie-rich-text</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Echarts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>通用dockerfile文件</title>
      <link href="/2024/12/17/%E9%80%9A%E7%94%A8dockerfile%E6%96%87%E4%BB%B6/"/>
      <url>/2024/12/17/%E9%80%9A%E7%94%A8dockerfile%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h3 id="先写项目的启动脚本，命名为run-sh"><a href="#先写项目的启动脚本，命名为run-sh" class="headerlink" title="先写项目的启动脚本，命名为run.sh"></a>先写项目的启动脚本，命名为<code>run.sh</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$JAVA_OPTS</span> ];<span class="keyword">then</span></span><br><span class="line">    JAVA_OPTS=<span class="string">&quot;-Xms256m -Xmx512m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$JAR_PATH</span> ];<span class="keyword">then</span></span><br><span class="line">    JAR_PATH=<span class="string">&quot;/opt/server&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$EXAM_ENV</span> ];<span class="keyword">then</span></span><br><span class="line">    EXAM_ENV=<span class="string">&quot;prod&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ x<span class="variable">$LOG</span> != <span class="string">&quot;xfalse&quot;</span> ];<span class="keyword">then</span></span><br><span class="line">    <span class="built_in">mkdir</span> -p logs</span><br><span class="line">    LOGGING_OPT=<span class="string">&quot;--logging.path=./logs&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$JAVA_OPTS</span> -Dlogging.path=./logs -DSpring.profiles.active=<span class="variable">$EXAM_ENV</span> -jar <span class="variable">$&#123;JAR_PATH&#125;</span>/*.jar</span><br><span class="line"></span><br><span class="line">java <span class="variable">$JAVA_OPTS</span> -Dlogging.path=./logs -DSpring.profiles.active=<span class="variable">$EXAM_ENV</span> -jar <span class="variable">$&#123;JAR_PATH&#125;</span>/*.jar</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="dockerfile文件打包镜像"><a href="#dockerfile文件打包镜像" class="headerlink" title="dockerfile文件打包镜像"></a><code>dockerfile</code>文件打包镜像</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /opt/server/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> target/<span class="variable">$&#123;&#x27;项目名称&#x27;&#125;</span>-SNAPSHOT.jar /opt/server</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> run.sh /opt/server/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> src/main/resources/static /server</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8888</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /opt/server</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;/opt/server/run.sh&quot;</span>]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="docker-compose-yml文件，依赖的镜像为MySQL以及redis"><a href="#docker-compose-yml文件，依赖的镜像为MySQL以及redis" class="headerlink" title="docker-compose.yml文件，依赖的镜像为MySQL以及redis"></a><code>docker-compose.yml</code>文件，依赖的镜像为MySQL以及redis</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2.1&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">exam:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">exam_server</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">exam:1.0</span> </span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8888</span><span class="string">:8888</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_HOST=mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_PORT=3306</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_NAME=exam_system</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_USER=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_PASSWORD=123456</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REDIS_PASSWORD=123456</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">exam_mysql</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3306</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=123456</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/exam/volume_data/mysql/data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/exam/volume_data/mysql/conf:/etc/mysql/conf.d</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/exam/init_sql:/docker-entrypoint-initdb.d</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">exam_redis</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:6</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">/etc/redis/redis.conf</span> <span class="string">--requirepass</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6379</span><span class="string">:6379</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/exam/volume_data/redis/data:/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/exam/volume_data/redis/redis.conf:/etc/redis/redis.conf</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其中需要把初始化数据库脚本放在<code>/opt/server/init_sql</code>目录下面</p><p>redis的配置文件放在<code>/opt/server/volume_data/redis</code>下面</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密yml文件</title>
      <link href="/2024/06/16/%E5%8A%A0%E5%AF%86yml%E6%96%87%E4%BB%B6/"/>
      <url>/2024/06/16/%E5%8A%A0%E5%AF%86yml%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h3 id="1-低版本2-x"><a href="#1-低版本2-x" class="headerlink" title="1. 低版本2.x"></a>1. 低版本2.x</h3><h4 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.ulisesbocchio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>手动引入依赖（内网环境）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jasypt<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.ulisesbocchio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt-spring-boot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="生成密码"><a href="#生成密码" class="headerlink" title="生成密码"></a>生成密码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PasswordEncrypt</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">// write your code here</span></span><br><span class="line">    <span class="type">StandardPBEStringEncryptor</span> <span class="variable">standardPBEStringEncryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StandardPBEStringEncryptor</span>();</span><br><span class="line">    <span class="type">EnvironmentPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnvironmentPBEConfig</span>();</span><br><span class="line"></span><br><span class="line">    config.setAlgorithm(<span class="string">&quot;PBEWithMD5AndDES&quot;</span>);          <span class="comment">// 加密的算法，这个算法是默认的</span></span><br><span class="line">    config.setPassword(<span class="string">&quot;sigtuna&quot;</span>);                        <span class="comment">// 加密的密钥，随便自己填写，很重要千万不要告诉别人</span></span><br><span class="line">    standardPBEStringEncryptor.setConfig(config);</span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://xxx.xxx.xxx.xxx:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=FALSE&amp;serverTimezone=UTC&amp;useOldAliasMetadataBehavior=true&quot;</span>;         <span class="comment">//自己的密码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">root</span> <span class="operator">=</span> <span class="string">&quot;test&quot;</span>;         <span class="comment">//自己的密码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="string">&quot;test&quot;</span>;         <span class="comment">//自己的密码</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;url &quot;</span>+ standardPBEStringEncryptor.encrypt(url));</span><br><span class="line">    System.out.println(<span class="string">&quot;root &quot;</span>+ standardPBEStringEncryptor.encrypt(root));</span><br><span class="line">    System.out.println(<span class="string">&quot;pwd &quot;</span>+ standardPBEStringEncryptor.encrypt(pwd));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">decrypt</span><span class="params">(String url, String username, String pwd)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">StandardPBEStringEncryptor</span> <span class="variable">standardPBEStringEncryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StandardPBEStringEncryptor</span>();</span><br><span class="line">    <span class="type">EnvironmentPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnvironmentPBEConfig</span>();</span><br><span class="line"> </span><br><span class="line">    config.setAlgorithm(<span class="string">&quot;PBEWithMD5AndDES&quot;</span>);</span><br><span class="line">    config.setPassword(<span class="string">&quot;sigtuna&quot;</span>);</span><br><span class="line">    standardPBEStringEncryptor.setConfig(config);</span><br><span class="line">    <span class="type">String</span> <span class="variable">plainTextUrl</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(url);</span><br><span class="line">    <span class="type">String</span> <span class="variable">plainTextUser</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(username);</span><br><span class="line">    <span class="type">String</span> <span class="variable">plainTextPwd</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(pwd);</span><br><span class="line">    System.out.println(<span class="string">&quot;url: &quot;</span>+plainTextUrl);</span><br><span class="line">    System.out.println(<span class="string">&quot;username: &quot;</span>+plainTextUser);</span><br><span class="line">    System.out.println(<span class="string">&quot;password: &quot;</span>+plainTextPwd);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="自动获取yml文件里的数据库配置"><a href="#自动获取yml文件里的数据库配置" class="headerlink" title="自动获取yml文件里的数据库配置"></a>自动获取yml文件里的数据库配置</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PasswordDecrypt</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line"><span class="comment">//        decrypt(&quot;秘钥&quot;,</span></span><br><span class="line"><span class="comment">//                &quot;秘钥&quot;,</span></span><br><span class="line"><span class="comment">//                &quot;秘钥&quot;);</span></span><br><span class="line">        EaseDecrypt();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">Encrypt</span><span class="params">(String url,String username,String pwd)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">StandardPBEStringEncryptor</span> <span class="variable">standardPBEStringEncryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StandardPBEStringEncryptor</span>();</span><br><span class="line">        <span class="type">EnvironmentPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnvironmentPBEConfig</span>();</span><br><span class="line"></span><br><span class="line">        config.setAlgorithm(<span class="string">&quot;PBEWithMD5AndDES&quot;</span>);          <span class="comment">// 加密的算法，这个算法是默认的</span></span><br><span class="line">        config.setPassword(<span class="string">&quot;sigtuna&quot;</span>);                        <span class="comment">// 加密的密钥，随便自己填写，很重要千万不要告诉别人</span></span><br><span class="line">        standardPBEStringEncryptor.setConfig(config);</span><br><span class="line">        <span class="comment">// String url = &quot;jdbc:mysql://xxx.xxxx.xxx.xxx:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT&amp;autoReconnect=true&amp;useSSL=false&quot;;         //自己的密码</span></span><br><span class="line">        <span class="comment">// String root = &quot;test&quot;;         //自己的密码</span></span><br><span class="line">        <span class="comment">// String pwd = &quot;test&quot;;         //自己的密码</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;url &quot;</span>+ standardPBEStringEncryptor.encrypt(url));</span><br><span class="line">        System.out.println(<span class="string">&quot;root &quot;</span>+ standardPBEStringEncryptor.encrypt(username));</span><br><span class="line">        System.out.println(<span class="string">&quot;pwd &quot;</span>+ standardPBEStringEncryptor.encrypt(pwd));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">decrypt</span><span class="params">(String url, String username, String pwd)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">StandardPBEStringEncryptor</span> <span class="variable">standardPBEStringEncryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StandardPBEStringEncryptor</span>();</span><br><span class="line">        <span class="type">EnvironmentPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnvironmentPBEConfig</span>();</span><br><span class="line"> </span><br><span class="line">        config.setAlgorithm(<span class="string">&quot;PBEWithMD5AndDES&quot;</span>);</span><br><span class="line">        config.setPassword(<span class="string">&quot;sigtuna&quot;</span>);</span><br><span class="line">        standardPBEStringEncryptor.setConfig(config);</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainTextUrl</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(url);</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainTextUser</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(username);</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainTextPwd</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(pwd);</span><br><span class="line">        System.out.println(<span class="string">&quot;url: &quot;</span>+plainTextUrl);</span><br><span class="line">        System.out.println(<span class="string">&quot;username: &quot;</span>+plainTextUser);</span><br><span class="line">        System.out.println(<span class="string">&quot;password: &quot;</span>+plainTextPwd);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">EaseDecrypt</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// System.out.println(&quot;输入解密的配置文件地址&quot;);</span></span><br><span class="line">        <span class="comment">// Scanner scanner = new Scanner(System.in);</span></span><br><span class="line">        <span class="comment">// String filePath = scanner.nextLine();</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">io</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;x:\\xxx\\application-dev.yml&quot;</span>);</span><br><span class="line">        Yaml yaml=<span class="keyword">new</span> <span class="title class_">Yaml</span>();</span><br><span class="line">        Map&lt;String, Object&gt; map =yaml.load(io);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="comment">//        System.out.println(map);</span></span><br><span class="line"><span class="comment">//        System.out.println(map.get(&quot;spring&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获得url</span></span><br><span class="line">        <span class="keyword">if</span> (map.get(<span class="string">&quot;spring&quot;</span>) != <span class="literal">null</span> &amp;&amp; !map.get(<span class="string">&quot;spring&quot;</span>).equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            Map&lt;String,Object&gt; mapd = (Map&lt;String, Object&gt;) map.get(<span class="string">&quot;spring&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (mapd.get(<span class="string">&quot;datasource&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                Map&lt;String,Object&gt; mapdata = (Map&lt;String, Object&gt;) mapd.get(<span class="string">&quot;datasource&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (mapdata.get(<span class="string">&quot;druid&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                    Map&lt;String,Object&gt; mapdata1 = (Map&lt;String, Object&gt;) mapdata.get(<span class="string">&quot;druid&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (mapdata1.get(<span class="string">&quot;master&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                        Map&lt;String,Object&gt; mapdata2 = (Map&lt;String, Object&gt;) mapdata1.get(<span class="string">&quot;master&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (mapdata2.get(<span class="string">&quot;url&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                            url = (String) mapdata2.get(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">                            username = (String) mapdata2.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">                            pwd = (String) mapdata2.get(<span class="string">&quot;password&quot;</span>);;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获得加密密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">algorithm</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">suffix</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (map.get(<span class="string">&quot;jasypt&quot;</span>) != <span class="literal">null</span> &amp;&amp; !map.get(<span class="string">&quot;jasypt&quot;</span>).equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            Map&lt;String,Object&gt; mapd = (Map&lt;String, Object&gt;) map.get(<span class="string">&quot;jasypt&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (mapd.get(<span class="string">&quot;encryptor&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                Map&lt;String,Object&gt; mapdata = (Map&lt;String, Object&gt;) mapd.get(<span class="string">&quot;encryptor&quot;</span>);</span><br><span class="line">                algorithm = (String) mapdata.get(<span class="string">&quot;algorithm&quot;</span>);</span><br><span class="line">                password = (String) mapdata.get(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(mapdata.get(<span class="string">&quot;property&quot;</span>)!= <span class="literal">null</span>)&#123;</span><br><span class="line">                    Map&lt;String,Object&gt; mapdata1 = (Map&lt;String, Object&gt;) mapdata.get(<span class="string">&quot;property&quot;</span>);</span><br><span class="line">                    prefix = (String) mapdata1.get(<span class="string">&quot;prefix&quot;</span>);</span><br><span class="line">                    suffix = (String) mapdata1.get(<span class="string">&quot;suffix&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">StandardPBEStringEncryptor</span> <span class="variable">standardPBEStringEncryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StandardPBEStringEncryptor</span>();</span><br><span class="line">        <span class="comment">// 去除前缀</span></span><br><span class="line">        url = removePro(url,prefix,suffix);</span><br><span class="line">        username = removePro(username,prefix,suffix);</span><br><span class="line">        pwd = removePro(pwd,prefix,suffix);</span><br><span class="line"></span><br><span class="line">        <span class="type">EnvironmentPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnvironmentPBEConfig</span>();</span><br><span class="line"> </span><br><span class="line">        config.setAlgorithm(algorithm);</span><br><span class="line">        config.setPassword(password);</span><br><span class="line">        standardPBEStringEncryptor.setConfig(config);</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainTextUrl</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(url);</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainTextUser</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(username);</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainTextPwd</span> <span class="operator">=</span> standardPBEStringEncryptor.decrypt(pwd);</span><br><span class="line">        System.out.println(<span class="string">&quot;url: &quot;</span>+plainTextUrl);</span><br><span class="line">        System.out.println(<span class="string">&quot;username: &quot;</span>+plainTextUser);</span><br><span class="line">        System.out.println(<span class="string">&quot;password: &quot;</span>+plainTextPwd);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">removePro</span><span class="params">(String oString,String prefix,String suffix)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> oString;</span><br><span class="line">        <span class="keyword">if</span> (prefix!=<span class="literal">null</span>) &#123;</span><br><span class="line">            str = oString.substring(prefix.length(), oString.length());</span><br><span class="line">            oString = str;</span><br><span class="line">            <span class="keyword">if</span> (suffix!=<span class="literal">null</span>) &#123;</span><br><span class="line">                str = oString.substring(<span class="number">0</span>, oString.length()-suffix.length());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getMapKey</span><span class="params">(String key , Map&lt;String,Object&gt; map)</span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        Map&lt;String,Object&gt; keyMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (key != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (map.get(key) != <span class="literal">null</span>) &#123;</span><br><span class="line">                keyMap = (Map&lt;String, Object&gt;) map.get(key);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            keyMap = map;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(String x : keyMap.keySet())&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h4 id="yml配置"><a href="#yml配置" class="headerlink" title="yml配置"></a>yml配置</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jasypt:</span></span><br><span class="line">  <span class="attr">encryptor:</span></span><br><span class="line">    <span class="attr">algorithm:</span> <span class="string">PBEWithMD5AndDES</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">sigtuna</span></span><br><span class="line">    <span class="attr">property:</span></span><br><span class="line">      <span class="attr">prefix:</span> <span class="string">reisen</span></span><br><span class="line">      <span class="attr">suffix:</span></span><br></pre></td></tr></table></figure><p>数据库的配置用reisen包裹就可以了，这块可以自定义，默认的ENC</p><h3 id="2-高版本3-x"><a href="#2-高版本3-x" class="headerlink" title="2.高版本3.x"></a>2.高版本3.x</h3><h4 id="引入依赖包"><a href="#引入依赖包" class="headerlink" title="引入依赖包"></a>引入依赖包</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.ulisesbocchio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>内网情况如下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.jasypt/jasypt --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jasypt<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.ulisesbocchio/jasypt-spring-boot --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.ulisesbocchio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt-spring-boot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="生成秘钥"><a href="#生成秘钥" class="headerlink" title="生成秘钥"></a>生成秘钥</h4><p>下面是一个工具类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.jasypt.encryption.pbe.PooledPBEStringEncryptor;</span><br><span class="line"><span class="keyword">import</span> org.jasypt.encryption.pbe.config.SimpleStringPBEConfig;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JasypUtil</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PBEWITHHMACSHA512ANDAES_256</span> <span class="operator">=</span> <span class="string">&quot;PBEWITHHMACSHA512ANDAES_256&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: Jasyp 加密（PBEWITHHMACSHA512ANDAES_256）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:      Rambo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@CreateDate</span>:  2020/7/25 14:34</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateUser</span>:  Rambo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateDate</span>:  2020/7/25 14:34</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> plainText  待加密的原文</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> factor     加密秘钥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       java.lang.String</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Version</span>:     1.0.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encryptWithSHA512</span><span class="params">(String plainText, String factor)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. 创建加解密工具实例</span></span><br><span class="line">        <span class="type">PooledPBEStringEncryptor</span> <span class="variable">encryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PooledPBEStringEncryptor</span>();</span><br><span class="line">        <span class="comment">// 2. 加解密配置</span></span><br><span class="line">        <span class="type">SimpleStringPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleStringPBEConfig</span>();</span><br><span class="line">        config.setPassword(factor);</span><br><span class="line">        config.setAlgorithm(PBEWITHHMACSHA512ANDAES_256);</span><br><span class="line">        <span class="comment">// 为减少配置文件的书写，以下都是 Jasyp 3.x 版本，配置文件默认配置</span></span><br><span class="line">        config.setKeyObtentionIterations( <span class="string">&quot;1000&quot;</span>);</span><br><span class="line">        config.setPoolSize(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        config.setProviderName(<span class="string">&quot;SunJCE&quot;</span>);</span><br><span class="line">        config.setSaltGeneratorClassName(<span class="string">&quot;org.jasypt.salt.RandomSaltGenerator&quot;</span>);</span><br><span class="line">        config.setIvGeneratorClassName(<span class="string">&quot;org.jasypt.iv.RandomIvGenerator&quot;</span>);</span><br><span class="line">        config.setStringOutputType(<span class="string">&quot;base64&quot;</span>);</span><br><span class="line">        encryptor.setConfig(config);</span><br><span class="line">        <span class="comment">// 3. 加密</span></span><br><span class="line">        <span class="keyword">return</span> encryptor.encrypt(plainText);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: Jaspy解密（PBEWITHHMACSHA512ANDAES_256）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:      Rambo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@CreateDate</span>:  2020/7/25 14:40</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateUser</span>:  Rambo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateDate</span>:  2020/7/25 14:40</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptedText  待解密密文</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> factor         解密秘钥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       java.lang.String</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Version</span>:     1.0.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">decryptWithSHA512</span><span class="params">(String encryptedText, String factor)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. 创建加解密工具实例</span></span><br><span class="line">        <span class="type">PooledPBEStringEncryptor</span> <span class="variable">encryptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PooledPBEStringEncryptor</span>();</span><br><span class="line">        <span class="comment">// 2. 加解密配置</span></span><br><span class="line">        <span class="type">SimpleStringPBEConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleStringPBEConfig</span>();</span><br><span class="line">        config.setPassword(factor);</span><br><span class="line">        config.setAlgorithm(PBEWITHHMACSHA512ANDAES_256);</span><br><span class="line">        <span class="comment">// 为减少配置文件的书写，以下都是 Jasyp 3.x 版本，配置文件默认配置</span></span><br><span class="line">        config.setKeyObtentionIterations( <span class="string">&quot;1000&quot;</span>);</span><br><span class="line">        config.setPoolSize(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        config.setProviderName(<span class="string">&quot;SunJCE&quot;</span>);</span><br><span class="line">        config.setSaltGeneratorClassName(<span class="string">&quot;org.jasypt.salt.RandomSaltGenerator&quot;</span>);</span><br><span class="line">        config.setIvGeneratorClassName(<span class="string">&quot;org.jasypt.iv.RandomIvGenerator&quot;</span>);</span><br><span class="line">        config.setStringOutputType(<span class="string">&quot;base64&quot;</span>);</span><br><span class="line">        encryptor.setConfig(config);</span><br><span class="line">        <span class="comment">// 3. 解密</span></span><br><span class="line">        <span class="keyword">return</span> encryptor.decrypt(encryptedText);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">factor</span> <span class="operator">=</span> <span class="string">&quot;Angel&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">plainText</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="type">String</span> <span class="variable">encryptWithSHA512Str</span> <span class="operator">=</span> encryptWithSHA512(plainText, factor);</span><br><span class="line">        <span class="type">String</span> <span class="variable">decryptWithSHA512Str</span> <span class="operator">=</span> decryptWithSHA512(encryptWithSHA512Str, factor);</span><br><span class="line">        System.out.println(<span class="string">&quot;采用AES256加密前原文密文：&quot;</span> + encryptWithSHA512Str);</span><br><span class="line">        System.out.println(<span class="string">&quot;采用AES256解密后密文原文:&quot;</span> + decryptWithSHA512Str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="yml的配置"><a href="#yml的配置" class="headerlink" title="yml的配置"></a>yml的配置</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"> <span class="attr">datasource:</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">ENC(8jLUdq0Fr7UhJGNwK/Nc6i6/WV4+UBpvtfBLDh4e3jZMJZAhPqfZdGlpFEUk24UZ)</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/test?useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC</span></span><br><span class="line">  <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">jasypt:</span></span><br><span class="line"> <span class="attr">encryptor:</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">Angel</span></span><br><span class="line">  <span class="attr">algorithm:</span> <span class="string">PBEWITHHMACSHA512ANDAES_256</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue2设置通知提醒框</title>
      <link href="/2024/06/12/Vue2%E8%AE%BE%E7%BD%AE%E9%80%9A%E7%9F%A5%E6%8F%90%E9%86%92%E6%A1%86/"/>
      <url>/2024/06/12/Vue2%E8%AE%BE%E7%BD%AE%E9%80%9A%E7%9F%A5%E6%8F%90%E9%86%92%E6%A1%86/</url>
      
        <content type="html"><![CDATA[<p>可自定义设置以下属性：</p><ul><li>自动关闭的延时时长（duration），单位ms，默认4500ms</li><li>消息从顶部弹出时，距离顶部的位置（top），单位px，默认24px</li><li>消息从底部弹出时，距离底部的位置（bottom），单位px，默认24px</li><li>消息弹出位置（placement），可选：左上topLeft，右上topRight（默认），左下bottomLeft，右下bottomRight</li></ul><p>调用时可选以下五个方法对应五种不同样式：</p><ul><li>this.$refs.notification.open(notification) &#x2F;&#x2F; 默认使用</li><li>this.$refs.notification.info(notification) &#x2F;&#x2F; info调用</li><li>this.$refs.notification.success(notification) &#x2F;&#x2F; success调用</li><li>this.$refs.notification.error(notification) &#x2F;&#x2F; error调用</li><li>this.$refs.notification.warn(notification) &#x2F;&#x2F; warn调用</li></ul><h3 id="创建通知框架组件命名为Notification"><a href="#创建通知框架组件命名为Notification" class="headerlink" title="创建通知框架组件命名为Notification"></a>创建通知框架组件命名为<code>Notification</code></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;m-notification-wrap&#x27;, placement]&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;`top: $&#123;placement.includes(&#x27;top&#x27;) ? top : &#x27;&#x27;&#125;px; bottom: $&#123;placement.includes(&#x27;bottom&#x27;) ? bottom : &#x27;&#x27;&#125;px;`&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">name</span>=<span class="string">&quot;slide-fade&quot;</span> <span class="attr">tag</span>=<span class="string">&quot;div&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;m-notification&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">mouseenter</span>=<span class="string">&quot;onEnter(index)&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">mouseleave</span>=<span class="string">&quot;onLeave(index)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-show</span>=<span class="string">&quot;!hideIndex.includes(index)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-for</span>=<span class="string">&quot;(data, index) in notificationData&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:key</span>=<span class="string">&quot;`n$&#123;index&#125;`&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;u-status-svg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;mode===&#x27;info&#x27;&quot;</span> <span class="attr">:fill</span>=<span class="string">&quot;colorStyle[mode]&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;64 64 896 896&quot;</span> <span class="attr">data-icon</span>=<span class="string">&quot;info-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">focusable</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M464 336a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;u-status-svg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;mode===&#x27;success&#x27;&quot;</span> <span class="attr">:fill</span>=<span class="string">&quot;colorStyle[mode]&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;64 64 896 896&quot;</span> <span class="attr">data-icon</span>=<span class="string">&quot;check-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">focusable</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0 0 51.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;u-status-svg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;mode===&#x27;warn&#x27;&quot;</span> <span class="attr">:fill</span>=<span class="string">&quot;colorStyle[mode]&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;64 64 896 896&quot;</span> <span class="attr">data-icon</span>=<span class="string">&quot;exclamation-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">focusable</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M464 688a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;u-status-svg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;mode===&#x27;error&#x27;&quot;</span> <span class="attr">:fill</span>=<span class="string">&quot;colorStyle[mode]&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;64 64 896 896&quot;</span> <span class="attr">data-icon</span>=<span class="string">&quot;close-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">focusable</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;u-title&#x27;, &#123;&#x27;mb4&#x27;: mode!==&#x27;open&#x27;, &#x27;ml48&#x27;: mode!==&#x27;open&#x27;&#125;]&quot;</span>&gt;</span>&#123;&#123; data.title || &#x27;--&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;u-description&#x27;, &#123;&#x27;ml48&#x27;: mode!==&#x27;open&#x27;&#125;]&quot;</span>&gt;</span>&#123;&#123; index + data.description || &#x27;--&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;u-close&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;onHideNotification(index)&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;64 64 896 896&quot;</span> <span class="attr">data-icon</span>=<span class="string">&quot;close&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">focusable</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;Notification&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">duration</span>: &#123; <span class="comment">// 自动关闭的延时时长,单位ms，默认4500ms；设置null时，不自动关闭</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="number">4500</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">top</span>: &#123; <span class="comment">// 消息从顶部弹出时，距离顶部的位置，单位像素px</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="number">24</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">bottom</span>: &#123; <span class="comment">// 消息从底部弹出时，距离底部的位置，单位像素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="number">24</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placement</span>: &#123; <span class="comment">// 消息弹出位置，可选topLeft,topRight,bottomLeft,bottomRight</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>: <span class="string">&#x27;topRight&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  data () &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">colorStyle</span>: &#123; <span class="comment">// 颜色主题对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">info</span>: <span class="string">&#x27;#1890FF&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">success</span>: <span class="string">&#x27;#52c41a&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">error</span>: <span class="string">&#x27;#f5222d&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">warn</span>: <span class="string">&#x27;#faad14&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">mode</span>: <span class="string">&#x27;info&#x27;</span>, <span class="comment">// 调用方法对应的样式主题</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">resetTimer</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hideIndex</span>: [],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hideTimers</span>: [],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">notificationData</span>: []</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    clear () &#123; <span class="comment">// 所有提示是否已经全部变为false</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">hideIndex</span>.<span class="property">length</span> === <span class="variable language_">this</span>.<span class="property">notificationData</span>.<span class="property">length</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    clear (to, <span class="keyword">from</span>) &#123; <span class="comment">// 所有提示都消失后重置</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!<span class="keyword">from</span> &amp;&amp; to) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">resetTimer</span> = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">hideIndex</span>.<span class="title function_">splice</span>(<span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">notificationData</span>.<span class="title function_">splice</span>(<span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    onEnter (index) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">hideTimers</span>[index])</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.$set(<span class="variable language_">this</span>.<span class="property">hideTimers</span>, index, <span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    onLeave (index) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">duration</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$set(<span class="variable language_">this</span>.<span class="property">hideTimers</span>, index, <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">onHideNotification</span>(index)</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="variable language_">this</span>.<span class="property">duration</span>))</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    show (notification) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">resetTimer</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">notificationData</span>.<span class="title function_">push</span>(notification)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">hideTimers</span>.<span class="title function_">push</span>(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> index = <span class="variable language_">this</span>.<span class="property">notificationData</span>.<span class="property">length</span> - <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">duration</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$set(<span class="variable language_">this</span>.<span class="property">hideTimers</span>, index, <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">onHideNotification</span>(index)</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="variable language_">this</span>.<span class="property">duration</span>))</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    open (notification) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">mode</span> = <span class="string">&#x27;open&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">show</span>(notification)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    info (notification) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">mode</span> = <span class="string">&#x27;info&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">show</span>(notification)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    success (notification) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">mode</span> = <span class="string">&#x27;success&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">show</span>(notification)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    error (notification) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">mode</span> = <span class="string">&#x27;error&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">show</span>(notification)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    warn (notification) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">mode</span> = <span class="string">&#x27;warn&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">show</span>(notification)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    onHideNotification (index) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">hideIndex</span>.<span class="title function_">push</span>(index)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;close&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">// 渐变过渡效果</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-enter-active</span>, <span class="selector-class">.fade-leave-active</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: opacity .<span class="number">3s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-enter</span>, <span class="selector-class">.fade-leave-to</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">// 滑动渐变过渡效果</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.slide-fade-enter-active</span>, <span class="selector-class">.slide-fade-leave-active</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: all .<span class="number">3s</span> ease;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.slide-fade-enter</span>, <span class="selector-class">.slide-fade-leave-to</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">408px</span>);</span></span><br><span class="line"><span class="language-css">  -ms-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">408px</span>); <span class="comment">/* IE 9 */</span></span></span><br><span class="line"><span class="language-css">  -webkit-<span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">408px</span>); <span class="comment">/* Safari and Chrome */</span></span></span><br><span class="line"><span class="language-css">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.topRight</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-right</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.topLeft</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-left</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bottomRight</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-right</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.bottomLeft</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-left</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.m-notification-wrap</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">999</span>; // 突出显示该层级</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">384px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">65</span>);</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.m-notification</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">16px</span> <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">15%</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: all .<span class="number">3s</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.u-status-svg</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-left</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.u-title</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding-right</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-bottom</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">85</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">line-height</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.u-description</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.mb4</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-bottom</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.ml48</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-left</span>: <span class="number">48px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.u-close</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">top</span>: <span class="number">21px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">right</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">      fill: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">45</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">transition</span>: fill .<span class="number">3s</span> ease;</span></span><br><span class="line"><span class="language-css">      &amp;<span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">        fill: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">75</span>);</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="在要使用的页面引入"><a href="#在要使用的页面引入" class="headerlink" title="在要使用的页面引入"></a>在要使用的页面引入</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Notification</span></span><br><span class="line">      ref=<span class="string">&quot;notification&quot;</span></span><br><span class="line">      placement=<span class="string">&quot;topRight&quot;</span></span><br><span class="line">      :duration=<span class="string">&quot;null&quot;</span></span><br><span class="line">      :top=<span class="string">&quot;30&quot;</span></span><br><span class="line">      @close=<span class="string">&quot;onClose&quot;</span> /&gt;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Notification</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/Notification&#x27;</span></span><br><span class="line"><span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">Notification</span></span><br><span class="line">&#125;</span><br><span class="line">onShowNotification () &#123;</span><br><span class="line">      <span class="keyword">const</span> notification = &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;Notification Title&#x27;</span>,</span><br><span class="line">        <span class="attr">description</span>: <span class="string">&#x27;This is the content of the notification. This is the content of the notification. This is the content of the notification.&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">notification</span>.<span class="title function_">open</span>(notification) <span class="comment">// 默认使用</span></span><br><span class="line">      <span class="comment">// this.$refs.notification.info(notification) // info调用</span></span><br><span class="line">      <span class="comment">// this.$refs.notification.success(notification) // success调用</span></span><br><span class="line">      <span class="comment">// this.$refs.notification.error(notification) // error调用</span></span><br><span class="line">      <span class="comment">// this.$refs.notification.warn(notification) // warning调用</span></span><br><span class="line">&#125;,</span><br><span class="line">onClose () &#123; <span class="comment">// 点击默认关闭按钮时触发的回调函数</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;关闭notification&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Layui实现放大图片的效果</title>
      <link href="/2024/06/03/Layui%E5%AE%9E%E7%8E%B0%E6%94%BE%E5%A4%A7%E5%9B%BE%E7%89%87%E7%9A%84%E6%95%88%E6%9E%9C/"/>
      <url>/2024/06/03/Layui%E5%AE%9E%E7%8E%B0%E6%94%BE%E5%A4%A7%E5%9B%BE%E7%89%87%E7%9A%84%E6%95%88%E6%9E%9C/</url>
      
        <content type="html"><![CDATA[<p>需要在表格里面添加查看图片的模板</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 400px;height: 200px&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;showLarge(&#x27;../images/lidong.jpg&#x27;)&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">height</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span>  <span class="attr">src</span>=<span class="string">&quot;../images/lidong.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>放大的function</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> &gt;</span><br><span class="line"><span class="comment">//查看大图</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">showLarge</span>(<span class="params">src</span>) &#123;</span><br><span class="line">        layer.<span class="title function_">photos</span>(&#123;</span><br><span class="line">            <span class="attr">photos</span>: &#123;</span><br><span class="line">                <span class="string">&quot;title&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="comment">//相册标题</span></span><br><span class="line">                <span class="string">&quot;id&quot;</span>: <span class="number">123</span>, <span class="comment">//相册id</span></span><br><span class="line">                <span class="string">&quot;start&quot;</span>: <span class="number">0</span>, <span class="comment">//初始显示的图片序号，默认0</span></span><br><span class="line">                <span class="string">&quot;data&quot;</span>: [   <span class="comment">//相册包含的图片，数组格式</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">&quot;alt&quot;</span>: <span class="string">&quot;图片名&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;pid&quot;</span>: <span class="number">666</span>, <span class="comment">//图片id</span></span><br><span class="line">                        <span class="string">&quot;src&quot;</span>: src, <span class="comment">//原图地址</span></span><br><span class="line">                        <span class="string">&quot;thumb&quot;</span>: <span class="string">&quot;&quot;</span> <span class="comment">//缩略图地址</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">&quot;alt&quot;</span>: <span class="string">&quot;图片名&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;pid&quot;</span>: <span class="number">555</span>, <span class="comment">//图片id</span></span><br><span class="line">                        <span class="string">&quot;src&quot;</span>: <span class="string">&#x27;../images/lidong.jpg&#x27;</span>, <span class="comment">//原图地址</span></span><br><span class="line">                        <span class="string">&quot;thumb&quot;</span>: <span class="string">&quot;&quot;</span> <span class="comment">//缩略图地址</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">            ,<span class="attr">anim</span>: <span class="number">0</span> <span class="comment">//0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Layui </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>镜像</title>
      <link href="/2024/05/08/%E9%95%9C%E5%83%8F/"/>
      <url>/2024/05/08/%E9%95%9C%E5%83%8F/</url>
      
        <content type="html"><![CDATA[<p>npm  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><p>nvm</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node_mirror: https://npmmirror.com/mirrors/node/</span><br><span class="line">npm_mirror: https://npmmirror.com/mirrors/npm/</span><br></pre></td></tr></table></figure><p>python</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install  -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</span><br></pre></td></tr></table></figure><p>kali</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">中科大 </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line"> </span><br><span class="line">阿里云 </span><br><span class="line">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line"> </span><br><span class="line">清华大学 </span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free </span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line"> </span><br><span class="line">说明：deb代表软件的位置，deb-src代表软件的源代码位置</span><br><span class="line"> </span><br><span class="line">配置kali apt为阿里源实例：</span><br><span class="line">配置思路方法 修改 /etc/apt/sources.list，加入以下内容将相关url改成阿里云的源。 </span><br><span class="line"> </span><br><span class="line">deb https://mirrors.aliyun.com/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src https://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 小笔记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue2使用g2</title>
      <link href="/2024/05/05/Vue2%E4%BD%BF%E7%94%A8g2/"/>
      <url>/2024/05/05/Vue2%E4%BD%BF%E7%94%A8g2/</url>
      
        <content type="html"><![CDATA[<h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h3><p><em>其实vue2和vue3用法差不多，使用的g2也是5.x的预防，其中的区别就是script块的写法不太一样，vue3更简洁更方便</em>  </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;chartRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">Chart</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@antv/g2&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;ChartComponent&#x27;</span>, <span class="comment">// 组件名称  </span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">chart</span>: <span class="literal">null</span>, <span class="comment">// 用于存储图表实例  </span></span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">initChart</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">initChart</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> chartRef = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">chartRef</span>; <span class="comment">// 使用 this.$refs 引用 DOM 元素  </span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> keys = <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">dataHeader</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(keys)</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">chart</span> = <span class="keyword">new</span> <span class="title class_">Chart</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">container</span>: chartRef,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">autoFit</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// ... 图表配置代码保持不变 ...  </span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//   chart.coordinate(&#123; type: &#x27;theta&#x27; &#125;);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">chart</span></span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">title</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">title</span>: <span class="string">`明年预测`</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// .interval()</span></span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">data</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="string">&#x27;fetch&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">value</span>: process.<span class="property">env</span>.<span class="property">VUE_APP_HADOOP_BASE_API</span> + <span class="string">&#x27;/hdfs/read-csv/yuce?path=/output/hdfsJobByYear/part-r-00000&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// process.env.VUE_APP_HADOOP_BASE_API 为所访问的后端地址</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">format</span>: <span class="string">&#x27;csv&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">autoType</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">transform</span>: [</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                        &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">type</span>: <span class="string">&#x27;map&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">callback</span>: <span class="function">(<span class="params">val</span>) =&gt;</span> &#123; val[<span class="string">&#x27;年&#x27;</span>] = val[<span class="string">&#x27;时间&#x27;</span>] + <span class="string">&#x27;年&#x27;</span>; <span class="keyword">return</span> val; &#125;,</span></span><br><span class="line"><span class="language-javascript">                        &#125;,</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// &#123;</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//   type: &#x27;custom&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//   callback: (data) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//     const result = keys.map(key =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//       const re = data.reduce((currentSum, item) =&gt;  currentSum + item[key] , 0)</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//       return data</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//     &#125;)</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//     return result</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// &#125;,</span></span></span><br><span class="line"><span class="language-javascript">                        &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">type</span>: <span class="string">&#x27;fold&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">fields</span>: <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">dataHeader</span>,</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">key</span>: <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartX</span>,</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">value</span>: <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartY</span>,</span></span><br><span class="line"><span class="language-javascript">                        &#125;,</span></span><br><span class="line"><span class="language-javascript">                        &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">type</span>: <span class="string">&#x27;sortBy&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">fields</span>: [<span class="string">&#x27;时间&#x27;</span>]</span></span><br><span class="line"><span class="language-javascript">                        &#125;,</span></span><br><span class="line"><span class="language-javascript">                        &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">type</span>: <span class="string">&#x27;log&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;,</span></span><br><span class="line"><span class="language-javascript">                    ],</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">encode</span>(<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;时间&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">encode</span>(<span class="string">&#x27;y&#x27;</span>, <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartY</span>)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">encode</span>(<span class="string">&#x27;color&#x27;</span>, <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartX</span>)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">scale</span>(<span class="string">&#x27;x&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">range</span>: [<span class="number">0</span>, <span class="number">1</span>],</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">scale</span>(<span class="string">&#x27;y&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">nice</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">axis</span>(<span class="string">&#x27;x&#x27;</span>, &#123; <span class="attr">title</span>: <span class="literal">null</span>, <span class="attr">line</span>: <span class="literal">true</span>, <span class="attr">tick</span>: <span class="literal">true</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">axis</span>(<span class="string">&#x27;y&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">title</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">line</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">chart</span>.<span class="title function_">line</span>().<span class="title function_">encode</span>(<span class="string">&#x27;shape&#x27;</span>, <span class="string">&#x27;smooth&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">chart</span>.<span class="title function_">render</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 如果需要从父组件传递 prop，可以这样定义  </span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-pseudo">:root</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-family</span>: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>-scheme: light dark;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.87</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#242424</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-synthesis</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">text-rendering</span>: optimizeLegibility;</span></span><br><span class="line"><span class="language-css">    -webkit-<span class="attribute">font-smoothing</span>: antialiased;</span></span><br><span class="line"><span class="language-css">    -moz-osx-<span class="attribute">font-smoothing</span>: grayscale;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#646cff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">text-decoration</span>: inherit;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#535bf2</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* display: flex; */</span></span></span><br><span class="line"><span class="language-css">    place-items: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">min-width</span>: <span class="number">320px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">h1</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">3.2em</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">1.1</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid transparent;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0.6em</span> <span class="number">1.2em</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">1em</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-family</span>: inherit;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#fffbfb</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: border-color <span class="number">0.25s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-color</span>: <span class="number">#646cff</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span><span class="selector-pseudo">:focus</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span><span class="selector-pseudo">:focus</span>-visible &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">outline</span>: <span class="number">4px</span> auto -webkit-focus-ring-color;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* .card &#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">  padding: 2em;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">&#125; */</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* #app &#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">  max-width: 1280px;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">  margin: 0 auto;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">  padding: 2rem;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">  text-align: center;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">&#125; */</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="keyword">@media</span> (<span class="attribute">prefers-color-scheme</span>: light) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="selector-pseudo">:root</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#213547</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#747bff</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> G2 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>跨域访问</title>
      <link href="/2024/05/03/%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE/"/>
      <url>/2024/05/03/%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>使用Vue对后台的资源进行访问，发生跨域的请求，会产生如下的报错</p><blockquote><p>Access to fetch at ‘<a href="http://localhost:8080/hdfs/read-csv?path=/output/hdfsJobByMonth/part-r-00000">http://localhost:8080/hdfs/read-csv?path=/output/hdfsJobByMonth/part-r-00000</a>‘ from origin ‘<a href="http://localhost:9528/">http://localhost:9528</a>‘ has been blocked by CORS policy: No ‘Access-Control-Allow-Origin’ header is present on the requested resource. If an opaque response serves your needs, set the request’s mode to ‘no-cors’ to fetch the resource with CORS disabled.</p></blockquote><p>这个错误表明前端应用（运行在 <a href="http://localhost:9528）试图通过">http://localhost:9528）试图通过</a> fetch API 访问后端服务（运行在 <a href="http://localhost:8080）的某个资源，但是由于跨域资源共享（CORS）策略的限制，这个请求被浏览器阻止了">http://localhost:8080）的某个资源，但是由于跨域资源共享（CORS）策略的限制，这个请求被浏览器阻止了</a>  </p><p>CORS 策略要求服务器在响应中包含一些特定的 HTTP 头信息，比如 <code>Access-Control-Allow-Origin</code>，来告诉浏览器哪些源（即哪些域、协议和端口）有权访问该资源。在这个例子中，服务器没有在响应中包含这个必要的头信息。</p><p>要解决这个问题，有几种解决办法：</p><ol><li><p><strong>配置后端服务以支持 CORS</strong>：<br>在后端服务（<code>http://localhost:8080</code>）上添加 CORS 支持。这通常意味着在响应中包含适当的 HTTP 头，如 <code>Access-Control-Allow-Origin: *</code>（允许所有源）或 <code>Access-Control-Allow-Origin: http://localhost:9528</code>（仅允许来自 <code>http://localhost:9528</code> 的请求）。但是请注意，将 <code>Access-Control-Allow-Origin</code> 设置为 <code>*</code> 可能会带来安全风险，特别是如果服务涉及敏感数据。</p></li><li><p><strong>使用代理服务器</strong>：<br>可以在前端应用中设置一个代理服务器，该服务器将请求转发到后端服务，并在转发响应时添加 CORS 头。这通常可以通过配置开发服务器（如 webpack-dev-server、Create React App 的开发服务器等）来实现。</p></li><li><p><strong>使用 <code>no-cors</code> 模式</strong>（不推荐）：<br>可以将 fetch 请求的模式设置为 <code>no-cors</code> 来绕过 CORS 策略，但这将导致响应变得不透明（opaque），前端无法读取响应的内容。因此，这通常不是一个好的解决方案，除非确实不需要读取响应的内容。</p></li><li><p><strong>在本地开发时禁用浏览器的 CORS 检查</strong>：<br>这可以通过在浏览器中使用插件或特殊模式来实现，但请注意，这只是一个临时的解决方案，并且不应该在生产环境中使用，因为它会暴露应用于安全风险。</p></li><li><p><strong>使用 JSONP</strong>（如果适用）：<br>如果后端服务支持 JSONP，并且只是想获取 JSON 数据，那么可以使用 JSONP 来绕过 CORS 策略。但是，JSONP 有一些限制，比如它只支持 GET 请求，并且只能返回 JSONP 格式的响应。</p></li></ol><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>使用第一种方式，在后端服务配置允许跨域访问<br>如下有几种方式：</p><h3 id="方法一：全局CORS配置"><a href="#方法一：全局CORS配置" class="headerlink" title="方法一：全局CORS配置"></a>方法一：全局CORS配置</h3><p>可以通过配置类中添加一个<code>WebMvcConfigurer</code> bean来全局配置CORS。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>) <span class="comment">// 允许所有路径</span></span><br><span class="line">                .allowedOrigins(<span class="string">&quot;http://localhost:9528&quot;</span>) <span class="comment">// 允许哪些源的请求</span></span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>) <span class="comment">// 允许哪些方法</span></span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>) <span class="comment">// 允许哪些请求头</span></span><br><span class="line">                .allowCredentials(<span class="literal">true</span>) <span class="comment">// 是否允许携带认证信息（cookies, HTTP认证及客户端SSL证明等）</span></span><br><span class="line">                .maxAge(<span class="number">3600</span>); <span class="comment">// 缓存CORS信息的时间（秒），默认是1800秒</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法二：使用-CrossOrigin注解"><a href="#方法二：使用-CrossOrigin注解" class="headerlink" title="方法二：使用@CrossOrigin注解"></a>方法二：使用<code>@CrossOrigin</code>注解</h3><p>也可以在Controller类或者特定的方法上使用<code>@CrossOrigin</code>注解来启用CORS。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.CrossOrigin;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin(origins = &quot;http://localhost:9528&quot;)</span> <span class="comment">// 允许哪些源的请求</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hdfs/read-csv&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readCsv</span><span class="params">(<span class="meta">@RequestParam</span> String path)</span> &#123;</span><br><span class="line">        <span class="comment">// ... 逻辑代码 ...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Data from CSV&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法三：自定义CORS过滤器"><a href="#方法三：自定义CORS过滤器" class="headerlink" title="方法三：自定义CORS过滤器"></a>方法三：自定义CORS过滤器</h3><p>需要更复杂的CORS配置，可以创建一个自定义的CORS过滤器。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.core.Ordered;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomCorsFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span>, Ordered &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) res;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) req;</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:9528&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;POST, GET, OPTIONS, DELETE&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Max-Age&quot;</span>, <span class="string">&quot;3600&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;x-requested-with&quot;</span>);</span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 设置过滤器顺序</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>当使用<code>allowedOrigins</code>时，如果只想允许来自特定域名的请求，就指定那个域名。如果想允许来自任何域名的请求（注意：这可能会带来安全风险），可以使用<code>&quot;*&quot;</code>。</li><li><code>allowCredentials(true)</code>允许跨域请求携带认证信息（如cookies），但这要求<code>Access-Control-Allow-Origin</code>不能是<code>&quot;*&quot;</code>，而必须是一个明确的域名。</li><li>如果前端应用需要处理预检请求（OPTIONS请求），确保后端配置也支持这些请求。预检请求是浏览器在发送实际请求之前发送的，以检查服务器是否允许跨域请求。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> G2 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>privateMap.get is not a function</title>
      <link href="/2024/05/01/privateMap%20get%20is%20not%20a%20function/"/>
      <url>/2024/05/01/privateMap%20get%20is%20not%20a%20function/</url>
      
        <content type="html"><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>在使用G2图表库进行数据可视化开发时，可能会遇到以下错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uncaught (in promise) TypeError: privateMap.get is not a function</span><br></pre></td></tr></table></figure><p>这个错误通常出现在G2图表渲染过程中，特别是在使用最新版本的G2（如G2 4.x）时。错误信息来自于<code>tslib.es6.js</code>文件的第233行，这是TypeScript运行时库的一部分，用于支持TypeScript编译后的JavaScript代码。</p><h2 id="错误原因分析"><a href="#错误原因分析" class="headerlink" title="错误原因分析"></a>错误原因分析</h2><p>这个错误主要是由于缺少<code>tslib</code>依赖引起的。G2图表库是基于TypeScript开发的，它在运行时依赖<code>tslib</code>提供的一些辅助函数，特别是与私有字段和方法相关的功能。</p><p>当项目中没有正确安装<code>tslib</code>或者版本不匹配时，就会出现<code>privateMap.get is not a function</code>这样的错误，这表明TypeScript的私有字段实现无法正常工作。</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>解决这个问题的方法非常简单，只需要在项目中安装<code>tslib</code>依赖：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用npm</span></span><br><span class="line">npm install --save tslib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者使用yarn</span></span><br><span class="line">yarn add tslib</span><br></pre></td></tr></table></figure><p>安装完成后，重新启动应用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure><p>这样就能解决<code>privateMap.get is not a function</code>的错误。</p><h2 id="更全面的排查步骤"><a href="#更全面的排查步骤" class="headerlink" title="更全面的排查步骤"></a>更全面的排查步骤</h2><p>如果安装<code>tslib</code>后问题仍然存在，可以尝试以下步骤：</p><ol><li><p><strong>检查G2和tslib的版本兼容性</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm list @antv/g2 tslib</span><br></pre></td></tr></table></figure></li><li><p><strong>清除缓存并重新安装依赖</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm cache clean --force</span><br><span class="line"><span class="built_in">rm</span> -rf node_modules</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></li><li><p><strong>确保没有多个版本的tslib</strong>：<br>有时候项目中可能存在多个版本的tslib，导致冲突。可以使用以下命令检查：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="built_in">ls</span> tslib</span><br></pre></td></tr></table></figure></li><li><p><strong>更新G2到最新版本</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm update @antv/g2</span><br></pre></td></tr></table></figure></li></ol><h2 id="相关资源"><a href="#相关资源" class="headerlink" title="相关资源"></a>相关资源</h2><ul><li><a href="https://github.com/descope/react-sdk/issues/301">GitHub Issue: TypeError: privateMap.get is not a function</a></li><li><a href="https://www.npmjs.com/package/tslib">tslib官方文档</a></li><li><a href="https://g2.antv.vision/zh">G2图表官方文档</a></li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><code>privateMap.get is not a function</code>错误通常是由于缺少<code>tslib</code>依赖导致的，这是G2图表库在处理TypeScript私有字段时的一个常见问题。通过安装<code>tslib</code>依赖，可以轻松解决这个问题，确保G2图表能够正常渲染。</p><p>在前端开发中，了解依赖关系和版本兼容性是解决此类问题的关键。当遇到类似错误时，首先检查相关依赖是否完整安装，版本是否兼容，这样可以节省大量的调试时间。</p>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> G2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Can&#39;t find dependent libraries</title>
      <link href="/2024/04/30/Can&#39;t%20find%20dependent%20libraries/"/>
      <url>/2024/04/30/Can&#39;t%20find%20dependent%20libraries/</url>
      
        <content type="html"><![CDATA[<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>在部署hadoop项目过程中，出现了这个报错<br><em>Exception in thread “main” java.lang.UnsatisfiedLinkError: E:\winutils-master\hadoop-3.3.5\bin\hadoop.dll: Can’t find dependent libraries</em><br>这个报错大概意思就是：dll缺所需的依赖  </p><h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>使用depends来查找所缺的依赖，该工具的下载地址：<a href="http://www.dependencywalker.com/">depends</a>  </p><p>使用的时候直接把dll文件拽进去等着搜索就行了<br> <img src="/img/posts/20240430.png" alt="alt"><br>如图可以看到缺了哪些依赖，直接上网搜索添加即可<br>只需要查看第一层即可</p><h3 id="depends查找很慢"><a href="#depends查找很慢" class="headerlink" title="depends查找很慢"></a>depends查找很慢</h3><ul><li><p>创建run_depends.txt文件</p></li><li><p>输入以下内容（两行）</p> <figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> <span class="built_in">PATH</span>=&quot;&quot;</span><br><span class="line">&quot;D:\Tools\depends\depends22_x64\depends.exe&quot;</span><br></pre></td></tr></table></figure><p><em>注意要讲上面的路径改成depends的路径</em></p></li><li><p>将run_depends.txt后缀名改为bat</p></li></ul><p>然后直接启动这个bat文件就可以了，这样查找很快速</p>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>炫酷的border样式</title>
      <link href="/2024/04/28/%E7%82%AB%E9%85%B7%E7%9A%84border%E6%A0%B7%E5%BC%8F/"/>
      <url>/2024/04/28/%E7%82%AB%E9%85%B7%E7%9A%84border%E6%A0%B7%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">info</span>=<span class="string">&quot;彩虹边框&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.item</span> <span class="selector-tag">div</span>&#123; </span><br><span class="line">    <span class="attr">--borderWidth</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attr">--bRadius</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60%</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2rem</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: --bRadius;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">::after</span>, &amp;<span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">left</span>: -<span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">top</span>: -<span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">200%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line">        <span class="attribute">z-index</span>: -<span class="number">2</span>;</span><br><span class="line">        <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">        <span class="attribute">background-size</span>: <span class="number">50%</span> <span class="number">50%</span>, <span class="number">50%</span> <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>, <span class="number">100%</span> <span class="number">0</span>, <span class="number">100%</span> <span class="number">100%</span>, <span class="number">0</span> <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">#399953</span>, <span class="number">#399953</span>), <span class="built_in">linear-gradient</span>(<span class="number">#fbb300</span>, <span class="number">#fbb300</span>), <span class="built_in">linear-gradient</span>(<span class="number">#d53e33</span>, <span class="number">#d53e33</span>), <span class="built_in">linear-gradient</span>(<span class="number">#377af5</span>, <span class="number">#377af5</span>);</span><br><span class="line">        <span class="attribute">animation</span>: rotate <span class="number">4s</span> linear infinite;</span><br><span class="line">        <span class="keyword">@keyframes</span> rotate &#123;</span><br><span class="line">            <span class="number">100%</span> &#123;</span><br><span class="line">                <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">1turn</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line"><span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--borderWidth) / <span class="number">2</span>);</span><br><span class="line"><span class="attribute">top</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--borderWidth) / <span class="number">2</span>);</span><br><span class="line"><span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="built_in">var</span>(--borderWidth));</span><br><span class="line"><span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="built_in">var</span>(--borderWidth));</span><br><span class="line"><span class="attribute">background</span>: white;</span><br><span class="line"><span class="attribute">border-radius</span>: --bRadius;</span><br><span class="line">        <span class="comment">/*  这一行是为了方便查看原来的样子的 */</span></span><br><span class="line"><span class="attribute">animation</span>: opacityChange <span class="number">3s</span> infinite alternate;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">@keyframes</span> opacityChange &#123;</span><br><span class="line">        <span class="number">50%</span> &#123;</span><br><span class="line">            <span class="attribute">opacity</span>:<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="number">100%</span> &#123;</span><br><span class="line">            <span class="attribute">opacity</span>: .<span class="number">5</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">info</span>=<span class="string">&quot;质感边框&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> opacityChange &#123;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>:.<span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> rotate &#123;</span><br><span class="line"><span class="number">100%</span> &#123;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">1turn</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="selector-tag">div</span>&#123; </span><br><span class="line">        <span class="attr">--borderWidth</span>: <span class="number">12px</span>;</span><br><span class="line">        <span class="attr">--bRadius</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">60%</span>;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">overflow</span>: hidden;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">2rem</span>;</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: --bRadius;</span><br><span class="line">        &amp;<span class="selector-pseudo">::after</span>, &amp;<span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">            <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">        &#125;</span><br><span class="line">        &amp;<span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">            <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="attribute">position</span>: absolute;</span><br><span class="line">            <span class="attribute">z-index</span>: -<span class="number">2</span>;</span><br><span class="line">            <span class="attribute">left</span>: -<span class="number">50%</span>;</span><br><span class="line">            <span class="attribute">top</span>: -<span class="number">50%</span>;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">200%</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line">            <span class="attribute">background-color</span>: <span class="number">#1a232a</span>;</span><br><span class="line">            <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">            <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">background-image</span>: <span class="built_in">conic-gradient</span>(transparent, <span class="built_in">rgba</span>(<span class="number">168</span>, <span class="number">239</span>, <span class="number">255</span>, <span class="number">1</span>), transparent <span class="number">30%</span>);</span><br><span class="line">            <span class="attribute">animation</span>: rotate <span class="number">4s</span> linear infinite;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">            <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="attribute">position</span>: absolute;</span><br><span class="line">            <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">            <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--borderWidth) / <span class="number">2</span>);</span><br><span class="line">            <span class="attribute">top</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--borderWidth) / <span class="number">2</span>);</span><br><span class="line">            <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="built_in">var</span>(--borderWidth));</span><br><span class="line">            <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="built_in">var</span>(--borderWidth));</span><br><span class="line">            <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">            <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">            <span class="comment">/* 这句效果打开有助于理解动画 */</span></span><br><span class="line">            <span class="comment">/*animation: opacityChange 5s infinite linear;*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">9</span>) <span class="selector-tag">div</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: opacityChange <span class="number">5s</span> infinite linear;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attr">--bRadius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="selector-tag">div</span>&#123;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">rgb</span>(<span class="number">179</span>, <span class="number">191</span>, <span class="number">231</span>);</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--bRadius);</span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">        &amp;<span class="selector-pseudo">::before</span>, &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">            <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="attribute">position</span>: absolute;</span><br><span class="line">            <span class="attribute">top</span>: -<span class="number">10px</span>;</span><br><span class="line">            <span class="attribute">left</span>: -<span class="number">10px</span>;</span><br><span class="line">            <span class="attribute">right</span>: -<span class="number">10px</span>;</span><br><span class="line">            <span class="attribute">bottom</span>: -<span class="number">10px</span>;</span><br><span class="line">            <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">rgb</span>(<span class="number">17</span>, <span class="number">36</span>, <span class="number">100</span>);</span><br><span class="line">            <span class="attribute">transition</span>: all .<span class="number">5s</span>;</span><br><span class="line">            <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--bRadius);</span><br><span class="line">            <span class="attribute">animation</span>: clippath <span class="number">3s</span> infinite linear;</span><br><span class="line">        &#125;</span><br><span class="line">        &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">            <span class="attribute">animation</span>: clippath <span class="number">3s</span> infinite -<span class="number">1.5s</span> linear;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">@keyframes</span> clippath &#123;</span><br><span class="line">            <span class="number">0%</span>, <span class="number">100%</span> &#123; <span class="attribute">clip-path</span>: <span class="built_in">inset</span>(<span class="number">0</span> <span class="number">0</span> <span class="number">98%</span> <span class="number">0</span>); &#125;</span><br><span class="line">            <span class="number">25%</span> &#123; <span class="attribute">clip-path</span>: <span class="built_in">inset</span>(<span class="number">0</span> <span class="number">98%</span> <span class="number">0</span> <span class="number">0</span>); &#125;</span><br><span class="line">            <span class="number">50%</span> &#123; <span class="attribute">clip-path</span>: <span class="built_in">inset</span>(<span class="number">98%</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>); &#125;</span><br><span class="line">            <span class="number">75%</span> &#123; <span class="attribute">clip-path</span>: <span class="built_in">inset</span>(<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">98%</span>); &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自用-yml配置文件</title>
      <link href="/2024/04/28/%EF%BC%88%E8%87%AA%E7%94%A8%EF%BC%89yml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
      <url>/2024/04/28/%EF%BC%88%E8%87%AA%E7%94%A8%EF%BC%89yml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server :</span></span><br><span class="line">  <span class="attr">port :</span> <span class="number">8080</span></span><br><span class="line">  <span class="comment">##项目名字配置</span></span><br><span class="line">  <span class="comment">#servlet :</span></span><br><span class="line">  <span class="comment">#  context-path : /demo</span></span><br><span class="line">  <span class="attr">tomcat :</span></span><br><span class="line">    <span class="attr">uri-encoding :</span> <span class="string">UTF-8</span></span><br><span class="line">    <span class="comment">#xx 报错修改的地方</span></span><br><span class="line">    <span class="attr">max-connections:</span> <span class="number">200000</span></span><br><span class="line">    <span class="attr">max-http-form-post-size:</span> <span class="number">9000000</span></span><br><span class="line">    <span class="attr">threads:</span></span><br><span class="line">      <span class="attr">max:</span> <span class="number">128</span></span><br><span class="line">      <span class="attr">min-spare:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">spring :</span></span><br><span class="line">  <span class="comment"># 环境 dev|test|prod</span></span><br><span class="line">  <span class="attr">profiles :</span></span><br><span class="line">    <span class="attr">active :</span> <span class="string">dev</span></span><br><span class="line">    <span class="comment">#引入其他配置文件，例如ftpHX 未配置文件application-ftpHX.yml</span></span><br><span class="line">    <span class="comment">#include: ftpHX,ftpCloud</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="comment">#设置总上传的数据大小</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">100MB</span></span><br><span class="line">      <span class="comment">#单个文件大小</span></span><br><span class="line">      <span class="attr">maxFileSize :</span> <span class="string">30MB</span></span><br><span class="line">        <span class="comment">#xx 报错修改的地方</span></span><br><span class="line">    <span class="attr">max-connections:</span> <span class="number">200000</span></span><br><span class="line">    <span class="attr">max-http-post-size:</span> <span class="number">9000000</span></span><br><span class="line">  <span class="comment">#热部署模块</span></span><br><span class="line">  <span class="attr">devtools:</span></span><br><span class="line">    <span class="attr">restart:</span></span><br><span class="line">      <span class="comment">#热部署开关</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment">#指定热部署的目录</span></span><br><span class="line">      <span class="attr">additional-paths:</span> <span class="string">src/main/java</span></span><br><span class="line">      <span class="comment">#指定目录不更新</span></span><br><span class="line">      <span class="attr">exclude:</span> <span class="string">test/**</span></span><br><span class="line">  <span class="attr">mvc:</span>   <span class="comment">#静态文件</span></span><br><span class="line">    <span class="attr">static-path-pattern :</span> <span class="string">/static/**</span></span><br><span class="line">    <span class="attr">pathmatch:</span></span><br><span class="line">      <span class="attr">matching-strategy:</span> <span class="string">ant_path_matcher</span></span><br><span class="line">  <span class="comment">#模板引擎</span></span><br><span class="line">  <span class="attr">thymeleaf:</span></span><br><span class="line">    <span class="attr">model:</span> <span class="string">HTML5</span></span><br><span class="line">    <span class="attr">prefix:</span> <span class="string">classpath:/templates/</span></span><br><span class="line">    <span class="attr">suffix:</span> <span class="string">.html</span></span><br><span class="line">    <span class="comment">#指定编码</span></span><br><span class="line">    <span class="attr">encoding:</span> <span class="string">utf-8</span></span><br><span class="line">    <span class="comment">#禁用缓存 默认false</span></span><br><span class="line">    <span class="attr">cache:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">jackson:</span></span><br><span class="line">    <span class="attr">time-zone:</span> <span class="string">GMT+8</span></span><br><span class="line">    <span class="attr">date-format:</span> <span class="string">yyyy-MM-dd</span> <span class="string">HH:mm:ss</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">ssl:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="attr">password:</span> </span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">1000</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">200</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">10</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line"><span class="comment">#mybatis:</span></span><br><span class="line"><span class="comment">#  #配置mapper的扫描，找到所有的mapper.xml映射文件</span></span><br><span class="line"><span class="comment">#  mapperLocations : classpath*:mybatis/*/*.xml</span></span><br><span class="line"><span class="comment">#  #mybatis提供三种sql执行器，分别是SIMPLE、REUSE、BATCH。</span></span><br><span class="line"><span class="comment">#  executor-type : reuse</span></span><br><span class="line"><span class="comment">#  #搜索指定包别名</span></span><br><span class="line"><span class="comment">#  typeAliasesPackage : com.*.model</span></span><br><span class="line"><span class="comment">#  #该配置项就是指将带有下划线的表字段映射为驼峰格式的实体类属性。</span></span><br><span class="line"><span class="comment">#  configuration :</span></span><br><span class="line"><span class="comment">#    map-underscore-to-camel-case : true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 控制台输出sql、下划线转驼峰</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:/mybatis-plus/*.xml</span></span><br><span class="line">  <span class="attr">typeAliasesPackage:</span> <span class="string">com.fc.pilotSchool.model</span></span><br><span class="line">  <span class="comment"># 控制台输出sql、下划线转驼峰</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pagehelper分页插件</span></span><br><span class="line"><span class="attr">pagehelper:</span></span><br><span class="line">    <span class="attr">helperDialect:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">reasonable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">supportMethodsArguments:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">params:</span> <span class="string">count=countSql</span></span><br><span class="line"><span class="attr">oss:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">info:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">path-style-access:</span> <span class="literal">false</span>  <span class="comment">#使用云OSS 需要关闭</span></span><br><span class="line">  <span class="attr">endpoint:</span> <span class="string">http://127.0.0.1:9000</span> <span class="comment">#对应上图 ③ 处配置</span></span><br><span class="line">  <span class="attr">access-key:</span> <span class="string">minioadmin</span>  <span class="comment"># 上文创建的AK</span></span><br><span class="line">  <span class="attr">secret-key:</span> <span class="string">minioadmin</span> <span class="comment"># 上文创建的SK</span></span><br><span class="line">  <span class="attr">bucket-name:</span> <span class="string">v2-cloud</span>  <span class="comment"># 上文创建的桶名称</span></span><br></pre></td></tr></table></figure><p>application-dev.yml文件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dev环境  mysql7.0</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="comment">#druid连接池配置</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">     <span class="comment">#主库数据源</span></span><br><span class="line">     <span class="attr">master:</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">jdbc:mysql://xxx.xxx.xxx.xxx:3306/xxxx?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;serverTimezone=GMT</span></span><br><span class="line">        <span class="attr">username:</span> <span class="string">xxxxx</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">xxxxx</span></span><br><span class="line">     <span class="comment">#备数据源 #关闭</span></span><br><span class="line">     <span class="attr">slave:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/xxxx?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT&amp;autoReconnect=true&amp;useSSL=false</span></span><br><span class="line">        <span class="attr">username:</span> <span class="string">xxxx</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">xxxx</span></span><br><span class="line">        <span class="comment">#配置初始化连接数大小</span></span><br><span class="line">     <span class="attr">initial-size:</span> <span class="number">10</span></span><br><span class="line">     <span class="comment"># 最大连接数</span></span><br><span class="line">     <span class="attr">maxActive:</span> <span class="number">50</span></span><br><span class="line">     <span class="comment">#最小连接数</span></span><br><span class="line">     <span class="attr">minIdle:</span> <span class="number">10</span></span><br><span class="line">     <span class="comment">#获取连接等待超时时间</span></span><br><span class="line">     <span class="attr">maxWait:</span> <span class="number">5000</span></span><br><span class="line">     <span class="attr">poolPreparedStatements:</span> <span class="literal">true</span> <span class="comment">#是否缓存preparedStatement，也就是PSCache。PSCache对支持游标的数据库性能提升巨大，比如说oracle。在mysql下建议关闭。</span></span><br><span class="line">     <span class="attr">maxPoolPreparedStatementPerConnection-size:</span> <span class="number">20</span></span><br><span class="line">     <span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line">     <span class="attr">validationQueryTimeout:</span> <span class="number">20000</span></span><br><span class="line">     <span class="attr">testOnBorrow:</span> <span class="literal">false</span> <span class="comment">#申请连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。</span></span><br><span class="line">     <span class="attr">testOnReturn:</span> <span class="literal">false</span> <span class="comment">#归还连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。</span></span><br><span class="line">     <span class="attr">testWhileIdle:</span> <span class="literal">true</span> <span class="comment">#建议配置为true，不影响性能，并且保证安全性。申请连接的时候检测，如果空闲时间大于timeBetweenEvictionRunsMillis，执行validationQuery检测连接是否有效。</span></span><br><span class="line">     <span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span> <span class="comment">#配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒</span></span><br><span class="line">     <span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span>  <span class="comment">#一个连接在池中最小生存的时间，单位是毫秒</span></span><br><span class="line">     <span class="attr">maxEvictableIdleTimeMillis:</span> <span class="number">900000</span>  <span class="comment"># 配置一个连接在池中最大生存的时间，单位是毫秒</span></span><br><span class="line">     <span class="comment">#StatViewServlet配置。（因为暴露的监控信息比较敏感，支持密码加密和访问ip限定）</span></span><br><span class="line">     <span class="attr">webStatFilter:</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">     <span class="attr">statViewServlet:</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">urlPattern:</span> <span class="string">/druid/*</span></span><br><span class="line">      <span class="comment">#可以增加访问账号密码【去掉注释就可以】</span></span><br><span class="line">      <span class="comment">#login-username: admin</span></span><br><span class="line">      <span class="comment">#login-password: admin</span></span><br><span class="line">     <span class="attr">filter:</span></span><br><span class="line">      <span class="attr">stat:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="comment"># 慢SQL记录</span></span><br><span class="line">        <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">slow-sql-millis:</span> <span class="number">1000</span></span><br><span class="line">        <span class="attr">merge-sql:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">wall:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">multi-statement-allow:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#mysql 8.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#spring:</span></span><br><span class="line"><span class="comment">#  datasource:</span></span><br><span class="line"><span class="comment">#    type: com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="comment">#    driverClassName: com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="comment">#    #druid连接池配置</span></span><br><span class="line"><span class="comment">#    druid:</span></span><br><span class="line"><span class="comment">#     # 主库数据源</span></span><br><span class="line"><span class="comment">#     master:</span></span><br><span class="line"><span class="comment">#        url: jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT&amp;autoReconnect=true&amp;useSSL=false</span></span><br><span class="line"><span class="comment">#        username: root</span></span><br><span class="line"><span class="comment">#        password: root</span></span><br><span class="line"><span class="comment">#        #树熊数据源</span></span><br><span class="line"><span class="comment">#     slave:</span></span><br><span class="line"><span class="comment">#        enabled : false</span></span><br><span class="line"><span class="comment">#        url: jdbc:mysql://localhost:3306/test2?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT&amp;autoReconnect=true&amp;useSSL=false</span></span><br><span class="line"><span class="comment">#        username: root</span></span><br><span class="line"><span class="comment">#        password: root</span></span><br><span class="line"><span class="comment">#        #配置初始化连接数大小</span></span><br><span class="line"><span class="comment">#     initial-size: 10</span></span><br><span class="line"><span class="comment">#     # 最大连接数</span></span><br><span class="line"><span class="comment">#     max-active: 50</span></span><br><span class="line"><span class="comment">#     #最小连接数</span></span><br><span class="line"><span class="comment">#     min-idle: 10</span></span><br><span class="line"><span class="comment">#     #获取连接等待超时时间</span></span><br><span class="line"><span class="comment">#     max-wait: 5000</span></span><br><span class="line"><span class="comment">#     pool-prepared-statements: true #是否缓存preparedStatement，也就是PSCache。PSCache对支持游标的数据库性能提升巨大，比如说oracle。在mysql下建议关闭。</span></span><br><span class="line"><span class="comment">#     max-pool-prepared-statement-per-connection-size: 20</span></span><br><span class="line"><span class="comment">#     validation-query: SELECT 1 FROM DUAL</span></span><br><span class="line"><span class="comment">#     validation-query-timeout: 20000</span></span><br><span class="line"><span class="comment">#     test-on-borrow: false #申请连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。</span></span><br><span class="line"><span class="comment">#     test-on-return: false #归还连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。</span></span><br><span class="line"><span class="comment">#     test-while-idle: true #建议配置为true，不影响性能，并且保证安全性。申请连接的时候检测，如果空闲时间大于timeBetweenEvictionRunsMillis，执行validationQuery检测连接是否有效。</span></span><br><span class="line"><span class="comment">#     time-between-eviction-runs-millis: 60000 #配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒</span></span><br><span class="line"><span class="comment">#     min-evictable-idle-time-millis: 300000  #一个连接在池中最小生存的时间，单位是毫秒</span></span><br><span class="line"><span class="comment">#     #StatViewServlet配置。（因为暴露的监控信息比较敏感，支持密码加密和访问ip限定）</span></span><br><span class="line"><span class="comment">#     stat-view-servlet:</span></span><br><span class="line"><span class="comment">#      enabled: true</span></span><br><span class="line"><span class="comment">#      url-pattern: /druid/*</span></span><br><span class="line"><span class="comment">#      #可以增加访问账号密码【去掉注释就可以】</span></span><br><span class="line"><span class="comment">#      #login-username: admin</span></span><br><span class="line"><span class="comment">#      #login-password: admin</span></span><br><span class="line"><span class="comment">#     filter:</span></span><br><span class="line"><span class="comment">#      stat:</span></span><br><span class="line"><span class="comment">#        log-slow-sql: true</span></span><br><span class="line"><span class="comment">#        slow-sql-millis: 1000</span></span><br><span class="line"><span class="comment">#        merge-sql: true</span></span><br><span class="line"><span class="comment">#      wall:</span></span><br><span class="line"><span class="comment">#        config:</span></span><br><span class="line"><span class="comment">#          multi-statement-allow: true</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> YML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Doris记录</title>
      <link href="/2024/04/24/Doris%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/04/24/Doris%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="Apache-Doris-简介"><a href="#Apache-Doris-简介" class="headerlink" title="Apache Doris 简介"></a>Apache Doris 简介</h2><p>Apache Doris（原百度 Palo）是一个现代化的MPP（大规模并行处理）分析型数据库，专为高并发、低延迟的实时分析场景设计。它结合了Google Mesa和Apache Impala的优点，提供了高性能、易扩展、高可用的分布式SQL数据分析解决方案。Doris采用列式存储引擎，支持多维分析、即席查询、统一的批流处理等特性，广泛应用于报表分析、即席查询、数据可视化、实时大屏等场景。</p><h2 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h2><ol><li><strong>简单易用</strong>：兼容MySQL协议，支持标准SQL，无需复杂ETL</li><li><strong>高性能</strong>：MPP架构，向量化执行引擎，智能索引</li><li><strong>高可用</strong>：支持多副本自动同步，故障自动恢复</li><li><strong>可扩展</strong>：支持在线扩缩容，无需停机</li><li><strong>统一的数据分析平台</strong>：支持多种数据模型（明细、聚合、更新）和数据源接入</li></ol><h2 id="Doris架构"><a href="#Doris架构" class="headerlink" title="Doris架构"></a>Doris架构</h2><p>Doris主要由两种角色组成：</p><ol><li>**FE (Frontend)**：负责元数据管理、查询解析、规划和调度</li><li>**BE (Backend)**：负责数据存储和查询执行</li></ol><p><img src="https://doris.apache.org/images/architecture.png" alt="Doris架构图"></p><h3 id="FE角色"><a href="#FE角色" class="headerlink" title="FE角色"></a>FE角色</h3><ul><li><strong>Leader FE</strong>：处理所有元数据写操作，保证元数据一致性</li><li><strong>Follower FE</strong>：接收Leader的元数据更新，提供读服务，可在Leader故障时被选为新Leader</li><li><strong>Observer FE</strong>：只提供读服务，不参与选举，用于扩展查询吞吐量</li></ul><h3 id="BE角色"><a href="#BE角色" class="headerlink" title="BE角色"></a>BE角色</h3><p>所有BE节点对等，负责数据存储和查询执行，支持横向扩展。</p><h2 id="安装部署Doris"><a href="#安装部署Doris" class="headerlink" title="安装部署Doris"></a>安装部署Doris</h2><h3 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h3><ul><li><strong>操作系统</strong>：CentOS 7+&#x2F;Ubuntu 16.04+</li><li><strong>JDK</strong>：1.8+</li><li><strong>GCC</strong>：4.8.2+</li><li><strong>内存</strong>：建议FE ≥ 16GB，BE ≥ 32GB</li><li><strong>磁盘</strong>：SSD为佳</li><li><strong>网络</strong>：万兆网卡为佳</li></ul><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><h4 id="1-下载安装包"><a href="#1-下载安装包" class="headerlink" title="1. 下载安装包"></a>1. 下载安装包</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载最新版本</span></span><br><span class="line">wget https://downloads.apache.org/doris/2.0.2/apache-doris-2.0.2-bin.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar -zxvf apache-doris-2.0.2-bin.tar.gz</span><br></pre></td></tr></table></figure><h4 id="2-配置FE"><a href="#2-配置FE" class="headerlink" title="2. 配置FE"></a>2. 配置FE</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> apache-doris-2.0.2/fe</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">vim conf/fe.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加以下配置</span></span><br><span class="line">priority_networks=192.168.1.0/24  <span class="comment"># 替换为实际网段</span></span><br><span class="line">meta_dir=/path/to/doris/fe/meta   <span class="comment"># 元数据目录</span></span><br><span class="line">http_port=8030</span><br><span class="line">rpc_port=9020</span><br><span class="line">query_port=9030</span><br><span class="line">edit_log_port=9010</span><br></pre></td></tr></table></figure><h4 id="3-配置BE"><a href="#3-配置BE" class="headerlink" title="3. 配置BE"></a>3. 配置BE</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> apache-doris-2.0.2/be</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">vim conf/be.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加以下配置</span></span><br><span class="line">priority_networks=192.168.1.0/24  <span class="comment"># 替换为实际网段</span></span><br><span class="line">storage_root_path=/path/to/doris/be/storage  <span class="comment"># 数据存储目录</span></span><br></pre></td></tr></table></figure><h4 id="4-启动FE"><a href="#4-启动FE" class="headerlink" title="4. 启动FE"></a>4. 启动FE</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> apache-doris-2.0.2/fe</span><br><span class="line">bin/start_fe.sh --daemon</span><br></pre></td></tr></table></figure><h4 id="5-启动BE"><a href="#5-启动BE" class="headerlink" title="5. 启动BE"></a>5. 启动BE</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> apache-doris-2.0.2/be</span><br><span class="line">bin/start_be.sh --daemon</span><br></pre></td></tr></table></figure><h4 id="6-添加BE节点到集群"><a href="#6-添加BE节点到集群" class="headerlink" title="6. 添加BE节点到集群"></a>6. 添加BE节点到集群</h4><p>使用MySQL客户端连接FE：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h 127.0.0.1 -P 9030 -u root</span><br></pre></td></tr></table></figure><p>添加BE节点：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">ADD</span> BACKEND &quot;192.168.1.10:9050&quot;;</span><br></pre></td></tr></table></figure><h2 id="常见问题及解决方案"><a href="#常见问题及解决方案" class="headerlink" title="常见问题及解决方案"></a>常见问题及解决方案</h2><h3 id="1-FE部署问题"><a href="#1-FE部署问题" class="headerlink" title="1. FE部署问题"></a>1. FE部署问题</h3><h4 id="问题：priority-networks配置错误"><a href="#问题：priority-networks配置错误" class="headerlink" title="问题：priority_networks配置错误"></a>问题：priority_networks配置错误</h4><blockquote><p>ip address range configured for priority_networks does not include the current IP address</p></blockquote><p><strong>解决方案</strong>：</p><p>需要在FE的conf目录下正确设置<code>priority_networks</code>网段，确保包含当前节点IP地址。</p><ol><li><p>查看本机IP地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr show eth0 | grep inet | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | awk -F<span class="string">&#x27;/&#x27;</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>修改<code>fe.conf</code>文件，设置正确的网段：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">priority_networks=192.168.1.0/24</span><br></pre></td></tr></table></figure></li></ol><h4 id="问题：FE启动时卡在UNKNOWN状态"><a href="#问题：FE启动时卡在UNKNOWN状态" class="headerlink" title="问题：FE启动时卡在UNKNOWN状态"></a>问题：FE启动时卡在UNKNOWN状态</h4><blockquote><p>wait catalog to be ready. FE type: UNKNOWN. is ready: false, counter: 658341</p></blockquote><p><strong>解决方案</strong>：</p><ol><li><p>检查是否存在虚拟IP地址冲突：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr</span><br></pre></td></tr></table></figure></li><li><p>检查元数据目录权限：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R doris:doris /path/to/doris/fe/meta</span><br></pre></td></tr></table></figure></li><li><p>检查日志文件查找具体错误：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f <span class="built_in">log</span>/fe.log</span><br></pre></td></tr></table></figure></li><li><p>如果是全新安装，可以尝试清空元数据目录重新启动：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /path/to/doris/fe/meta/*</span><br><span class="line">bin/start_fe.sh --daemon</span><br></pre></td></tr></table></figure></li></ol><h3 id="2-BE部署问题"><a href="#2-BE部署问题" class="headerlink" title="2. BE部署问题"></a>2. BE部署问题</h3><h4 id="问题：要求禁用swap内存"><a href="#问题：要求禁用swap内存" class="headerlink" title="问题：要求禁用swap内存"></a>问题：要求禁用swap内存</h4><blockquote><p>Please disable swap memory before installation</p></blockquote><p><strong>解决方案</strong>：</p><p>Doris要求禁用swap以获得更好的性能。</p><ol><li><p>临时禁用swap：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo swapoff -a</span><br></pre></td></tr></table></figure></li><li><p>永久禁用swap（修改&#x2F;etc&#x2F;fstab）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑/etc/fstab，注释掉包含swap的行</span></span><br><span class="line">sudo vim /etc/fstab</span><br><span class="line"><span class="comment"># 注释掉类似下面的行</span></span><br><span class="line"><span class="comment"># /dev/mapper/centos-swap swap swap defaults 0 0</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="问题：JAVA-HOME未定义"><a href="#问题：JAVA-HOME未定义" class="headerlink" title="问题：JAVA_HOME未定义"></a>问题：JAVA_HOME未定义</h4><blockquote><p>The JAVA_HOME environment variable is not defined correctly</p></blockquote><p><strong>解决方案</strong>：</p><ol><li><p>设置JAVA_HOME环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li><li><p>或在启动脚本中直接指定：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk bin/start_fe.sh --daemon</span><br></pre></td></tr></table></figure></li></ol><h3 id="3-集群问题"><a href="#3-集群问题" class="headerlink" title="3. 集群问题"></a>3. 集群问题</h3><h4 id="问题：BE节点无法加入集群"><a href="#问题：BE节点无法加入集群" class="headerlink" title="问题：BE节点无法加入集群"></a>问题：BE节点无法加入集群</h4><p><strong>解决方案</strong>：</p><ol><li><p>检查BE状态：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> BACKENDS;</span><br></pre></td></tr></table></figure></li><li><p>确认网络连通性：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet BE_IP 9050</span><br></pre></td></tr></table></figure></li><li><p>检查BE日志：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f /path/to/doris/be/log/be.INFO</span><br></pre></td></tr></table></figure></li><li><p>尝试重新添加BE：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> DECOMMISSION BACKEND &quot;BE_IP:9050&quot;;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">ADD</span> BACKEND &quot;BE_IP:9050&quot;;</span><br></pre></td></tr></table></figure></li></ol><h4 id="问题：表创建后无法写入数据"><a href="#问题：表创建后无法写入数据" class="headerlink" title="问题：表创建后无法写入数据"></a>问题：表创建后无法写入数据</h4><p><strong>解决方案</strong>：</p><ol><li>检查表的分区和分桶设计是否合理</li><li>确认BE节点状态正常</li><li>检查写入语句是否正确</li><li>查看FE和BE日志获取详细错误信息</li></ol><h2 id="性能优化建议"><a href="#性能优化建议" class="headerlink" title="性能优化建议"></a>性能优化建议</h2><ol><li><strong>合理设计表模型</strong>：选择适当的模型（Aggregate、Unique、Duplicate）</li><li><strong>优化分区分桶</strong>：根据查询模式设计分区和分桶策略</li><li><strong>合理设置Bloom Filter</strong>：对高基数列启用Bloom Filter</li><li><strong>使用物化视图</strong>：针对常见查询模式创建物化视图</li><li><strong>合理设置副本数</strong>：根据可靠性需求和资源情况设置</li><li><strong>定期Compaction</strong>：执行<code>ADMIN MANUAL COMPACT</code>优化存储</li><li><strong>监控资源使用</strong>：关注CPU、内存、磁盘和网络使用情况</li></ol><h2 id="常用运维命令"><a href="#常用运维命令" class="headerlink" title="常用运维命令"></a>常用运维命令</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看FE节点</span></span><br><span class="line"><span class="keyword">SHOW</span> FRONTENDS;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看BE节点</span></span><br><span class="line"><span class="keyword">SHOW</span> BACKENDS;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表信息</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tbl_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表分区</span></span><br><span class="line"><span class="keyword">SHOW</span> PARTITIONS <span class="keyword">FROM</span> tbl_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表的数据分布</span></span><br><span class="line"><span class="keyword">SHOW</span> TABLET <span class="keyword">FROM</span> tbl_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 手动触发Compaction</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name MANUAL COMPACT;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Apache Doris是一个功能强大的分析型数据库，适合各种实时分析场景。正确部署和配置Doris是充分发挥其性能的关键。本文记录了Doris部署过程中的常见问题及解决方案，希望能帮助用户更顺利地部署和使用Doris。</p><h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ul><li><a href="https://doris.apache.org/docs/dev/install/install-deploy/">Apache Doris官方文档</a></li><li><a href="https://github.com/apache/doris">Apache Doris GitHub仓库</a></li><li><a href="https://lists.apache.org/list.html?dev@doris.apache.org">Apache Doris用户邮件列表</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Doris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>服务器巡检</title>
      <link href="/2024/04/24/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B7%A1%E6%A3%80/"/>
      <url>/2024/04/24/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B7%A1%E6%A3%80/</url>
      
        <content type="html"><![CDATA[<h3 id="巡检命令"><a href="#巡检命令" class="headerlink" title="巡检命令"></a>巡检命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">top</span><br><span class="line"><span class="comment"># 查看cpu的空闲时间以及IO等待完成时间</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">free -h</span><br><span class="line"><span class="comment"># 查看avaliable的使用情况</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h</span><br><span class="line"><span class="comment"># 查看磁盘空间占用情况</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getenforce</span><br><span class="line"><span class="comment"># 使用getenforce命令可以在Linux下查看是否开启了SELinux</span></span><br><span class="line"><span class="comment"># 如果为disable则有风险</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld</span><br><span class="line"><span class="comment"># 查看防火墙是否开启</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br><span class="line"><span class="comment"># 查看有没有未知的定时任务</span></span><br></pre></td></tr></table></figure><h3 id="数据库巡检"><a href="#数据库巡检" class="headerlink" title="数据库巡检"></a>数据库巡检</h3><hr><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> instance_name,host_name,startup_time,status,database_status <span class="keyword">from</span> v$instance;</span><br><span class="line"><span class="comment">-- 查看Oracl实例的状态</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">group</span>#,status,type,<span class="keyword">member</span> <span class="keyword">from</span> v$logfile; </span><br><span class="line"><span class="comment">-- 检查Oracle在线日志状态</span></span><br></pre></td></tr></table></figure><blockquote><p>在Oracle数据库中，<code>v$logfile</code>是一个动态性能视图，它提供了关于在线重做日志文件的信息。这些日志文件是Oracle用于记录所有数据库更改（如插入、更新和删除操作）的物理文件。这些更改随后可用于恢复操作，例如实例恢复或介质恢复。<br>从v$logfile视图中检索以下列的信息：</p><ol><li><strong>group#</strong> - 这是重做日志组的编号。在Oracle中，你可以有多个在线重做日志组，每个组可以有一个或多个成员（即物理文件）。</li></ol><ul><li><code>group#</code>列表示日志组的编号。</li></ul><ol start="2"><li><strong>status</strong> - 这列显示了重做日志的状态。可能的值包括：</li></ol><ul><li><p><code>CURRENT</code> - 表示该日志文件是当前正在写入的日志文件。</p></li><li><p><code>ACTIVE</code> - 表示该日志文件包含尚未被归档的更改。</p></li><li><p><code>INACTIVE</code> - 表示该日志文件不再用于写入，但可能包含尚未被覆盖的更改。</p></li><li><p><code>UNUSED</code> - 表示该日志文件尚未使用。</p></li></ul><ol start="3"><li><p><strong>type</strong> - 这列描述了重做日志文件的类型。对于在线重做日志文件，它通常显示为<code>ONLINE</code>。</p></li><li><p><strong>member</strong> - 这列显示了重做日志文件的完整路径和名称。每个日志组可以有多个成员，这意味着该组的日志数据被写入多个物理文件中。这提供了冗余和容错能力，因为如果一个物理文件损坏，其他文件仍然可用。</p></li></ol><p>通过查询<code>v$logfile</code>视图，数据库管理员可以了解当前哪些日志文件正在使用，哪些处于空闲状态，以及这些日志文件的物理位置。这对于诊断问题、规划磁盘空间以及进行恢复操作都非常重要。</p></blockquote><hr><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tablespace_name,status <span class="keyword">from</span> dba_tablespaces; </span><br><span class="line"><span class="comment">-- 检查Oracle表空间的状态</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,status <span class="keyword">from</span> v$datafile;</span><br><span class="line"><span class="comment">-- 检查Oracle所有数据文件状态</span></span><br></pre></td></tr></table></figure><blockquote><ol><li><p><strong>name</strong> - 这列显示了数据文件的完整路径和名称。它提供了数据文件的物理位置信息。</p></li><li><p><strong>status</strong> - 这列描述了数据文件的状态。可能的状态值包括：</p><ul><li><code>AVAILABLE</code> - 数据文件可用，并且可以被访问。</li><li><code>RECOVER</code> - 数据文件正在恢复中，可能由于介质故障或其他原因。</li><li><code>OFFLINE</code> - 数据文件当前不可用，可能由于管理员手动将其设置为离线状态，或者由于其他原因（如磁盘故障）。</li><li><code>INVALID</code> - 数据文件的状态无效或损坏。</li><li><code>DELETED</code> - 数据文件已被标记为删除，但其空间可能尚未被释放。</li></ul></li></ol><p>通过查询<code>v$datafile</code>视图，数据库管理员可以了解数据库中所有数据文件的状态和位置。这对于诊断问题、管理磁盘空间、备份和恢复操作以及监控数据库的健康状况都至关重要。例如，如果某个数据文件的状态为<code>OFFLINE</code>，那么可能需要进一步调查为什么它不可用，并考虑将其恢复为<code>AVAILABLE</code>状态。同样，如果数据文件的状态为<code>INVALID</code>或<code>RECOVER</code>，则可能需要进行恢复操作以确保数据的完整性和可用性。</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> segment_name,status <span class="keyword">from</span> dba_rollback_segs;</span><br><span class="line"><span class="comment">-- 检查所有回滚段状态</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">Upper</span>(F.TABLESPACE_NAME)         &quot;表空间名&quot;,</span><br><span class="line">       D.TOT_GROOTTE_MB                 &quot;表空间大小(M)&quot;,</span><br><span class="line">       D.TOT_GROOTTE_MB <span class="operator">-</span> F.TOTAL_BYTES &quot;已使用空间(M)&quot;,</span><br><span class="line">       To_char(Round(( D.TOT_GROOTTE_MB <span class="operator">-</span> F.TOTAL_BYTES ) <span class="operator">/</span> D.TOT_GROOTTE_MB <span class="operator">*</span> <span class="number">100</span>, <span class="number">2</span>), <span class="string">&#x27;990.99&#x27;</span>)</span><br><span class="line">       <span class="operator">||</span> <span class="string">&#x27;%&#x27;</span>                           &quot;使用比&quot;,</span><br><span class="line">       F.TOTAL_BYTES                    &quot;空闲空间(M)&quot;,</span><br><span class="line">       F.MAX_BYTES                      &quot;最大块(M)&quot;</span><br><span class="line"><span class="keyword">FROM</span>   (<span class="keyword">SELECT</span> TABLESPACE_NAME,</span><br><span class="line">               Round(<span class="built_in">Sum</span>(BYTES) <span class="operator">/</span> ( <span class="number">1024</span> <span class="operator">*</span> <span class="number">1024</span> ), <span class="number">2</span>) TOTAL_BYTES,</span><br><span class="line">               Round(<span class="built_in">Max</span>(BYTES) <span class="operator">/</span> ( <span class="number">1024</span> <span class="operator">*</span> <span class="number">1024</span> ), <span class="number">2</span>) MAX_BYTES</span><br><span class="line">        <span class="keyword">FROM</span>   SYS.DBA_FREE_SPACE</span><br><span class="line">        <span class="keyword">GROUP</span>  <span class="keyword">BY</span> TABLESPACE_NAME) F,</span><br><span class="line">       (<span class="keyword">SELECT</span> DD.TABLESPACE_NAME,</span><br><span class="line">               Round(<span class="built_in">Sum</span>(DD.BYTES) <span class="operator">/</span> ( <span class="number">1024</span> <span class="operator">*</span> <span class="number">1024</span> ), <span class="number">2</span>) TOT_GROOTTE_MB</span><br><span class="line">        <span class="keyword">FROM</span>   SYS.DBA_DATA_FILES DD</span><br><span class="line">        <span class="keyword">GROUP</span>  <span class="keyword">BY</span> DD.TABLESPACE_NAME) D</span><br><span class="line"><span class="keyword">WHERE</span>  D.TABLESPACE_NAME <span class="operator">=</span> F.TABLESPACE_NAME</span><br><span class="line"><span class="keyword">ORDER</span>  <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检查表空间使用情况</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.VALUE <span class="operator">+</span> b.VALUE logical_reads,</span><br><span class="line">       c.VALUE phys_reads,</span><br><span class="line">       round(<span class="number">100</span> <span class="operator">*</span> (<span class="number">1</span> <span class="operator">-</span> c.value <span class="operator">/</span> (a.value <span class="operator">+</span> b.value)), <span class="number">4</span>) hit_ratio</span><br><span class="line">  <span class="keyword">FROM</span> v$sysstat a, v$sysstat b, v$sysstat c</span><br><span class="line"> <span class="keyword">WHERE</span> a.NAME <span class="operator">=</span> <span class="string">&#x27;db block gets&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> b.NAME <span class="operator">=</span> <span class="string">&#x27;consistent gets&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> c.NAME <span class="operator">=</span> <span class="string">&#x27;physical reads&#x27;</span>;</span><br><span class="line"><span class="comment">-- 检查缓冲区命中率</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">select</span> index_name, table_name, tablespace_name, status</span><br><span class="line">  <span class="keyword">From</span> dba_indexes</span><br><span class="line"> <span class="keyword">Where</span> owner <span class="operator">=</span> <span class="string">&#x27;CTAIS2&#x27;</span></span><br><span class="line">   <span class="keyword">And</span> status <span class="operator">&lt;&gt;</span> <span class="string">&#x27;VALID&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检查失效的索引</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> owner, constraint_name, table_name, constraint_type, status</span><br><span class="line">  <span class="keyword">FROM</span> dba_constraints</span><br><span class="line"> <span class="keyword">WHERE</span> status <span class="operator">=</span> <span class="string">&#x27;DISABLE&#x27;</span></span><br><span class="line"><span class="keyword">and</span> constraint_type <span class="operator">=</span> <span class="string">&#x27;P&#x27;</span>;</span><br><span class="line"><span class="comment">-- 检查不起作用的约束</span></span><br></pre></td></tr></table></figure><p><em>下面的命令需要在sqlplus上执行</em>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">sqlplus /nolog</span><br><span class="line">conn sys/ as sysdba;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">parameter</span> process;   </span><br><span class="line"><span class="comment">-- 查看db_write_process数设定值</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">parameter</span> sessions;  </span><br><span class="line"><span class="comment">-- 查看session数设定值</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> v$session;</span><br><span class="line"><span class="comment">-- 查看session数实际值</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(percent_space_used) <span class="keyword">from</span> v$flash_recovery_area_usage;</span><br><span class="line"><span class="comment">-- 查看归档日志占比</span></span><br></pre></td></tr></table></figure><hr><h3 id="扩展表空间"><a href="#扩展表空间" class="headerlink" title="扩展表空间"></a>扩展表空间</h3><p>查看表空间使用百分比</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"> b.file_id 文件ID号,</span><br><span class="line"> b.tablespace_name 表空间名,</span><br><span class="line"> b.bytes <span class="operator">/</span> <span class="number">1024</span> <span class="operator">/</span> <span class="number">1024</span> <span class="operator">||</span> <span class="string">&#x27;M&#x27;</span> 字节数,</span><br><span class="line"> (</span><br><span class="line">  b.bytes <span class="operator">-</span> <span class="built_in">sum</span>(nvl(a.bytes, <span class="number">0</span>))</span><br><span class="line"> ) <span class="operator">/</span> <span class="number">1024</span> <span class="operator">/</span> <span class="number">1024</span> <span class="operator">||</span> <span class="string">&#x27;M&#x27;</span> 已使用,</span><br><span class="line"> <span class="built_in">sum</span>(nvl(a.bytes, <span class="number">0</span>)) <span class="operator">/</span> <span class="number">1024</span> <span class="operator">/</span> <span class="number">1024</span> <span class="operator">||</span> <span class="string">&#x27;M&#x27;</span> 剩余空间,</span><br><span class="line"> <span class="number">100</span> <span class="operator">-</span> <span class="built_in">sum</span>(nvl(a.bytes, <span class="number">0</span>)) <span class="operator">/</span> (b.bytes) <span class="operator">*</span> <span class="number">100</span> 占用百分比</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"> dba_free_space a,</span><br><span class="line"> dba_data_files b</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"> a.file_id <span class="operator">=</span> b.file_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line"> b.tablespace_name,</span><br><span class="line"> b.file_id,</span><br><span class="line"> b.bytes</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line"> b.file_id;</span><br></pre></td></tr></table></figure><p>查看表空间路径</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"> tablespace_name,</span><br><span class="line"> file_id,</span><br><span class="line"> file_name,</span><br><span class="line"> round(bytes <span class="operator">/</span>(<span class="number">1024</span> <span class="operator">*</span> <span class="number">1024</span>), <span class="number">0</span>) total_space</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"> dba_data_files</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line"> tablespace_name;</span><br></pre></td></tr></table></figure><p>扩展表空间</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span>SPACE USERS <span class="keyword">ADD</span> DATAFILE <span class="string">&#x27;D:\APP\ADMINISTRATOR\ORADATA\ORCL\USERS04.DBF&#x27;</span> SIZE <span class="number">10000</span>M;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE DATAFILE <span class="string">&#x27;+DATA/jhszws/datafile/phistablespace2017.ora&#x27;</span> RESIZE <span class="number">10</span>G;</span><br></pre></td></tr></table></figure><p>设置自动扩展</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> database datafile <span class="string">&#x27;/erp/TEST/db/data/cux_arch_03.dbf&#x27;</span> autoextend <span class="keyword">on</span> next <span class="number">1000</span>M maxsize <span class="number">16000</span>M;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Map的四种遍历方式</title>
      <link href="/2024/04/24/map%E7%9A%84%E5%9B%9B%E7%A7%8D%E9%81%8D%E5%8E%86%E6%96%B9%E5%BC%8F/"/>
      <url>/2024/04/24/map%E7%9A%84%E5%9B%9B%E7%A7%8D%E9%81%8D%E5%8E%86%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h2><p>由于Map中存放的元素均为键值对，故每一个键值对必然存在一个映射关系。<br>Map中采用Entry内部类来表示一个映射项，映射项包含Key和Value (我们总说键值对键值对, 每一个键值对也就是一个Entry)<br>Map.Entry里面包含getKey()和getValue()方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Iterator&lt;Map.Entry&lt;Integer, Integer&gt;&gt; it=map.entrySet().iterator();</span><br><span class="line">    <span class="keyword">while</span>(it.hasNext()) &#123;</span><br><span class="line">        Map.Entry&lt;Integer,Integer&gt; entry=it.next();</span><br><span class="line">        <span class="type">int</span> key=entry.getKey();</span><br><span class="line">        <span class="type">int</span> value=entry.getValue();</span><br><span class="line">        System.out.println(key+<span class="string">&quot; &quot;</span>+value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="entrySet"><a href="#entrySet" class="headerlink" title="entrySet"></a>entrySet</h2><p>entrySet是 java中 键-值 对的集合，Set里面的类型是Map.Entry，一般可以通过map.entrySet()得到。</p><p>entrySet实现了Set接口，里面存放的是键值对。一个K对应一个V。<br>用来遍历map的一种方法.  </p><p>即通过getKey（）得到K，getValue得到V。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;Map.Entry&lt;String, String&gt;&gt; entryseSet=map.entrySet();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry:entryseSet) &#123;</span><br><span class="line"> </span><br><span class="line">    System.out.println(entry.getKey()+<span class="string">&quot;,&quot;</span>+entry.getValue());</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="keySet"><a href="#keySet" class="headerlink" title="keySet"></a>keySet</h2><p>还有一种是keySet, keySet是键的集合，Set里面的类型即key的类型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;String&gt; set = map.keySet();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (String s:set) &#123;</span><br><span class="line"> </span><br><span class="line">    System.out.println(s+<span class="string">&quot;,&quot;</span>+map.get(s));</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="value"><a href="#value" class="headerlink" title="value"></a>value</h2><p>通过使用map的value方法进行遍历<br><em>$\color{red}{不能遍历key}$</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (String v : map.values()) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> v;</span><br><span class="line">    System.out.println(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>四种遍历Map方式:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"> </span><br><span class="line">    Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, String&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;value1&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;value2&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;value3&quot;</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//第一种：普遍使用，二次取值</span></span><br><span class="line">    System.out.println(<span class="string">&quot;通过Map.keySet遍历key和value：&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (String key : map.keySet()) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;key= &quot;</span>+ key + <span class="string">&quot; and value= &quot;</span> + map.get(key));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//第二种</span></span><br><span class="line">    System.out.println(<span class="string">&quot;通过Map.entrySet使用iterator遍历key和value：&quot;</span>);</span><br><span class="line">    Iterator&lt;Map.Entry&lt;String, String&gt;&gt; it = map.entrySet().iterator();</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">        Map.Entry&lt;String, String&gt; entry = it.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;key= &quot;</span> + entry.getKey() + <span class="string">&quot; and value= &quot;</span> + entry.getValue());</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//第三种：推荐，尤其是容量大时</span></span><br><span class="line">    System.out.println(<span class="string">&quot;通过Map.entrySet遍历key和value&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : map.entrySet()) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;key= &quot;</span> + entry.getKey() + <span class="string">&quot; and value= &quot;</span> + entry.getValue());</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//第四种</span></span><br><span class="line">    System.out.println(<span class="string">&quot;通过Map.values()遍历所有的value，但不能遍历key&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (String v : map.values()) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;value= &quot;</span> + v);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Doris SQL 特技</title>
      <link href="/2024/04/23/Doris%20SQL%20%E7%89%B9%E6%8A%80/"/>
      <url>/2024/04/23/Doris%20SQL%20%E7%89%B9%E6%8A%80/</url>
      
        <content type="html"><![CDATA[<h2 id="group-concat"><a href="#group-concat" class="headerlink" title="group_concat"></a><font style="color:rgb(29, 29, 29);">group_concat</font></h2><h3 id="description"><a href="#description" class="headerlink" title="description"></a><font style="color:rgb(29, 29, 29);">description</font></h3><h4 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a><font style="color:rgb(29, 29, 29);">Syntax</font></h4><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;VARCHAR GROUP_CONCAT([DISTINCT] VARCHAR str[, VARCHAR sep] [ORDER BY &#123; col_name | expr&#125; [ASC | DESC])&lt;/font&gt;</code><br><font style="color:rgb(42, 47, 52);">该函数是类似于 sum() 的聚合函数，group_concat 将结果集中的多行结果连接成一个字符串。第二个参数 sep 为字符串之间的连接符号，该参数可以省略。该函数通常需要和 group by 语句一起使用。</font></p><p><font style="color:rgb(42, 47, 52);"></font></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">value</span> <span class="keyword">from</span> test;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> a     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> c     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> c     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> GROUP_CONCAT(<span class="keyword">value</span>) <span class="keyword">from</span> test;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="operator">|</span> GROUP_CONCAT(`<span class="keyword">value</span>`) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="operator">|</span> a, b, c, c               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> GROUP_CONCAT(<span class="keyword">DISTINCT</span> <span class="keyword">value</span>) <span class="keyword">from</span> test;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="operator">|</span> GROUP_CONCAT(`<span class="keyword">value</span>`) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"><span class="operator">|</span> a, b, c               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> GROUP_CONCAT(<span class="keyword">value</span>, &quot; &quot;) <span class="keyword">from</span> test;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> GROUP_CONCAT(`<span class="keyword">value</span>`, <span class="string">&#x27; &#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> a b c c                    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> GROUP_CONCAT(<span class="keyword">value</span>, <span class="keyword">NULL</span>) <span class="keyword">from</span> test;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> GROUP_CONCAT(`<span class="keyword">value</span>`, <span class="keyword">NULL</span>)<span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>                       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">abs</span>(k3), group_concat(<span class="keyword">distinct</span> <span class="built_in">cast</span>(<span class="built_in">abs</span>(k2) <span class="keyword">as</span> <span class="type">varchar</span>) <span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">abs</span>(k1), k5) <span class="keyword">FROM</span> bigtable <span class="keyword">group</span> <span class="keyword">by</span> <span class="built_in">abs</span>(k3) <span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">abs</span>(k3);     <span class="operator">+</span><span class="comment">------------+-------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">abs</span>(`k3`)  <span class="operator">|</span> group_concat(<span class="keyword">DISTINCT</span> <span class="built_in">CAST</span>(<span class="built_in">abs</span>(`k2`) <span class="keyword">AS</span> <span class="type">CHARACTER</span>), <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">abs</span>(`k1`), `k5`) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">103</span> <span class="operator">|</span> <span class="number">255</span>                                                                           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1001</span> <span class="operator">|</span> <span class="number">1989</span>, <span class="number">1986</span>                                                                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1002</span> <span class="operator">|</span> <span class="number">1989</span>, <span class="number">32767</span>                                                                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">3021</span> <span class="operator">|</span> <span class="number">1991</span>, <span class="number">32767</span>, <span class="number">1992</span>                                                             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">5014</span> <span class="operator">|</span> <span class="number">1985</span>, <span class="number">1991</span>                                                                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">25699</span> <span class="operator">|</span> <span class="number">1989</span>                                                                          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2147483647</span> <span class="operator">|</span> <span class="number">255</span>, <span class="number">1991</span>, <span class="number">32767</span>, <span class="number">32767</span>                                                       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-------------------------------------------------------------------------------+</span></span><br></pre></td></tr></table></figure><h2 id="row-number"><a href="#row-number" class="headerlink" title="row_number"></a><font style="color:rgb(29, 29, 29);">row_number</font></h2><h3 id="description-1"><a href="#description-1" class="headerlink" title="description"></a><font style="color:rgb(29, 29, 29);">description</font></h3><p><font style="color:rgb(42, 47, 52);">为每个 Partition 的每一行返回一个从1开始连续递增的整数。与 RANK() 和 DENSE_RANK() 不同的是，ROW_NUMBER() 返回的值不会重复也不会出现空缺，是连续递增的。</font></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span>(partition_by_clause order_by_clause)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> x, y, <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> x <span class="keyword">order</span> <span class="keyword">by</span> y) <span class="keyword">as</span> rank <span class="keyword">from</span> int_t;</span><br><span class="line"></span><br><span class="line"><span class="operator">|</span> x <span class="operator">|</span> y    <span class="operator">|</span> rank     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="comment">---|------|----------|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">1</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">1</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">1</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br></pre></td></tr></table></figure><h2 id="timestampdiff"><a href="#timestampdiff" class="headerlink" title="timestampdiff"></a><font style="color:rgb(29, 29, 29);">timestampdiff</font></h2><h3 id="description-2"><a href="#description-2" class="headerlink" title="description"></a><font style="color:rgb(29, 29, 29);">description</font></h3><h4 id="Syntax-1"><a href="#Syntax-1" class="headerlink" title="Syntax"></a><font style="color:rgb(29, 29, 29);">Syntax</font></h4><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;INT&lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt; &lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;TIMESTAMPDIFF&lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;(unit, DATETIME datetime_expr1, DATETIME datetime_expr2)&lt;/font&gt;</code></p><p><font style="color:rgb(42, 47, 52);">返回datetime_expr2−datetime_expr1，其中datetime_expr1和datetime_expr2是日期或日期时间表达式。</font></p><p><font style="color:rgb(42, 47, 52);">结果(整数)的单位由unit参数给出。interval的单位由unit参数给出，它应该是下列值之一:</font></p><p><font style="color:rgb(42, 47, 52);">SECOND, MINUTE, HOUR, DAY, WEEK, MONTH, or YEAR。</font></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">MySQL<span class="operator">&gt;</span> <span class="keyword">SELECT</span> TIMESTAMPDIFF(<span class="keyword">MONTH</span>,<span class="string">&#x27;2003-02-01&#x27;</span>,<span class="string">&#x27;2003-05-01&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> timestampdiff(<span class="keyword">MONTH</span>, <span class="string">&#x27;2003-02-01 00:00:00&#x27;</span>, <span class="string">&#x27;2003-05-01 00:00:00&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>                                                                  <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------------+</span></span><br><span class="line"></span><br><span class="line">MySQL<span class="operator">&gt;</span> <span class="keyword">SELECT</span> TIMESTAMPDIFF(<span class="keyword">YEAR</span>,<span class="string">&#x27;2002-05-01&#x27;</span>,<span class="string">&#x27;2001-01-01&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> timestampdiff(<span class="keyword">YEAR</span>, <span class="string">&#x27;2002-05-01 00:00:00&#x27;</span>, <span class="string">&#x27;2001-01-01 00:00:00&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>                                                                <span class="number">-1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------------------------------------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MySQL<span class="operator">&gt;</span> <span class="keyword">SELECT</span> TIMESTAMPDIFF(<span class="keyword">MINUTE</span>,<span class="string">&#x27;2003-02-01&#x27;</span>,<span class="string">&#x27;2003-05-01 12:05:55&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> timestampdiff(<span class="keyword">MINUTE</span>, <span class="string">&#x27;2003-02-01 00:00:00&#x27;</span>, <span class="string">&#x27;2003-05-01 12:05:55&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>                                                              <span class="number">128885</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------+</span></span><br></pre></td></tr></table></figure><h2 id="array-distinct"><a href="#array-distinct" class="headerlink" title="array_distinct"></a><font style="color:rgb(29, 29, 29);">array_distinct</font></h2><h3 id="description-3"><a href="#description-3" class="headerlink" title="description"></a><font style="color:rgb(29, 29, 29);">description</font></h3><h4 id="Syntax-2"><a href="#Syntax-2" class="headerlink" title="Syntax"></a><font style="color:rgb(29, 29, 29);">Syntax</font></h4><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;ARRAY&lt;T&gt;&lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt; &lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;array_distinct&lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;(ARRAY&lt;T&gt; arr)&lt;/font&gt;</code></p><p><font style="color:rgb(42, 47, 52);">返回去除了重复元素的数组，如果输入数组为NULL，则返回NULL。</font></p><h3 id="notice"><a href="#notice" class="headerlink" title="notice"></a><font style="color:rgb(29, 29, 29);">notice</font></h3><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;仅支持向量化引擎中使用&lt;/font&gt;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> k1, k2, array_distinct(k2) <span class="keyword">from</span> array_test;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> k1   <span class="operator">|</span> k2                          <span class="operator">|</span> array_distinct(k2)        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]             <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]                   <span class="operator">|</span> [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> []                          <span class="operator">|</span> []                        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>    <span class="operator">|</span> <span class="keyword">NULL</span>                        <span class="operator">|</span> <span class="keyword">NULL</span>                      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>    <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>] <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6</span>    <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="keyword">NULL</span>]             <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="keyword">NULL</span>]           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7</span>    <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="keyword">NULL</span>, <span class="keyword">NULL</span>]       <span class="operator">|</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="keyword">NULL</span>]     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------------------------+---------------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> k1, k2, array_distinct(k2) <span class="keyword">from</span> array_test01;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------------------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> k1   <span class="operator">|</span> k2                                       <span class="operator">|</span> array_distinct(`k2`)      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------------------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]                <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>] <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> [<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]                          <span class="operator">|</span> [<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> [<span class="string">&#x27;&#x27;</span>]                                     <span class="operator">|</span> [<span class="string">&#x27;&#x27;</span>]                      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> [<span class="keyword">NULL</span>]                                   <span class="operator">|</span> [<span class="keyword">NULL</span>]                    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>    <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>] <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>] <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6</span>    <span class="operator">|</span> <span class="keyword">NULL</span>                                     <span class="operator">|</span> <span class="keyword">NULL</span>                      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7</span>    <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="keyword">NULL</span>]                         <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="keyword">NULL</span>]          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">8</span>    <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="keyword">NULL</span>, <span class="keyword">NULL</span>]                   <span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="keyword">NULL</span>]    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------------------------------+---------------------------+</span></span><br></pre></td></tr></table></figure><h2 id="split-by-string"><a href="#split-by-string" class="headerlink" title="split_by_string"></a><font style="color:rgb(29, 29, 29);">split_by_string</font></h2><h3 id="description-4"><a href="#description-4" class="headerlink" title="description"></a><font style="color:rgb(29, 29, 29);">description</font></h3><h4 id="Syntax-3"><a href="#Syntax-3" class="headerlink" title="Syntax"></a><font style="color:rgb(29, 29, 29);">Syntax</font></h4><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;ARRAY&lt;STRING&gt;&lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt; &lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;split_by_string&lt;/font&gt;&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;(STRING s, STRING separator)&lt;/font&gt;</code><font style="color:rgb(42, 47, 52);"> </font><font style="color:rgb(42, 47, 52);">将字符串拆分为由字符串分隔的子字符串。它使用多个字符的常量字符串分隔符作为分隔符。如果字符串分隔符为空，它将字符串拆分为单个字符数组。</font></p><h4 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a><font style="color:rgb(29, 29, 29);">Arguments</font></h4><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;separator&lt;/font&gt;</code><font style="color:rgb(42, 47, 52);"> </font><font style="color:rgb(42, 47, 52);">— 分隔符是一个字符串，是用来分割的标志字符. 类型:</font><font style="color:rgb(42, 47, 52);"> </font><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;String&lt;/font&gt;</code></p><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;s&lt;/font&gt;</code><font style="color:rgb(42, 47, 52);"> </font><font style="color:rgb(42, 47, 52);">— 需要分割的字符串. 类型:</font><font style="color:rgb(42, 47, 52);"> </font><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;String&lt;/font&gt;</code></p><h4 id="Returned-value-s"><a href="#Returned-value-s" class="headerlink" title="Returned value(s)"></a><font style="color:rgb(29, 29, 29);">Returned value(s)</font></h4><p><font style="color:rgb(42, 47, 52);">返回一个包含子字符串的数组. 以下情况会返回空的子字符串:</font></p><p><font style="color:rgb(42, 47, 52);">需要分割的字符串的首尾是分隔符;</font></p><p><font style="color:rgb(42, 47, 52);">多个分隔符连续出现;</font></p><p><font style="color:rgb(42, 47, 52);">需要分割的字符串为空，而分隔符不为空.</font></p><p><font style="color:rgb(42, 47, 52);">Type:</font><font style="color:rgb(42, 47, 52);"> </font><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;Array(String)&lt;/font&gt;</code></p><h3 id="notice-1"><a href="#notice-1" class="headerlink" title="notice"></a><font style="color:rgb(29, 29, 29);">notice</font></h3><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;仅支持向量化引擎中使用&lt;/font&gt;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> split_by_string(<span class="string">&#x27;a1b1c1d&#x27;</span>,<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="string">&#x27;a1b1c1d&#x27;</span>, <span class="string">&#x27;1&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"><span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> split_by_string(<span class="string">&#x27;,,a,b,c,&#x27;</span>,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="string">&#x27;,,a,b,c,&#x27;</span>, <span class="string">&#x27;,&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------------+</span></span><br><span class="line"><span class="operator">|</span> [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;&#x27;</span>]      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> split_by_string(<span class="keyword">NULL</span>,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="keyword">NULL</span>, <span class="string">&#x27;,&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>                       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> split_by_string(<span class="string">&#x27;a,b,c,abcde&#x27;</span>,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="string">&#x27;a,b,c,abcde&#x27;</span>, <span class="string">&#x27;,&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;abcde&#x27;</span>]            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> split_by_string(<span class="string">&#x27;1,,2,3,,4,5,,abcde&#x27;</span>, <span class="string">&#x27;,,&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="string">&#x27;1,,2,3,,4,5,,abcde&#x27;</span>, <span class="string">&#x27;,,&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2,3&#x27;</span>, <span class="string">&#x27;4,5&#x27;</span>, <span class="string">&#x27;abcde&#x27;</span>]                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> split_by_string(<span class="string">&#x27;,,,,&#x27;</span>,<span class="string">&#x27;,,&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="string">&#x27;,,,,&#x27;</span>, <span class="string">&#x27;,,&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------+</span></span><br><span class="line"><span class="operator">|</span> [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>]                  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> split_by_string(<span class="string">&#x27;,,a,,b,,c,,&#x27;</span>,<span class="string">&#x27;,,&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> split_by_string(<span class="string">&#x27;,,a,,b,,c,,&#x27;</span>, <span class="string">&#x27;,,&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> [<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;&#x27;</span>]              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Doris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Doris分区、分片、副本的基本命令、修复副本思路</title>
      <link href="/2024/04/23/Doris%E5%88%86%E5%8C%BA%E3%80%81%E5%88%86%E7%89%87%E3%80%81%E5%89%AF%E6%9C%AC%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E3%80%81%E4%BF%AE%E5%A4%8D%E5%89%AF%E6%9C%AC%E6%80%9D%E8%B7%AF/"/>
      <url>/2024/04/23/Doris%E5%88%86%E5%8C%BA%E3%80%81%E5%88%86%E7%89%87%E3%80%81%E5%89%AF%E6%9C%AC%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E3%80%81%E4%BF%AE%E5%A4%8D%E5%89%AF%E6%9C%AC%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="关于副本的一些操作"><a href="#关于副本的一些操作" class="headerlink" title="关于副本的一些操作"></a>关于副本的一些操作</h2><h3 id="查看建表语句"><a href="#查看建表语句" class="headerlink" title="查看建表语句"></a>查看建表语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_table</span><br></pre></td></tr></table></figure><h3 id="关闭动态分区"><a href="#关闭动态分区" class="headerlink" title="关闭动态分区"></a>关闭动态分区</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">SET</span> (  </span><br><span class="line">  &quot;dynamic_partition.enable&quot; <span class="operator">=</span> &quot;false&quot;  </span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">SET</span> (  </span><br><span class="line">  &quot;dynamic_partition.enable&quot; <span class="operator">=</span> &quot;true&quot;  </span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="删除分区"><a href="#删除分区" class="headerlink" title="删除分区"></a>删除分区</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">DROP</span> <span class="keyword">PARTITION</span> p202309;</span><br></pre></td></tr></table></figure><h3 id="添加分区-顺便设置副本数"><a href="#添加分区-顺便设置副本数" class="headerlink" title="添加分区(顺便设置副本数)"></a>添加分区(顺便设置副本数)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> p1 <span class="keyword">VALUES</span> LESS THAN (&quot;2015-01-01&quot;) (&quot;replication_num&quot;<span class="operator">=</span>&quot;1&quot;);</span><br></pre></td></tr></table></figure><h3 id="查看分区"><a href="#查看分区" class="headerlink" title="查看分区"></a>查看分区</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> [TEMPORARY] PARTITIONS <span class="keyword">FROM</span> [db_name.]table_name [<span class="keyword">WHERE</span>] [<span class="keyword">ORDER</span> <span class="keyword">BY</span>] [LIMIT];</span><br></pre></td></tr></table></figure><h3 id="删除分区内的数据"><a href="#删除分区内的数据" class="headerlink" title="删除分区内的数据"></a>删除分区内的数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> my_table <span class="keyword">PARTITION</span>(part01);</span><br></pre></td></tr></table></figure><h3 id="调整分区的副本数"><a href="#调整分区的副本数" class="headerlink" title="调整分区的副本数"></a>调整分区的副本数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> example_db.my_table MODIFY <span class="keyword">PARTITION</span> p1 <span class="keyword">SET</span>(&quot;replication_num&quot;<span class="operator">=</span>&quot;1&quot;);</span><br></pre></td></tr></table></figure><h3 id="查看分片的副本信息"><a href="#查看分片的副本信息" class="headerlink" title="查看分片的副本信息"></a>查看分片的副本信息</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLETS <span class="keyword">from</span> my_table;</span><br></pre></td></tr></table></figure><h3 id="查看分片的副本状态"><a href="#查看分片的副本状态" class="headerlink" title="查看分片的副本状态"></a>查看分片的副本状态</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN DIAGNOSE TABLET your_tablet_id;</span><br></pre></td></tr></table></figure><h3 id="查看分片里的副本具体信息"><a href="#查看分片里的副本具体信息" class="headerlink" title="查看分片里的副本具体信息"></a>查看分片里的副本具体信息</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLET tabletid</span><br><span class="line"></span><br><span class="line">## 该语句返回结果中，找到`detailCmd`字段 如下 ↓</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/dbs/10003/1790279/partitions/1790278/4404968/4405353&#x27;</span>;</span><br><span class="line"></span><br><span class="line">## 该语句返回字段中，有url链接，可以查看详细的分片信息</span><br><span class="line">## 该分片返回多少条，就代表有多少副本</span><br></pre></td></tr></table></figure><h3 id="查看副本修复的进度"><a href="#查看副本修复的进度" class="headerlink" title="查看副本修复的进度"></a>查看副本修复的进度</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/cluster_balance&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="查看集群的副本状态"><a href="#查看集群的副本状态" class="headerlink" title="查看集群的副本状态"></a>查看集群的副本状态</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/cluster_health/tablet_health&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/cluster_health/tablet_health/13402&#x27;</span>;</span><br><span class="line">## 其中 <span class="number">13402</span> 是副本的id</span><br></pre></td></tr></table></figure><h3 id="查看表里面指定分区的副本状态"><a href="#查看表里面指定分区的副本状态" class="headerlink" title="查看表里面指定分区的副本状态"></a>查看表里面指定分区的副本状态</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ADMIN <span class="keyword">SHOW</span> REPLICA STATUS <span class="keyword">FROM</span> tbl1 <span class="keyword">PARTITION</span> (p1, p2) <span class="keyword">WHERE</span> STATUS <span class="operator">=</span> &quot;OK&quot;;</span><br><span class="line"></span><br><span class="line">## 其中可以关注isBad那一字段，可以看到副本的状态</span><br></pre></td></tr></table></figure><h3 id="查看副本的集群分布"><a href="#查看副本的集群分布" class="headerlink" title="查看副本的集群分布"></a>查看副本的集群分布</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN <span class="keyword">SHOW</span> REPLICA DISTRIBUTION <span class="keyword">FROM</span> tbl1;</span><br></pre></td></tr></table></figure><h3 id="查看等待被调度的任务"><a href="#查看等待被调度的任务" class="headerlink" title="查看等待被调度的任务"></a>查看等待被调度的任务</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/cluster_balance/pending_tablets&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="修复副本的思路"><a href="#修复副本的思路" class="headerlink" title="修复副本的思路"></a>修复副本的思路</h2><blockquote><h2 id="总体来讲-当我们需要将集群快速恢复到正常状态时-可以考虑按照以下思路处理"><a href="#总体来讲-当我们需要将集群快速恢复到正常状态时-可以考虑按照以下思路处理" class="headerlink" title="总体来讲,当我们需要将集群快速恢复到正常状态时,可以考虑按照以下思路处理:"></a>总体来讲,当我们需要将集群快速恢复到正常状态时,可以考虑按照以下思路处理:</h2><p>1.找到导致高优任务报错的tablet,将有问题的副本置为bad。</p><p>2.通过admin repair语句高优修复某些表。</p><p>3.停止副本均衡逻辑以避免占用集群资源,等集群恢复后,再开启即可。</p><p>4.使用更保守的策略触发修复任务,以应对BE频繁宕机导致的雪崩效应。</p><p>5.按需关闭colocation表的调度任务,集中集群资源修复其他他高优数据。</p></blockquote><h3 id="设置副本的状态为-bad"><a href="#设置副本的状态为-bad" class="headerlink" title="设置副本的状态为 bad"></a>设置副本的状态为 <code>bad</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ADMIN <span class="keyword">SET</span> REPLICA STATUS PROPERTIES(&quot;tablet_id&quot; <span class="operator">=</span> &quot;4405353&quot;, &quot;backend_id&quot; <span class="operator">=</span> &quot;10010&quot;, &quot;status&quot; <span class="operator">=</span> &quot;bad&quot;);</span><br><span class="line">## 分片的id，be的id 需要在上面的语句执行结果中进行查找</span><br></pre></td></tr></table></figure><ul><li>设置为bad之后，Doris会自动进行修复</li><li>使用下面的语句可以查看Doris的修复进度</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/cluster_balance&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>修复完成后，可以使用下面的语句查看集群整体的副本的健康情况</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/cluster_health/tablet_health&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>手动修复（设置修复的优先级，让其先修复）</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN REPAIR <span class="keyword">TABLE</span> tbl [<span class="keyword">PARTITION</span> (p1, p2, ...)];</span><br></pre></td></tr></table></figure><ul><li>取消手动修复</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN CANCEL REPAIR <span class="keyword">TABLE</span> tbl [<span class="keyword">PARTITION</span> (p1, p2, ...)];</span><br></pre></td></tr></table></figure><h3 id="尝试从回收站中修复tablet"><a href="#尝试从回收站中修复tablet" class="headerlink" title="尝试从回收站中修复tablet"></a>尝试从回收站中修复tablet</h3><h4 id="http-请求方式"><a href="#http-请求方式" class="headerlink" title="http 请求方式"></a><font style="color:rgb(42, 47, 52);">http 请求方式</font></h4><p><font style="color:rgb(42, 47, 52);">BE 中提供单个 tablet 数据恢复的 http 接口，接口如下：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST <span class="string">&quot;http://be_host:be_webserver_port/api/restore_tablet?tablet_id=11111\&amp;schema_hash=12345&quot;</span></span><br></pre></td></tr></table></figure><p><font style="color:rgb(42, 47, 52);">成功的结果如下：</font></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Success&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;OK&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><font style="color:rgb(42, 47, 52);">失败的话，会返回相应的失败原因，一种可能的结果如下：</font></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Failed&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;create link path failed&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="脚本方式"><a href="#脚本方式" class="headerlink" title="脚本方式"></a><font style="color:rgb(42, 47, 52);">脚本方式</font></h4><p><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;restore_tablet_tool.sh&lt;/font&gt;</code><font style="color:rgb(42, 47, 52);"> </font><font style="color:rgb(42, 47, 52);">可用来实现单 tablet 数据恢复的功能。</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh tools/restore_tablet_tool.sh -b <span class="string">&quot;http://127.0.0.1:8040&quot;</span> -t 12345 -s 11111</span><br><span class="line">sh tools/restore_tablet_tool.sh --backend <span class="string">&quot;http://127.0.0.1:8040&quot;</span> --tablet_id 12345 --schema_hash 11111</span><br></pre></td></tr></table></figure><h3 id="修复缺失或损坏的-Tablet"><a href="#修复缺失或损坏的-Tablet" class="headerlink" title="修复缺失或损坏的 Tablet"></a><font style="color:rgb(29, 29, 29);">修复缺失或损坏的 Tablet</font></h3><h4 id="查看-Master-FE-日志-lt-font-style-quot-color-rgb-76-87-108-background-color-rgb-237-242-250-quot-gt-fe-log-lt-font-gt"><a href="#查看-Master-FE-日志-lt-font-style-quot-color-rgb-76-87-108-background-color-rgb-237-242-250-quot-gt-fe-log-lt-font-gt" class="headerlink" title="查看 Master FE 日志 &lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;fe.log&lt;/font&gt;"></a><font style="color:rgb(42, 47, 52);">查看 Master FE 日志 </font><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;fe.log&lt;/font&gt;</code></h4><p><font style="color:rgb(42, 47, 52);">如果出现数据丢失的情况，则日志中会有类似如下日志：</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">backend [10001] invalid situation. tablet[20000] has few replica[1], replica num setting is [3]</span><br></pre></td></tr></table></figure><p><font style="color:rgb(42, 47, 52);">这个日志表示，Tablet 20000 的所有副本已损坏或丢失。</font></p><h4 id="使用空白副本填补缺失副本"><a href="#使用空白副本填补缺失副本" class="headerlink" title="使用空白副本填补缺失副本"></a><font style="color:rgb(42, 47, 52);">使用空白副本填补缺失副本</font></h4><p><font style="color:rgb(42, 47, 52);">当确认数据已经无法恢复后，可以通过执行以下命令，生成空白副本。</font></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN SET FRONTEND CONFIG (<span class="string">&quot;recover_with_empty_tablet&quot;</span> = <span class="string">&quot;true&quot;</span>);</span><br></pre></td></tr></table></figure><pre><code>- &lt;font style=&quot;color:rgb(42, 47, 52);&quot;&gt;注：可以先通过&lt;/font&gt;&lt;font style=&quot;color:rgb(42, 47, 52);&quot;&gt; &lt;/font&gt;`&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;SHOW FRONTEND CONFIG;&lt;/font&gt;`&lt;font style=&quot;color:rgb(42, 47, 52);&quot;&gt; &lt;/font&gt;&lt;font style=&quot;color:rgb(42, 47, 52);&quot;&gt;命令查看当前版本是否支持该参数。&lt;/font&gt;</code></pre><h4 id="设置完成几分钟后，应该会在-Master-FE-日志-lt-font-style-quot-color-rgb-76-87-108-background-color-rgb-237-242-250-quot-gt-fe-log-lt-font-gt-中看到如下日志："><a href="#设置完成几分钟后，应该会在-Master-FE-日志-lt-font-style-quot-color-rgb-76-87-108-background-color-rgb-237-242-250-quot-gt-fe-log-lt-font-gt-中看到如下日志：" class="headerlink" title="设置完成几分钟后，应该会在 Master FE 日志 &lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;fe.log&lt;/font&gt; 中看到如下日志："></a><font style="color:rgb(42, 47, 52);">设置完成几分钟后，应该会在 Master FE 日志 </font><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;fe.log&lt;/font&gt;</code><font style="color:rgb(42, 47, 52);"> 中看到如下日志：</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tablet 20000 has only one replica 20001 on backend 10001 and it is lost. create an empty replica to recover it.</span><br></pre></td></tr></table></figure><p><font style="color:rgb(42, 47, 52);">该日志表示系统已经创建了一个空白 Tablet 用于填补缺失副本。</font></p><h4 id="通过查询来判断是否已经修复成功。"><a href="#通过查询来判断是否已经修复成功。" class="headerlink" title="通过查询来判断是否已经修复成功。"></a><font style="color:rgb(42, 47, 52);">通过查询来判断是否已经修复成功。</font></h4><h4 id="全部修复成功后，通过以下命令关闭-lt-font-style-quot-color-rgb-76-87-108-background-color-rgb-237-242-250-quot-gt-recover-with-empty-tablet-lt-font-gt-参数："><a href="#全部修复成功后，通过以下命令关闭-lt-font-style-quot-color-rgb-76-87-108-background-color-rgb-237-242-250-quot-gt-recover-with-empty-tablet-lt-font-gt-参数：" class="headerlink" title="全部修复成功后，通过以下命令关闭 &lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;recover_with_empty_tablet&lt;/font&gt; 参数："></a><font style="color:rgb(42, 47, 52);">全部修复成功后，通过以下命令关闭 </font><code>&lt;font style=&quot;color:rgb(76, 87, 108);background-color:rgb(237, 242, 250);&quot;&gt;recover_with_empty_tablet&lt;/font&gt;</code><font style="color:rgb(42, 47, 52);"> 参数：</font></h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADMIN SET FRONTEND CONFIG (<span class="string">&quot;recover_with_empty_tablet&quot;</span> = <span class="string">&quot;false&quot;</span>);</span><br></pre></td></tr></table></figure><p>如果使用以上方法进行副本修复，还未成功，或者是Mater FE 显示报错日志则需要进行删除数据，重新写入数据</p><p>原因为该分区里面只有一个副本，无法将该副本重新填充覆盖</p><blockquote><p><strong><font style="color:rgb(5, 7, 59);">publish version failed for transaction TransactionState. transaction id: 67607743, label: yfzaFUlqpNhvdrY76Dq-4000, db id: 10003, table id list: 1790279, callback id: -1, coordinator: BE: xxx.xxx.xxx.xxx, transaction status: COMMITTED, error replicas num: 0, replica ids: , prepare time: 1729052940470, commit time: 1729052947271, finish time: -1, reason: on tablet tabletId&#x3D;4405353, with only 0 replicas less than quorum 1</font></strong></p></blockquote><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Doris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Doris索引小总结</title>
      <link href="/2024/04/23/Doris%E7%B4%A2%E5%BC%95%E5%B0%8F%E6%80%BB%E7%BB%93/"/>
      <url>/2024/04/23/Doris%E7%B4%A2%E5%BC%95%E5%B0%8F%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>在Doris中，添加索引是提升查询性能的重要手段。Doris支持两种类型的索引：内置智能索引和用户创建的二级索引。以下是关于如何在Doris中添加索引的详细步骤和注意事项：</p><h3 id="内置智能索引"><a href="#内置智能索引" class="headerlink" title="内置智能索引"></a>内置智能索引</h3><ol><li><strong>前缀索引</strong>：<ul><li>基于排序键以有序的方式存储数据，为每1024行数据创建一个前缀索引。</li><li>索引中的键是当前1024行组的第一行中已排序列的值。</li><li>查询时，通过前缀索引可以快速定位到相关的1024行组，并从那里开始扫描。</li><li>特别注意：Doris只有前36个字节能走前缀索引。因此，在创建表时，需要手动指定key，并且索引字段的类型和长度要尽可能精确，以增大索引范围。</li></ul></li><li><strong>ZoneMap索引</strong>：<ul><li>在列存格式上，对每一列自动维护的索引信息，包括Min&#x2F;Max值、null值个数等。</li><li>查询时，会根据范围条件过滤的字段按照ZoneMap统计信息选取扫描的数据范围。</li><li>ZoneMap索引对用户是透明的，无需额外操作。</li></ul></li></ol><h3 id="用户创建的二级索引"><a href="#用户创建的二级索引" class="headerlink" title="用户创建的二级索引"></a>用户创建的二级索引</h3><ol><li><strong>倒排索引</strong>：<ul><li>用于文本类型的全文检索和普通数值日期类型的等值范围查询。</li><li>可以从海量数据中快速过滤出满足条件的行。</li><li>不同数据模型下的创建规则：<ul><li>Aggregate KEY表模型：只能为Key列建立倒排索引。</li><li>Unique KEY表模型：需要开启merge on write特性后，可以为任意列建立倒排索引。</li><li>Duplicate KEY表模型：可以为任意列建立倒排索引。</li></ul></li></ul></li><li><strong>BloomFilter索引</strong>：<ul><li>一种高空间效率的概率数据结构，用于检查元素是否在集合中。</li><li>适用于高基数（5000以上）列上的等值查询场景。</li><li>创建方式：在表创建语句的PROPERTIES中添加”bloom_filter_columns”&#x3D;”k1,k2,k3”，其中k1,k2,k3为要创建BloomFilter索引的关键列名称。</li></ul></li><li><strong>NGram BloomFilter索引</strong>：<ul><li>为了提升LIKE的查询性能。</li><li>适用于亿级别以上数据，且只有模糊匹配需求时使用。</li><li>只支持字符串列，且和BloomFilter索引为互斥关系，即同一个列只能设置两者中的一个。</li></ul></li><li><strong>Bitmap索引</strong>：<ul><li>能够应用在Duplicate、Unique数据模型的所有列和Aggregate模型的key列上。</li><li>仅在Segment V2下生效，创建索引时表的存储格式将默认转换为V2格式。</li><li>适用于低基数的列上（建议在100到100,000之间），如职业、地市等。</li><li>特定类型的查询（如COUNT、OR、AND等逻辑操作）因为只需要进行位运算，所以更适合使用Bitmap索引。</li></ul></li></ol><hr><h3 id="添加索引"><a href="#添加索引" class="headerlink" title="添加索引"></a>添加索引</h3><h5 id="BloomFilter索引"><a href="#BloomFilter索引" class="headerlink" title="BloomFilter索引"></a>BloomFilter索引</h5><p>（全版本适用）</p><ul><li>创建表时添加索引</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PROPERTIES (<span class="string">&quot;bloom_filter_columns&quot;</span>=<span class="string">&quot;saler_id,category_id&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>修改表时添加索引</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE ods_test_bloom_delta SET (<span class="string">&quot;bloom_filter_columns&quot;</span> = <span class="string">&quot;city_org_code&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>查看索引</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE TABLE example_db.example_bloom_index_tbl;</span><br></pre></td></tr></table></figure><ul><li>删除索引</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE ods_test_bloom_delta SET (<span class="string">&quot;bloom_filter_columns&quot;</span> = <span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>BloomFilter索引的注意事项<ol><li><strong>适用场景</strong>：<br>BloomFilter索引适用于高基数列的等值查询场景，如用户ID、商品ID等。对于低基数列（如性别、状态等），由于每个数据块几乎都会包含所有取值，因此BloomFilter索引的加速效果有限。</li><li><strong>数据类型限制</strong>：<br>目前Doris不支持对Tinyint、Float、Double类型的列创建BloomFilter索引。</li><li><strong>性能权衡</strong>：<br>虽然BloomFilter索引能够提升查询性能，但也会增加写入和更新的开销。因此，在创建索引时需要权衡性能提升和存储开销之间的平衡。</li><li><strong>查询优化</strong>：<br>在查询时，Doris会自动选择是否使用BloomFilter索引。如果希望查看某个查询是否命中了BloomFilter索引，可以通过查询的Profile信息来确认。</li></ol></li></ul><p>1. </p><h5 id="Bitmap索引"><a href="#Bitmap索引" class="headerlink" title="Bitmap索引"></a><font style="color:rgb(29, 29, 29);">Bitmap索引</font></h5><p>（该索引适用于1.2版本）</p><ul><li><font style="color:rgb(42, 47, 52);">bitmap index：位图索引，是一种快速数据结构，能够加快查询速度</font></li><li><font style="color:rgb(42, 47, 52);">创建索引：</font></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX [IF NOT EXISTS] index_name ON table1 (siteid) USING BITMAP COMMENT <span class="string">&#x27;balabala&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li><font style="color:rgb(42, 47, 52);">查看索引：</font></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW INDEX FROM example_db.table_name;</span><br></pre></td></tr></table></figure><ul><li><font style="color:rgb(42, 47, 52);">删除索引：</font></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX [IF EXISTS] index_name ON [db_name.]table_name;</span><br></pre></td></tr></table></figure><h5 id="倒排索引"><a href="#倒排索引" class="headerlink" title="倒排索引"></a><font style="color:rgb(29, 29, 29);">倒排索引</font></h5><p>（2.0版本以上适用）</p><ul><li>可用于进行文本类型的全文索引，以及普通数值<font style="color:rgb(42, 47, 52);">日期类型的等值范围查询</font></li><li><font style="color:rgb(42, 47, 52);">建表的时候建索引：</font></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE table_name</span><br><span class="line">(</span><br><span class="line">  column_name1 TYPE1,</span><br><span class="line">  column_name2 TYPE2,</span><br><span class="line">  column_name3 TYPE3,</span><br><span class="line">  INDEX idx_name1(column_name1) USING INVERTED [PROPERTIES(...)] [COMMENT <span class="string">&#x27;your comment&#x27;</span>],</span><br><span class="line">  INDEX idx_name2(column_name2) USING INVERTED [PROPERTIES(...)] [COMMENT <span class="string">&#x27;your comment&#x27;</span>]</span><br><span class="line">)</span><br><span class="line">table_properties;</span><br></pre></td></tr></table></figure><ol><li><code>idx_column_name(column_name)</code> 是必须的，<code>column_name</code> 是建索引的列名，必须是前面列定义中出现过的，<code>idx_column_name</code> 是索引名字，必须表级别唯一，建议命名规范：列名前面加前缀 <code>idx_</code></li><li><code>USING INVERTED</code> 是必须的，用于指定索引类型是倒排索引</li><li><code>PROPERTIES</code> 是可选的，用于指定倒排索引的额外属性，目前支持的属性如下：</li></ol><details class="lake-collapse"><summary id="u5223fe10"><span class="ne-text" style="background-color: rgb(238, 249, 253); font-size: 16px">parser 指定分词器</span></summary><ul class="ne-ul"><li id="u395f2e55" data-lake-index-type="0"><span class="ne-text">默认不指定代表不分词</span></li><li id="udce606be" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">english</span></code><span class="ne-text"> 是英文分词，适合被索引列是英文的情况，用空格和标点符号分词，性能高</span></li><li id="uac2b6d4e" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">chinese</span></code><span class="ne-text"> 是中文分词，适合被索引列主要是中文的情况，性能比 English 分词低</span></li><li id="ubf4f123b" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">unicode</span></code><span class="ne-text"> 是多语言混合类型分词，适用于中英文混合、多语言混合的情况。它能够对邮箱前缀和后缀、IP 地址以及字符数字混合进行分词，并且可以对中文按字符分词。</span></li></ul></details><details class="lake-collapse"><summary id="u9c40f6a7"><span class="ne-text" style="background-color: rgb(238, 249, 253); font-size: 16px">parser_mode</span></summary><ul class="ne-ul"><li id="u3372205b" data-lake-index-type="0"><span class="ne-text">用于指定分词的模式，目前 parser = chinese 时支持如下几种模式：</span></li><li id="u33e7d639" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">fine_grained</span></code><span class="ne-text">：细粒度模式，倾向于分出比较短、较多的词，比如 '武汉市长江大桥' 会分成 '武汉', '武汉市', '市长', '长江', '长江大桥', '大桥' 6 个词</span></li><li id="uf3cd26d4" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">coarse_grained</span></code><span class="ne-text">：粗粒度模式，倾向于分出比较长、较少的词，，比如 '武汉市长江大桥' 会分成 '武汉市' '长江大桥' 2 个词</span></li><li id="u90a5a5ae" data-lake-index-type="0"><span class="ne-text">默认 </span><code class="ne-code"><span class="ne-text">coarse_grained</span></code></li></ul></details><details class="lake-collapse"><summary id="ubab2f76d"><span class="ne-text" style="background-color: rgb(238, 249, 253); font-size: 16px">support_phrase</span></summary><ul class="ne-ul"><li id="u1fc8275e" data-lake-index-type="0"><span class="ne-text">用于指定索引是否支持 MATCH_PHRASE 短语查询加速</span></li><li id="ua06f46f3" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">true</span></code><span class="ne-text"> 为支持，但是索引需要更多的存储空间</span></li><li id="u85d98b4a" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">false</span></code><span class="ne-text"> 为不支持，更省存储空间，可以用 MATCH_ALL 查询多个关键字</span></li><li id="u6675a685" data-lake-index-type="0"><span class="ne-text">默认 </span><code class="ne-code"><span class="ne-text">false</span></code></li></ul><p id="u6479496b" class="ne-p"><span class="ne-text">例如下面的例子指定中文分词，粗粒度模式，支持短语查询加速</span></p><pre data-language="sql" id="UrvyK" class="ne-codeblock language-sql"><code>INDEX idx_name(column_name) USING INVERTED PROPERTIES(&quot;parser&quot; = &quot;chinese&quot;, &quot;parser_mode&quot; = &quot;coarse_grained&quot;, &quot;support_phrase&quot; = &quot;true&quot;)</code></pre></details><details class="lake-collapse"><summary id="u3ec7d1b2"><span class="ne-text" style="background-color: rgb(238, 249, 253); font-size: 16px">char_filter</span></summary><ul class="ne-ul"><li id="ud30e428a" data-lake-index-type="0"><span class="ne-text">用于指定在分词前对文本进行预处理，通常用于影响分词行为</span></li><li id="udd6b4842" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">char_filter_type</span></code><span class="ne-text">：指定使用不同功能的 char_filter（目前仅支持 char_replace）</span></li><li id="u4f6cd0ce" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">char_replace</span></code><span class="ne-text"> 将 pattern 中每个 char 替换为一个 replacement 中的 char</span></li></ul><ul class="ne-ul"><li id="u954f6d2c" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">char_filter_pattern</span></code><span class="ne-text">：需要被替换掉的字符数</span></li><li id="u474c9fc9" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">char_filter_replacement</span></code><span class="ne-text">：替换后的字符数组，可以不用配置，默认为一个空格字符</span></li></ul><p id="u51fb42b8" class="ne-p"><span class="ne-text">例如下面的例子将点和下划线替换成空格，达到将点和下划线作为单词分隔符的目的，影响分词行为。</span></p><pre data-language="sql" id="dF7J9" class="ne-codeblock language-sql"><code>INDEX idx_name(column_name) USING INVERTED PROPERTIES(&quot;parser&quot; = &quot;unicode&quot;, &quot;char_filter_type&quot; = &quot;char_replace&quot;, &quot;char_filter_pattern&quot; = &quot;._&quot;, &quot;char_filter_replacement&quot; = &quot; &quot;)</code></pre></details><details class="lake-collapse"><summary id="ub5c4f7a4"><span class="ne-text" style="background-color: rgb(238, 249, 253); font-size: 16px">ignore_above</span></summary><ul class="ne-ul"><li id="ud2f7eb11" data-lake-index-type="0"><span class="ne-text">用于指定不分词字符串索引（没有指定parser）的长度限制</span></li><li id="u6a5a4669" data-lake-index-type="0"><span class="ne-text">长度超过 </span><code class="ne-code"><span class="ne-text">ignore_above</span></code><span class="ne-text"> 设置的字符串不会被索引。对于字符串数组，ignore_above 将分别应用于每个数组元素，长度超过 ignore_above 的字符串元素将不被索引。</span></li><li id="u1715c381" data-lake-index-type="0"><span class="ne-text">默认为 256，单位是字节</span></li></ul></details><details class="lake-collapse"><summary id="u3e0af09b"><span class="ne-text" style="background-color: rgb(238, 249, 253); font-size: 16px">lower_case</span></summary><ul class="ne-ul"><li id="u25f8b77d" data-lake-index-type="0"><span class="ne-text">是否将分词进行小写转换，从而在匹配的时候实现忽略大小写</span></li><li id="u2857ddf3" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">true</span></code><span class="ne-text">: 转换小写</span></li><li id="u734e63b4" data-lake-index-type="0"><code class="ne-code"><span class="ne-text">false</span></code><span class="ne-text">：不转换小写</span></li><li id="ubaaef888" data-lake-index-type="0"><span class="ne-text">从 2.1.2 版本开始默认为 true，自动转小写，之前的版本默认为 false</span></li></ul></details>+ 添加倒排索引<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法 1</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_name <span class="keyword">ON</span> table_name(column_name) <span class="keyword">USING</span> INVERTED [PROPERTIES(...)] [COMMENT <span class="string">&#x27;your comment&#x27;</span>];</span><br><span class="line"><span class="comment">-- 语法 2</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ADD</span> INDEX idx_name(column_name) <span class="keyword">USING</span> INVERTED [PROPERTIES(...)] [COMMENT <span class="string">&#x27;your comment&#x27;</span>];</span><br></pre></td></tr></table></figure><ul><li>构建倒排索引</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法 1，默认给全表的所有分区 BUILD INDEX</span></span><br><span class="line">BUILD INDEX index_name <span class="keyword">ON</span> table_name;</span><br><span class="line"><span class="comment">-- 语法 2，可指定 Partition，可指定一个或多个</span></span><br><span class="line">BUILD INDEX index_name <span class="keyword">ON</span> table_name PARTITIONS(partition_name1, partition_name2);</span><br></pre></td></tr></table></figure><ul><li>查看构建速度</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> BUILD INDEX [<span class="keyword">FROM</span> db_name];</span><br><span class="line"><span class="comment">-- 示例 1，查看所有的 BUILD INDEX 任务进展</span></span><br><span class="line"><span class="keyword">SHOW</span> BUILD INDEX;</span><br><span class="line"><span class="comment">-- 示例 2，查看指定 table 的 BUILD INDEX 任务进展</span></span><br><span class="line"><span class="keyword">SHOW</span> BUILD INDEX <span class="keyword">where</span> TableName <span class="operator">=</span> &quot;table1&quot;;</span><br></pre></td></tr></table></figure><ul><li>删除倒排索引</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法 1</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_name <span class="keyword">ON</span> table_name;</span><br><span class="line"><span class="comment">-- 语法 2</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> INDEX idx_name;</span><br></pre></td></tr></table></figure><ul><li>加速查询的例子</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 全文检索关键词匹配，通过 MATCH_ANY MATCH_ALL 完成</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_name MATCH_ANY <span class="operator">|</span> MATCH_ALL <span class="string">&#x27;keyword1 ...&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.1 content 列中包含 keyword1 的行</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_ANY <span class="string">&#x27;keyword1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.2 content 列中包含 keyword1 或者 keyword2 的行，后面还可以添加多个 keyword</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_ANY <span class="string">&#x27;keyword1 keyword2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.3 content 列中同时包含 keyword1 和 keyword2 的行，后面还可以添加多个 keyword</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_ALL <span class="string">&#x27;keyword1 keyword2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 全文检索短语匹配，通过 MATCH_PHRASE 完成</span></span><br><span class="line"><span class="comment">-- 2.1 content 列中同时包含 keyword1 和 keyword2 的行，而且 keyword2 必须紧跟在 keyword1 后面</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 keyword2&#x27;，&#x27;wordx keyword1 keyword2&#x27;，&#x27;wordx keyword1 keyword2 wordy&#x27; 能匹配，因为他们都包含keyword1 keyword2，而且keyword2 紧跟在 keyword1 后面</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 wordx keyword2&#x27; 不能匹配，因为 keyword1 keyword2 之间隔了一个词 wordx</span></span><br><span class="line"><span class="comment">-- &#x27;keyword2 keyword1&#x27;，因为 keyword1 keyword2 的顺序反了</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_PHRASE <span class="string">&#x27;keyword1 keyword2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.2 content 列中同时包含 keyword1 和 keyword2 的行，而且 keyword1 keyword2 的 `词距`（slop） 不超过3</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 keyword2&#x27;, &#x27;keyword1 a keyword2&#x27;, &#x27;keyword1 a b c keyword2&#x27; 都能匹配，因为keyword1 keyword2中间隔的词分别是0 1 3 都不超过3</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 a b c d keyword2&#x27; 不能能匹配，因为keyword1 keyword2中间隔的词有4个，超过3</span></span><br><span class="line"><span class="comment">-- &#x27;keyword2 keyword1&#x27;, &#x27;keyword2 a keyword1&#x27;, &#x27;keyword2 a b c keyword1&#x27; 也能匹配，因为指定 slop &gt; 0 时不再要求keyword1 keyword2 的顺序。这个行为参考了 ES，与直觉的预期不一样，因此 Doris 提供了在 slop 后面指定正数符号（+）表示需要保持 keyword1 keyword2 的先后顺序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_PHRASE <span class="string">&#x27;keyword1 keyword2 ~3&#x27;</span>;</span><br><span class="line"><span class="comment">-- slop 指定正号，&#x27;keyword1 a b c keyword2&#x27; 能匹配，而 &#x27;keyword2 a b c keyword1&#x27; 不能匹配</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_PHRASE <span class="string">&#x27;keyword1 keyword2 ~3+&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.3 在保持词顺序的前提下，对最后一个词keyword2做前缀匹配，默认找50个前缀词（session变量inverted_index_max_expansions控制）</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 keyword2abc&#x27; 能匹配，因为keyword1完全一样，最后一个 keyword2abc 是 keyword2 的前缀</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 keyword2&#x27; 也能匹配，因为 keyword2 也是 keyword2 的前缀</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 keyword3&#x27; 不能匹配，因为 keyword3 不是 keyword2 的前缀</span></span><br><span class="line"><span class="comment">-- &#x27;keyword1 keyword3abc&#x27; 也不能匹配，因为 keyword3abc 也不是 keyword2 的前缀</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_PHRASE_PREFIX <span class="string">&#x27;keyword1 keyword2&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.4 如果只填一个词会退化为前缀查询，默认找50个前缀词（session变量inverted_index_max_expansions控制）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_PHRASE_PREFIX <span class="string">&#x27;keyword1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.5 对分词后的词进行正则匹配，默认匹配50个（session变量inverted_index_max_expansions控制）</span></span><br><span class="line"><span class="comment">-- 类似 MATCH_PHRASE_PREFIX 的匹配规则，只是前缀变成了正则</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> content MATCH_REGEXP <span class="string">&#x27;key*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 普通等值、范围、IN、NOT IN，正常的 SQL 语句即可，例如</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">123</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> ts <span class="operator">&gt;</span> <span class="string">&#x27;2023-01-01 00:00:00&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> op_type <span class="keyword">IN</span> (<span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>在创建索引时，需要根据实际的查询需求和数据特点来选择合适的索引类型。</li><li>索引虽然可以提升查询性能，但也会增加写入和更新的开销。因此，需要在性能和写入效率之间做出权衡。</li><li>定期监控索引的使用情况和性能表现，根据需要进行调整和优化。</li></ul><p>总之，在Doris中添加索引是一个复杂但重要的过程，需要根据具体的场景和需求来选择合适的索引类型和创建方式。通过合理的索引设计，可以显著提升查询性能并优化数据库的整体表现。</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Doris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop与hive版本对应</title>
      <link href="/2024/04/23/Hadoop%E4%B8%8Ehive%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94/"/>
      <url>/2024/04/23/Hadoop%E4%B8%8Ehive%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94/</url>
      
        <content type="html"><![CDATA[<blockquote><p> <a href="https://blog.csdn.net/qq_33772352/article/details/132234919">https://blog.csdn.net/qq_33772352&#x2F;article&#x2F;details&#x2F;132234919</a></p></blockquote><h3 id="Hadoop与Hbase版本对应"><a href="#Hadoop与Hbase版本对应" class="headerlink" title="Hadoop与Hbase版本对应"></a>Hadoop与Hbase版本对应</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732957998405-aaf8a889-67ba-438f-a4cf-4541c109e18f.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958007034-b6ade2ee-6fe2-4055-a657-79282a492125.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958016425-8c854ab7-be7b-403e-8aee-1692c27ac767.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958025850-658d2aa2-4722-418f-bee1-4d5281d13c2d.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958037786-90d6e842-a4a4-4be7-9e72-0d69e21113d7.png"></p><hr><h3 id="Hadoop与Hive版本对应"><a href="#Hadoop与Hive版本对应" class="headerlink" title="Hadoop与Hive版本对应"></a>Hadoop与Hive版本对应</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958090385-0669bd00-832e-4aaa-ac46-7036b67ed001.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958103298-02e53f77-2e2c-4efd-9611-a7d9b466a3e8.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/34758360/1732958110079-93e247ca-8609-494b-bdac-0febae780511.png"></p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>G2图使用-创建简单的柱状图</title>
      <link href="/2024/04/23/G2%E5%9B%BE%E4%BD%BF%E7%94%A8-%E5%88%9B%E5%BB%BA%E7%AE%80%E5%8D%95%E7%9A%84%E6%9F%B1%E7%8A%B6%E5%9B%BE/"/>
      <url>/2024/04/23/G2%E5%9B%BE%E4%BD%BF%E7%94%A8-%E5%88%9B%E5%BB%BA%E7%AE%80%E5%8D%95%E7%9A%84%E6%9F%B1%E7%8A%B6%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>g2plot 是一套简单、易用、并具备一定扩展能力和组合能力的统计图表库，基于图形语法理论搭建而成，”g2plot”中的 g2 即意指图形语法 (the Gramma of Graphics)，同时也致敬了 ggplot2。</p></blockquote><p>下面是一个简单的是用例子</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;chartRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; onMounted, ref, defineProps, toRefs &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">Chart</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@antv/g2&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123; <span class="attr">config</span>: <span class="title class_">Object</span> &#125;)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> &#123; config &#125; = <span class="title function_">toRefs</span>(props)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> chartRef = <span class="title function_">ref</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">initChart</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> chart = <span class="keyword">new</span> <span class="title class_">Chart</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    ...config.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">container</span>: chartRef.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">autoFit</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">forceFit</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">  chart</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// .theme(&#123; type: &#x27;classicDark&#x27; &#125;)</span></span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">title</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">title</span>: <span class="string">`月<span class="subst">$&#123;<span class="variable language_">window</span>.CONFIG.systemName&#125;</span>分析`</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// subtitle: &#x27;world&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">interval</span>()</span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">data</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&#x27;fetch&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">value</span>: <span class="string">&#x27;/api/hdfs/read-csv?path=/output/hdfsJobByMonth/part-r-00000&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">format</span>: <span class="string">&#x27;csv&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 如果是csv文件，则自动判断数据类型</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">autoType</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">transform</span>: [</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// &#123;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//   type: &#x27;log&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// &#125;,</span></span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&#x27;map&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">callback</span>: <span class="function">(<span class="params">val</span>) =&gt;</span> &#123; val[<span class="string">&#x27;年月&#x27;</span>] = val[<span class="string">&#x27;时间&#x27;</span>] + <span class="string">&#x27;月&#x27;</span>; <span class="keyword">return</span> val; &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&#x27;sortBy&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fields</span>: [<span class="string">&#x27;时间&#x27;</span>], <span class="comment">// 根据 sold 字段排序</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// fold 这是生成一个key value 的map</span></span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&#x27;fold&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">fields</span>: <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">dataHeader</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">key</span>: <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartX</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">value</span>: <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartY</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">encode</span>(<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;年月&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">encode</span>(<span class="string">&#x27;y&#x27;</span>, <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartY</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// dodgeX 生成 series 通道值为 color 通道的值，根据 series 通道实现分组效果</span></span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">transform</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;dodgeX&#x27;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 根据 window.CONFIG.chartX 颜色进行区分，如果不加，则显示全部数据颜色固定</span></span></span><br><span class="line"><span class="language-javascript">    .<span class="title function_">encode</span>(<span class="string">&#x27;color&#x27;</span>, <span class="variable language_">window</span>.<span class="property">CONFIG</span>.<span class="property">chartX</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// .encode(&#x27;shape&#x27;, &#x27;hv&#x27;)</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// .scale(&#x27;x&#x27;, &#123;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//     range: [0, 1],</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// &#125;)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// .scale(&#x27;y&#x27;, &#123;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//     nice: true,</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// &#125;)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// .axis(&#x27;x&#x27;, &#123; title: null, line: true, tick: true &#125;)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// .axis(&#x27;y&#x27;, &#123; </span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//   title: null, </span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//   line: true, </span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// &#125;)</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// chart.line()</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// // chart.line().encode(&#x27;shape&#x27;, &#x27;smooth&#x27;);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// chart.point().encode(&#x27;shape&#x27;, &#x27;point&#x27;).tooltip(false);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  chart.<span class="title function_">render</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> chart;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(chartRef.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">initChart</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其中需要注意的是： <em>.encode(‘color’, window.CONFIG.chartX)</em> 用来实现的是图例，图例的内容为 window.CONFIG.chartX ，其中color 可以进行变化</p><p>因为 <em>prop</em> 接受了主题的配置，所有的颜色都会根据主题的index.js进行变化</p><hr><p>另外 <em>fetch</em> 通过拉取 hdfs 中算好的 csv 文件来获得值，里面的 <em>transform</em> 对值进行转换，其中 <em>type fold</em> 能生成一个 <em>key value</em> 的map</p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> G2 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop安装和启用</title>
      <link href="/2024/04/23/Hadoop%E5%AE%89%E8%A3%85%E5%92%8C%E5%90%AF%E7%94%A8/"/>
      <url>/2024/04/23/Hadoop%E5%AE%89%E8%A3%85%E5%92%8C%E5%90%AF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="Hadoop简介"><a href="#Hadoop简介" class="headerlink" title="Hadoop简介"></a>Hadoop简介</h2><p>Hadoop是Apache软件基金会的一个开源分布式计算平台，主要由HDFS（分布式文件系统）、MapReduce（分布式计算框架）和YARN（资源管理系统）三个核心组件构成。它允许使用简单的编程模型在由多台计算机组成的大型集群上分布式处理大数据集。Hadoop具有高可靠性、高扩展性、高容错性和高效性等特点，已成为大数据处理的标准平台。</p><h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><p>在安装Hadoop之前，请确保：</p><ol><li>已安装JDK（推荐JDK 8或更高版本）</li><li>配置了SSH无密码登录（对于集群环境）</li><li>分配了足够的系统资源（内存、存储空间）</li></ol><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><h3 id="设置Hadoop环境变量"><a href="#设置Hadoop环境变量" class="headerlink" title="设置Hadoop环境变量"></a>设置Hadoop环境变量</h3><p>环境变量配置是使用Hadoop的第一步，它使系统能够找到Hadoop的可执行文件和库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑~/.bashrc或/etc/profile文件</span></span><br><span class="line">vim ~/.bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加以下内容</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/soft/hadoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使配置生效</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p><strong>说明</strong>：</p><ul><li><code>HADOOP_HOME</code>指向Hadoop的安装目录</li><li>将Hadoop的bin和sbin目录添加到PATH中，使命令可以直接执行</li><li>根据实际安装路径调整<code>/soft/hadoop</code></li></ul><h2 id="Hadoop启动流程"><a href="#Hadoop启动流程" class="headerlink" title="Hadoop启动流程"></a>Hadoop启动流程</h2><h3 id="1-启动HDFS"><a href="#1-启动HDFS" class="headerlink" title="1. 启动HDFS"></a>1. 启动HDFS</h3><p>HDFS（Hadoop分布式文件系统）是Hadoop的存储层，需要首先启动。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在Hadoop的安装目录下执行</span></span><br><span class="line">sbin/start-dfs.sh</span><br></pre></td></tr></table></figure><p><strong>启动过程</strong>：</p><ol><li>启动NameNode（主节点）</li><li>启动DataNode（数据节点）</li><li>启动Secondary NameNode（辅助名称节点）</li></ol><p><strong>验证HDFS启动成功</strong>：</p><p>执行<code>jps</code>命令，应该能看到以下进程：</p><ul><li>NameNode</li><li>DataNode</li><li>SecondaryNameNode</li></ul><p><img src="/img/posts/933d077ea71ce76f6eeb8261ff01e19d.png" alt="HDFS进程验证"></p><p>也可以通过Web界面访问HDFS：<code>http://localhost:9870</code></p><h3 id="2-启动YARN"><a href="#2-启动YARN" class="headerlink" title="2. 启动YARN"></a>2. 启动YARN</h3><p>YARN（Yet Another Resource Negotiator）是Hadoop的资源管理和作业调度系统。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在Hadoop的安装目录下执行</span></span><br><span class="line">sbin/start-yarn.sh</span><br></pre></td></tr></table></figure><p><strong>启动过程</strong>：</p><ol><li>启动ResourceManager（资源管理器）</li><li>启动NodeManager（节点管理器）</li></ol><p><strong>验证YARN启动成功</strong>：</p><p>执行<code>jps</code>命令，应该能看到以下额外进程：</p><ul><li>ResourceManager</li><li>NodeManager</li></ul><p><img src="/img/posts/ae50a01f9413b302a81f567c83bb0a3f.png" alt="YARN进程验证"></p><p>可以通过Web界面访问YARN：<code>http://localhost:8088</code></p><h2 id="Spark与Hadoop集成"><a href="#Spark与Hadoop集成" class="headerlink" title="Spark与Hadoop集成"></a>Spark与Hadoop集成</h2><p>Apache Spark是一个快速的分布式计算框架，可以与Hadoop集成使用，利用HDFS存储数据，并通过YARN管理资源。</p><h3 id="启动Spark"><a href="#启动Spark" class="headerlink" title="启动Spark"></a>启动Spark</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在Spark的安装目录下执行</span></span><br><span class="line">./sbin/start-all.sh</span><br></pre></td></tr></table></figure><p><strong>说明</strong>：</p><ul><li>这将启动Spark的Master和Worker节点</li><li>如果配置了与YARN集成，Spark应用将通过YARN调度</li></ul><p><strong>验证Spark启动成功</strong>：</p><ul><li>执行<code>jps</code>命令，应该能看到Master和Worker进程</li><li>访问Spark Web UI：<code>http://localhost:8080</code></li></ul><h2 id="常用操作命令"><a href="#常用操作命令" class="headerlink" title="常用操作命令"></a>常用操作命令</h2><h3 id="HDFS文件操作"><a href="#HDFS文件操作" class="headerlink" title="HDFS文件操作"></a>HDFS文件操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看HDFS根目录</span></span><br><span class="line">hdfs dfs -<span class="built_in">ls</span> /</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建目录</span></span><br><span class="line">hdfs dfs -<span class="built_in">mkdir</span> /user</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上传文件</span></span><br><span class="line">hdfs dfs -put localfile.txt /user/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载文件</span></span><br><span class="line">hdfs dfs -get /user/file.txt ./</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件内容</span></span><br><span class="line">hdfs dfs -<span class="built_in">cat</span> /user/file.txt</span><br></pre></td></tr></table></figure><h3 id="YARN作业管理"><a href="#YARN作业管理" class="headerlink" title="YARN作业管理"></a>YARN作业管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看应用列表</span></span><br><span class="line">yarn application -list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看应用状态</span></span><br><span class="line">yarn application -status application_id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死应用</span></span><br><span class="line">yarn application -<span class="built_in">kill</span> application_id</span><br></pre></td></tr></table></figure><h2 id="故障排除"><a href="#故障排除" class="headerlink" title="故障排除"></a>故障排除</h2><h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><ol><li><p><strong>启动失败</strong>：</p><ul><li>检查日志文件（logs目录下）</li><li>确保端口未被占用</li><li>验证权限设置</li></ul></li><li><p><strong>节点未启动</strong>：</p><ul><li>检查SSH配置</li><li>验证hosts文件配置</li><li>检查防火墙设置</li></ul></li><li><p><strong>Web界面无法访问</strong>：</p><ul><li>确认服务已启动</li><li>检查网络连接</li><li>验证防火墙规则</li></ul></li></ol><h2 id="完整启动流程"><a href="#完整启动流程" class="headerlink" title="完整启动流程"></a>完整启动流程</h2><p>对于生产环境，建议按以下顺序启动Hadoop生态系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 启动HDFS</span></span><br><span class="line">sbin/start-dfs.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 启动YARN</span></span><br><span class="line">sbin/start-yarn.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 启动历史服务器（可选）</span></span><br><span class="line">mapred --daemon start historyserver</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 启动Spark（如果需要）</span></span><br><span class="line"><span class="built_in">cd</span> /path/to/spark</span><br><span class="line">./sbin/start-all.sh</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>正确配置和启动Hadoop是大数据处理的基础。通过本文的步骤，您应该能够成功设置Hadoop环境变量并启动Hadoop的核心服务（HDFS和YARN）以及Spark。记得定期检查日志文件以确保系统正常运行，并根据需要调整配置参数以优化性能。</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAVEN打包</title>
      <link href="/2024/04/23/MAVEN%E6%89%93%E5%8C%85/"/>
      <url>/2024/04/23/MAVEN%E6%89%93%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<h2 id="Maven打包简介"><a href="#Maven打包简介" class="headerlink" title="Maven打包简介"></a>Maven打包简介</h2><p>Maven是Java项目中最流行的构建工具之一，它提供了标准化的项目结构、依赖管理和构建流程。Maven的打包功能允许开发者将项目代码、资源文件和依赖项打包成可分发的格式（如JAR、WAR或EAR文件）。本文将介绍Maven打包的基本概念、常用配置和最佳实践。</p><h2 id="Maven打包基础"><a href="#Maven打包基础" class="headerlink" title="Maven打包基础"></a>Maven打包基础</h2><h3 id="打包类型"><a href="#打包类型" class="headerlink" title="打包类型"></a>打包类型</h3><p>Maven支持多种打包类型，在<code>pom.xml</code>中通过<code>&lt;packaging&gt;</code>标签指定：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span>  <span class="comment">&lt;!-- 默认值，生成JAR包 --&gt;</span></span><br></pre></td></tr></table></figure><p>常见的打包类型包括：</p><ul><li><code>jar</code>: Java应用程序或库</li><li><code>war</code>: Web应用程序</li><li><code>pom</code>: 父模块项目</li><li><code>ear</code>: 企业级应用</li></ul><h3 id="基本打包命令"><a href="#基本打包命令" class="headerlink" title="基本打包命令"></a>基本打包命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打包项目</span></span><br><span class="line">mvn package</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包并跳过测试</span></span><br><span class="line">mvn package -DskipTests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理并打包</span></span><br><span class="line">mvn clean package</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装到本地仓库</span></span><br><span class="line">mvn install</span><br></pre></td></tr></table></figure><h2 id="Spring-Boot应用打包配置"><a href="#Spring-Boot应用打包配置" class="headerlink" title="Spring Boot应用打包配置"></a>Spring Boot应用打包配置</h2><p>Spring Boot应用通常需要打包成可执行的JAR文件，这需要使用<code>spring-boot-maven-plugin</code>插件。以下是一个完整的配置示例：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指定启动类 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.wzz.ExamAdminApplication<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 重新打包，将依赖打入jar包中 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="插件配置说明"><a href="#插件配置说明" class="headerlink" title="插件配置说明"></a>插件配置说明</h3><ul><li><code>mainClass</code>: 指定应用的主类，包含<code>main</code>方法的完整类名</li><li><code>repackage</code>: 将原始JAR重新打包，添加依赖并使JAR可执行</li><li><code>excludes</code>: 可用于排除特定依赖</li><li><code>includes</code>: 可用于包含特定依赖</li></ul><h2 id="常用打包配置"><a href="#常用打包配置" class="headerlink" title="常用打包配置"></a>常用打包配置</h2><h3 id="跳过测试"><a href="#跳过测试" class="headerlink" title="跳过测试"></a>跳过测试</h3><p>在打包过程中跳过测试或忽略测试失败：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 忽略测试失败 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testFailureIgnore</span>&gt;</span>true<span class="tag">&lt;/<span class="name">testFailureIgnore</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 完全跳过测试 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;skip&gt;true&lt;/skip&gt; --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><p>也可以在命令行中使用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn package -DskipTests        <span class="comment"># 编译测试但不运行</span></span><br><span class="line">mvn package -Dmaven.test.skip=<span class="literal">true</span>  <span class="comment"># 不编译也不运行测试</span></span><br></pre></td></tr></table></figure><h3 id="指定Java版本"><a href="#指定Java版本" class="headerlink" title="指定Java版本"></a>指定Java版本</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>11<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="资源文件处理"><a href="#资源文件处理" class="headerlink" title="资源文件处理"></a>资源文件处理</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="打包时排除某些文件"><a href="#打包时排除某些文件" class="headerlink" title="打包时排除某些文件"></a>打包时排除某些文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jar-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>*.properties<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>config/**<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="打包可执行JAR的多种方式"><a href="#打包可执行JAR的多种方式" class="headerlink" title="打包可执行JAR的多种方式"></a>打包可执行JAR的多种方式</h2><h3 id="方式一：使用maven-shade-plugin"><a href="#方式一：使用maven-shade-plugin" class="headerlink" title="方式一：使用maven-shade-plugin"></a>方式一：使用maven-shade-plugin</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">transformer</span> <span class="attr">implementation</span>=<span class="string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.example.MainClass<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="方式二：使用maven-assembly-plugin"><a href="#方式二：使用maven-assembly-plugin" class="headerlink" title="方式二：使用maven-assembly-plugin"></a>方式二：使用maven-assembly-plugin</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">archive</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.example.MainClass<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">archive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">descriptorRefs</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">descriptorRef</span>&gt;</span>jar-with-dependencies<span class="tag">&lt;/<span class="name">descriptorRef</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">descriptorRefs</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>make-assembly<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>single<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="多模块项目打包"><a href="#多模块项目打包" class="headerlink" title="多模块项目打包"></a>多模块项目打包</h2><p>对于多模块项目，可以在父POM中配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">module</span>&gt;</span>module1<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">module</span>&gt;</span>module2<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">module</span>&gt;</span>module3<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -pl module1,module2 -am  <span class="comment"># 只打包指定模块及其依赖</span></span><br></pre></td></tr></table></figure><h2 id="打包最佳实践"><a href="#打包最佳实践" class="headerlink" title="打包最佳实践"></a>打包最佳实践</h2><ol><li><p><strong>使用依赖管理</strong>：使用<code>&lt;dependencyManagement&gt;</code>在父POM中统一管理依赖版本</p></li><li><p><strong>配置资源过滤</strong>：使用<code>filtering</code>替换配置文件中的变量</p></li><li><p><strong>分离配置</strong>：将环境相关配置分离，使用profiles处理不同环境</p></li><li><p><strong>版本管理</strong>：使用<code>maven-release-plugin</code>管理版本发布</p></li><li><p><strong>持续集成</strong>：将Maven打包集成到CI&#x2F;CD流程中</p></li></ol><h2 id="常见问题解决"><a href="#常见问题解决" class="headerlink" title="常见问题解决"></a>常见问题解决</h2><h3 id="依赖冲突"><a href="#依赖冲突" class="headerlink" title="依赖冲突"></a>依赖冲突</h3><p>使用<code>dependency:tree</code>命令查看依赖树，找出冲突：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn dependency:tree -Dverbose</span><br></pre></td></tr></table></figure><h3 id="内存不足"><a href="#内存不足" class="headerlink" title="内存不足"></a>内存不足</h3><p>增加Maven可用内存：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MAVEN_OPTS=<span class="string">&quot;-Xmx512m -XX:MaxPermSize=128m&quot;</span></span><br></pre></td></tr></table></figure><h3 id="打包速度慢"><a href="#打包速度慢" class="headerlink" title="打包速度慢"></a>打包速度慢</h3><p>使用并行构建：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -T 4 clean package  <span class="comment"># 使用4个线程构建</span></span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Maven打包是Java项目构建过程中的重要环节。通过合理配置Maven插件，可以实现自动化构建、测试和部署，提高开发效率。本文介绍的配置和最佳实践可以帮助开发者更好地使用Maven进行项目打包。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>com.wzz.ExamAdminApplication<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以添加配置跳过test报错</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">testFailureIgnore</span>&gt;</span>true<span class="tag">&lt;/<span class="name">testFailureIgnore</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL分区建表例子</title>
      <link href="/2024/04/23/MySQL%E5%88%86%E5%8C%BA%E5%BB%BA%E8%A1%A8%E4%BE%8B%E5%AD%90/"/>
      <url>/2024/04/23/MySQL%E5%88%86%E5%8C%BA%E5%BB%BA%E8%A1%A8%E4%BE%8B%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<p>以下为MySQL分区建表的例子</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `mz_mjzcfxxmx` (</span><br><span class="line">  `SERIALNUM_ID` <span class="type">varchar</span>(<span class="number">96</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;业务角度唯一性ID&#x27;</span>,</span><br><span class="line">  `DATAGENERATE_DATE` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;业务数据产生时间&#x27;</span>,</span><br><span class="line">  `ROW_ID` <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;数据角度唯一性ID&#x27;</span>,</span><br><span class="line">  `TASK_ID` <span class="type">varchar</span>(<span class="number">96</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;任务号&#x27;</span>,</span><br><span class="line">  `BATCH_NUM` <span class="type">varchar</span>(<span class="number">96</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;批次号&#x27;</span>,</span><br><span class="line">  `LOCAL_ID` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;人员唯一标识&#x27;</span>,</span><br><span class="line">  `BUSINESS_ID` <span class="type">varchar</span>(<span class="number">600</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;业务流水号&#x27;</span>,</span><br><span class="line">  `BASIC_ACTIVE_ID` <span class="type">varchar</span>(<span class="number">600</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;业务系统的逻辑主键或联合主键&#x27;</span>,</span><br><span class="line">  `DOMAIN_CODE` <span class="type">varchar</span>(<span class="number">36</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;接入系统编码&#x27;</span>,</span><br><span class="line">  `ORGANIZATION_CODE` <span class="type">varchar</span>(<span class="number">66</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;组织机构代码&#x27;</span>,</span><br><span class="line">  `ORGANIZATION_NAME` <span class="type">varchar</span>(<span class="number">600</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;组织机构名称&#x27;</span>,</span><br><span class="line">  `CREATE_DATE` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;数据落库时间&#x27;</span>,</span><br><span class="line">  `IS_ERROR` <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;数据质控时是否有错&#x27;</span>,</span><br><span class="line">  `OUT_IN_ID` <span class="type">varchar</span>(<span class="number">600</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;门（急）诊（住院）号&#x27;</span>,</span><br><span class="line">  `DENOMINATOR_RULE` longtext COMMENT <span class="string">&#x27;符合规则起效条件&#x27;</span>,</span><br><span class="line">  `ERROR_RULE` longtext COMMENT <span class="string">&#x27;错误规则信息&#x27;</span>,</span><br><span class="line">  `RECEIVE_DATE` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;数据接收时间&#x27;</span>,</span><br><span class="line">  `ARCHIVE_DATE` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;归档日期时间&#x27;</span>,</span><br><span class="line">  `RESOURCE_ID` longtext COMMENT <span class="string">&#x27;资源信息ID&#x27;</span>,</span><br><span class="line">  `YLJGDM` <span class="type">varchar</span>(<span class="number">66</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;医疗机构代码&#x27;</span>,</span><br><span class="line">  `CFMXID` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;处方明细ID&#x27;</span>,</span><br><span class="line">  `YLJGMC` <span class="type">varchar</span>(<span class="number">210</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;医疗机构名称&#x27;</span>,</span><br><span class="line">  `GRBSH` <span class="type">varchar</span>(<span class="number">108</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;个人标识号&#x27;</span>,</span><br><span class="line">  `CFZID` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;处方主ID&#x27;</span>,</span><br><span class="line">  `JZLSH` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;就诊流水号&#x27;</span>,</span><br><span class="line">  `CFZH` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;处方组号&#x27;</span>,</span><br><span class="line">  `ZTDM` <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;组套代码&#x27;</span>,</span><br><span class="line">  `ZTMC` <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;组套名称&#x27;</span>,</span><br><span class="line">  `XMDM` <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;项目代码&#x27;</span>,</span><br><span class="line">  `XMMC` longtext COMMENT <span class="string">&#x27;项目名称&#x27;</span>,</span><br><span class="line">  `FYFLDM` <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;费用分类代码&#x27;</span>,</span><br><span class="line">  `FYFLMC` <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;费用分类名称&#x27;</span>,</span><br><span class="line">  `YPBZ` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品标志&#x27;</span>,</span><br><span class="line">  `YPGG` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品规格（新）&#x27;</span>,</span><br><span class="line">  `YPJXDM` <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品剂型代码-新&#x27;</span>,</span><br><span class="line">  `YPJXMC` <span class="type">varchar</span>(<span class="number">240</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品剂型名称-新&#x27;</span>,</span><br><span class="line">  `YPSYCJL` <span class="type">varchar</span>(<span class="number">31</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品使用次剂量-新&#x27;</span>,</span><br><span class="line">  `YPSYCJLDW` <span class="type">varchar</span>(<span class="number">18</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品使用次剂量单位&#x27;</span>,</span><br><span class="line">  `YPSYZJL` <span class="type">varchar</span>(<span class="number">37</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品使用总剂量-新&#x27;</span>,</span><br><span class="line">  `YPSYPCDM` <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品使用频次代码-新&#x27;</span>,</span><br><span class="line">  `YPSYPCMC` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药品使用频次名称-新&#x27;</span>,</span><br><span class="line">  `YYTS` <span class="type">varchar</span>(<span class="number">31</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用药天数&#x27;</span>,</span><br><span class="line">  `YWLXDM` <span class="type">varchar</span>(<span class="number">12</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药物类型代码&#x27;</span>,</span><br><span class="line">  `YWLXMC` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;药物类型名称&#x27;</span>,</span><br><span class="line">  `YYTJDM` <span class="type">varchar</span>(<span class="number">9</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;预约途径代码（用药途径代码）&#x27;</span>,</span><br><span class="line">  `YYTJMC` <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;预约途径名称(用药途径名称)&#x27;</span>,</span><br><span class="line">  `FYSL` <span class="type">varchar</span>(<span class="number">31</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;发药数量&#x27;</span>,</span><br><span class="line">  `FYSLDW` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;发药数量单位&#x27;</span>,</span><br><span class="line">  `CFKSSJ` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;处方开始时间&#x27;</span>,</span><br><span class="line">  `CFTZSJ` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;处方停止时间&#x27;</span>,</span><br><span class="line">  `ZXKSDM` <span class="type">varchar</span>(<span class="number">60</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;执行科室代码&#x27;</span>,</span><br><span class="line">  `ZXKSMC` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;执行科室名称&#x27;</span>,</span><br><span class="line">  `YZZXDM` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;医嘱执行状态代码&#x27;</span>,</span><br><span class="line">  `YZZXMC` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;医嘱执行状态名称&#x27;</span>,</span><br><span class="line">  `ZYYPCF` longtext COMMENT <span class="string">&#x27;中药饮片处方&#x27;</span>,</span><br><span class="line">  `ZYYPJS` <span class="type">varchar</span>(<span class="number">13</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;中药饮片剂数&#x27;</span>,</span><br><span class="line">  `ZYYPJZFF` <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;中药饮片煎煮方法&#x27;</span>,</span><br><span class="line">  `ZYYYTJDM` <span class="type">varchar</span>(<span class="number">9</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;中药用药途径代码&#x27;</span>,</span><br><span class="line">  `ZYYYTJMC` <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;中药用药途径名称&#x27;</span>,</span><br><span class="line">  `ZZZF` <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;治则治法&#x27;</span>,</span><br><span class="line">  `DPBZ` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;点评标志&#x27;</span>,</span><br><span class="line">  `YYSM` longtext COMMENT <span class="string">&#x27;用药说明&#x27;</span>,</span><br><span class="line">  `BZ` longtext COMMENT <span class="string">&#x27;其他备注说明&#x27;</span>,</span><br><span class="line">  `CYJZ` longtext COMMENT <span class="string">&#x27;草药脚注&#x27;</span>,</span><br><span class="line">  `ZYBS` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;主药标识&#x27;</span>,</span><br><span class="line">  `JJBS` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;加急标识&#x27;</span>,</span><br><span class="line">  `PSCZY` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;皮试操作员&#x27;</span>,</span><br><span class="line">  `PSJLRQSJ` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;皮试结论日期时间&#x27;</span>,</span><br><span class="line">  `PSPB` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;皮试判别&#x27;</span>,</span><br><span class="line">  `PSJG` <span class="type">varchar</span>(<span class="number">48</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;皮试结果（新）&#x27;</span>,</span><br><span class="line">  `MJ` <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;密级&#x27;</span>,</span><br><span class="line">  `TBRQ` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;填报日期（新）&#x27;</span>,</span><br><span class="line">  `XGRQ` <span class="type">varchar</span>(<span class="number">42</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;最后更新时间（新）&#x27;</span>,</span><br><span class="line">  `XGBZ` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;修改标志&#x27;</span>,</span><br><span class="line">  `rowkey` <span class="type">varchar</span>(<span class="number">570</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;兼容IHBE的记录唯一性主键&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`SERIALNUM_ID`,`DATAGENERATE_DATE`),</span><br><span class="line">  KEY `mz_mjzcfxxmx_DATAGENERATE_DATE_IDX` (`DATAGENERATE_DATE`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 ROW_FORMAT<span class="operator">=</span><span class="keyword">DYNAMIC</span> COMMENT<span class="operator">=</span><span class="string">&#x27;自治区1-门急诊处方信息明细&#x27;</span></span><br><span class="line"> <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (((<span class="keyword">year</span>(`DATAGENERATE_DATE`) <span class="operator">*</span> <span class="number">100</span>) <span class="operator">+</span> <span class="keyword">month</span>(`DATAGENERATE_DATE`)))</span><br><span class="line">(<span class="keyword">PARTITION</span> p202001 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202002</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202002 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202003</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202003 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202004</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202004 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202005</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202005 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202006</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202006 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202007</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202007 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202008</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202008 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202009</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202009 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202010</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202010 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202011</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202011 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202012</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202012 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202101</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202101 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202102</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202102 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202103</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202103 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202104</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202104 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202105</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202105 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202106</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202106 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202107</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202107 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202108</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202108 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202109</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202109 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202110</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202110 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202111</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202111 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202112</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202112 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202201</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202201 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202202</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202202 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202203</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202203 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202204</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202204 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202205</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202205 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202206</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202206 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202207</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202207 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202208</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202208 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202209</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202209 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202210</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202210 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202211</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202211 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202212</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202212 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202301</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202301 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202302</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202302 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202303</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202303 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202304</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202304 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202305</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202305 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202306</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202306 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202307</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202307 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202308</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202308 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202309</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202309 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202310</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202310 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202311</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202311 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202312</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202312 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202401</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202401 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202402</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202402 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202403</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202403 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202404</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202404 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202405</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202405 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202406</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202406 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202407</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202407 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202408</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202408 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202409</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202409 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202410</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202410 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202411</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202411 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202412</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202412 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202501</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202501 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202502</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202502 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202503</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202503 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202504</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202504 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202505</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202505 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202506</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202506 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202507</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202507 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202508</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202508 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202509</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202509 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202510</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202510 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202511</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202511 <span class="keyword">VALUES</span> LESS THAN (<span class="number">202512</span>) ENGINE <span class="operator">=</span> InnoDB,</span><br><span class="line"> <span class="keyword">PARTITION</span> p202512 <span class="keyword">VALUES</span> LESS THAN MAXVALUE ENGINE <span class="operator">=</span> InnoDB) ;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springboot映射图片</title>
      <link href="/2024/04/23/Springboot%E6%98%A0%E5%B0%84%E5%9B%BE%E7%89%87/"/>
      <url>/2024/04/23/Springboot%E6%98%A0%E5%B0%84%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p>在<code>application.yml</code>里面添加图片存放的位置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user:</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">D:/home/data/schoolNews/</span></span><br></pre></td></tr></table></figure><p>自己写上传和下载的方法</p><hr><hr><p>例如</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 上传文件映射表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;file&quot;)</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;unchecked&quot;,&quot;rawtypes&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;user.file.path&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String filePath;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ConfigService configService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 上传文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">upload</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file,String type)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (file.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">EIException</span>(<span class="string">&quot;上传文件不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileExt</span> <span class="operator">=</span> file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="type">File</span> <span class="variable">upload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filePath,<span class="string">&quot;/upload/&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!upload.exists()) &#123;</span><br><span class="line">            upload.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>().getTime()+<span class="string">&quot;.&quot;</span>+fileExt;</span><br><span class="line">        <span class="type">File</span> <span class="variable">dest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(upload.getAbsolutePath()+<span class="string">&quot;/&quot;</span>+fileName);</span><br><span class="line">        file.transferTo(dest);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isNotBlank(type) &amp;&amp; type.equals(<span class="string">&quot;1&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">ConfigEntity</span> <span class="variable">configEntity</span> <span class="operator">=</span> configService.selectOne(<span class="keyword">new</span> <span class="title class_">EntityWrapper</span>&lt;ConfigEntity&gt;().eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;faceFile&quot;</span>));</span><br><span class="line">            <span class="keyword">if</span>(configEntity==<span class="literal">null</span>) &#123;</span><br><span class="line">                configEntity = <span class="keyword">new</span> <span class="title class_">ConfigEntity</span>();</span><br><span class="line">                configEntity.setName(<span class="string">&quot;faceFile&quot;</span>);</span><br><span class="line">                configEntity.setValue(fileName);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                configEntity.setValue(fileName);</span><br><span class="line">            &#125;</span><br><span class="line">            configService.insertOrUpdate(configEntity);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R.ok().put(<span class="string">&quot;file&quot;</span>, fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 下载文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@IgnoreAuth</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/download&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;<span class="type">byte</span>[]&gt; download(<span class="meta">@RequestParam</span> String fileName) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">upload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filePath,<span class="string">&quot;/upload/&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(!upload.exists()) &#123;</span><br><span class="line">                upload.mkdirs();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(upload.getAbsolutePath()+<span class="string">&quot;/&quot;</span>+fileName);</span><br><span class="line">            <span class="keyword">if</span>(file.exists())&#123;</span><br><span class="line">                <span class="comment">/*if(!fileService.canRead(file, SessionManager.getSessionUser()))&#123;</span></span><br><span class="line"><span class="comment">getResponse().sendError(403);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line">                <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">                headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);    </span><br><span class="line">                headers.setContentDispositionFormData(<span class="string">&quot;attachment&quot;</span>, fileName);    </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;<span class="type">byte</span>[]&gt;(FileUtils.readFileToByteArray(file),headers, HttpStatus.CREATED);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;<span class="type">byte</span>[]&gt;(HttpStatus.INTERNAL_SERVER_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>添加映射让前端显示图片</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.config;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterceptorConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;user.file.path&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String filePath;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>).addResourceLocations(<span class="string">&quot;file:/&quot;</span> + filePath)</span><br><span class="line">;</span><br><span class="line"><span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sharding-jdbc 分片</title>
      <link href="/2024/04/23/Sharding-jdbc%20%E5%88%86%E7%89%87/"/>
      <url>/2024/04/23/Sharding-jdbc%20%E5%88%86%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p>所需依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shardingsphere-jdbc-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.yaml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>snakeyaml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>application.yml 文件添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">main:</span></span><br><span class="line">  <span class="attr">allow-bean-definition-overriding:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="attr">driver-class-name:</span> <span class="string">org.apache.shardingsphere.driver.ShardingSphereDriver</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">jdbc:shardingsphere:classpath:sharding.yaml</span></span><br></pre></td></tr></table></figure><p>添加分片的yaml文件，命名为<code>sharding.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dataSources:</span></span><br><span class="line">  <span class="attr">ds:</span></span><br><span class="line">    <span class="attr">dataSourceClassName:</span> <span class="string">com.zaxxer.hikari.HikariDataSource</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">jdbcUrl:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/mysql-monitor?useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="type">!SHARDING</span></span><br><span class="line">    <span class="attr">tables:</span></span><br><span class="line">      <span class="attr">server_status_history:</span></span><br><span class="line">        <span class="attr">actualDataNodes:</span> <span class="string">ds.server_status_history</span></span><br><span class="line">        <span class="attr">tableStrategy:</span></span><br><span class="line">          <span class="attr">standard:</span></span><br><span class="line">            <span class="attr">shardingColumn:</span> <span class="string">create_time</span></span><br><span class="line">            <span class="attr">shardingAlgorithmName:</span> <span class="string">auto-custom</span></span><br><span class="line">    <span class="attr">shardingAlgorithms:</span></span><br><span class="line">      <span class="attr">auto-custom:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">CLASS_BASED</span></span><br><span class="line">        <span class="attr">props:</span></span><br><span class="line">          <span class="attr">strategy:</span> <span class="string">standard</span></span><br><span class="line">          <span class="attr">algorithmClassName:</span> <span class="string">com.fc.v2.common.sharding.CustomTimeShardingAlgorithm</span></span><br><span class="line"><span class="comment">#    auto-interval:</span></span><br><span class="line"><span class="comment">#      type: AUTO_INTERVAL</span></span><br><span class="line"><span class="comment">#      props:</span></span><br><span class="line"><span class="comment">#        datetime-lower: &#x27;2023-01-01 00:00:00&#x27;</span></span><br><span class="line"><span class="comment">#        datetime-upper: &#x27;2023-12-01 00:00:00&#x27;</span></span><br><span class="line"><span class="comment">#        # 60 * 60 * 24 * 30=30天</span></span><br><span class="line"><span class="comment">#        sharding-seconds: &#x27;2592000&#x27;</span></span><br><span class="line"><span class="comment">#    interval:</span></span><br><span class="line"><span class="comment">#      type: INTERVAL</span></span><br><span class="line"><span class="comment">#      props:</span></span><br><span class="line"><span class="comment">#        datetime-pattern: &#x27;yyyy-MM&#x27;</span></span><br><span class="line"><span class="comment">#        datetime-lower: &#x27;2023-01&#x27;</span></span><br><span class="line"><span class="comment">#        datetime-upper: &#x27;2023-12&#x27;</span></span><br><span class="line"><span class="comment">#        sharding-suffix-pattern: &#x27;yyyyMM&#x27;</span></span><br><span class="line"><span class="comment">#        # 间隔大小</span></span><br><span class="line"><span class="comment">#        datetime-interval-amount: 1</span></span><br><span class="line"><span class="comment">#        datetime-interval-unit: &#x27;Months&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">props:</span></span><br><span class="line">  <span class="attr">sql-show:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>conda创建、运行虚拟环境以及使用镜像源</title>
      <link href="/2024/04/23/conda%E5%88%9B%E5%BB%BA%E3%80%81%E8%BF%90%E8%A1%8C%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E6%BA%90/"/>
      <url>/2024/04/23/conda%E5%88%9B%E5%BB%BA%E3%80%81%E8%BF%90%E8%A1%8C%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E6%BA%90/</url>
      
        <content type="html"><![CDATA[<p><font style="color:rgb(77, 77, 77);">输入此条指令创建conda虚拟环境,可以自己更改名称和python版本<br></font><strong><font style="color:rgb(77, 77, 77);">conda create -n 自己输入名称 python&#x3D;版本号</font></strong><font style="color:rgb(77, 77, 77);"><br>如下所示,我示例创建名为text的环境</font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n text python=3.8</span><br></pre></td></tr></table></figure><p><font style="color:rgb(79, 79, 79);">激活虚拟环境</font></p><p><font style="color:rgb(77, 77, 77);">输入下行代码激活刚才创建的环境,主要名称要与之前创建时设置的名称相应<br></font><strong><font style="color:rgb(77, 77, 77);">conda activate 名称</font></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate text</span><br></pre></td></tr></table></figure><p>查看所有环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda <span class="built_in">env</span> list</span><br></pre></td></tr></table></figure><p>conda升级</p><ul><li><code>conda update conda</code><font style="color:rgba(0, 0, 0, 0.75);">升级conda</font></li><li><code>conda update anaconda</code><font style="color:rgba(0, 0, 0, 0.75);">升级anaconda前要先升级conda</font></li><li><code>conda update --all</code><font style="color:rgba(0, 0, 0, 0.75);">升级所有包</font></li></ul><p>删除环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda remove -n xxxxx(名字) --all</span><br></pre></td></tr></table></figure><p>conda安装依赖</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge pybullet</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>my.cnf 配置优化</title>
      <link href="/2024/04/23/my.cnf%20%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96/"/>
      <url>/2024/04/23/my.cnf%20%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">collation-server=utf8mb4_unicode_ci</span><br><span class="line">character-set-server=utf8mb4 <span class="comment"># 字符集</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">datadir=/var/lib/mysql  <span class="comment"># MySQL安装位置</span></span><br><span class="line">socket=/var/lib/mysql/mysql.sock  <span class="comment"># MySQL通讯协议文件位置，本地连接使用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否支持符号链接，即数据库或表可以存储在my.cnf中指定datadir之外的分区或目录，为0不开启。</span></span><br><span class="line"><span class="comment"># 禁用symbolic-links选项、服务配置，禁用符号链接以防止各种安全风险</span></span><br><span class="line">symbolic-links=0 </span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid <span class="comment"># MySQL进程位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 网络设置  </span></span><br><span class="line">max_connections=200  <span class="comment"># 最大连接数，根据应用需求调整  </span></span><br><span class="line">max_connect_errors=100000</span><br><span class="line">table_open_cache=2000  <span class="comment"># 打开的表缓存数量  </span></span><br><span class="line">table_definition_cache=1500  <span class="comment"># 表定义缓存数量  9How</span></span><br><span class="line">thread_cache_size=16  <span class="comment"># 线程缓存大小</span></span><br><span class="line"><span class="comment"># 事务隔离级别</span></span><br><span class="line"><span class="comment"># 由低到高分别为</span></span><br><span class="line"><span class="comment"># read-uncommitted（读未提交）</span></span><br><span class="line"><span class="comment"># read-committed（读提交） </span></span><br><span class="line"><span class="comment"># repeatable read（重复读） </span></span><br><span class="line"><span class="comment"># Serializable（序列化） </span></span><br><span class="line">transaction_isolation=READ-COMMITTED </span><br><span class="line">lower_case_table_names=1 <span class="comment"># 大小写敏感关闭</span></span><br><span class="line">default_time_zone=+8:00 <span class="comment"># 时区</span></span><br><span class="line">open_files_limit=65535 <span class="comment"># 最大文件描述符数量</span></span><br><span class="line">log_timestamps=system <span class="comment"># 解决日志时区不匹配问题 (5.7 版本独有)</span></span><br><span class="line">wait_timeout=900  <span class="comment"># 连接时长控制</span></span><br><span class="line">interactive_timeout=900 <span class="comment"># 连接时长控制</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 缓存和缓冲设置  </span></span><br><span class="line">innodb_buffer_pool_size=4G  <span class="comment"># InnoDB缓冲池大小，建议设置为物理内存的50%-75%  </span></span><br><span class="line">innodb_buffer_pool_instances=4  <span class="comment"># 缓冲池实例数量，建议设置为缓冲池大小的1/1G，最多8个  </span></span><br><span class="line">innodb_stats_on_metadata=OFF  <span class="comment"># 关闭在元数据请求时更新统计信息，减少I/O  </span></span><br><span class="line">innodb_flush_method=O_DIRECT  <span class="comment"># 使用直接I/O，减少文件系统缓存 </span></span><br><span class="line">innodb_io_capacity=2000 <span class="comment"># InnoDB后台任务(如刷新脏页和合并插入缓冲区)每秒可以进行的I/O操作数量</span></span><br><span class="line">innodb_log_files_in_group=4 <span class="comment"># InnoDB重做日志组中日志文件的数量</span></span><br><span class="line"><span class="comment"># ↓↓↓↓ 该配置只能在初始化实例前配置，如果启动后报错需要改成0</span></span><br><span class="line">innodb_undo_tablespaces=4 <span class="comment"># InnoDB使用的撤销表空间文件的数量，存储撤销日志，支持事务回滚</span></span><br><span class="line">innodb_undo_log_truncate=1 <span class="comment"># 启用撤销日志的截断</span></span><br><span class="line">innodb_max_undo_log_size=1G <span class="comment"># 单个撤销表空间文件的最大大小</span></span><br><span class="line">innodb_flush_neighbors=0 <span class="comment"># 控制InnoDB是否应该尝试将相邻的脏页一起刷新到磁盘，关闭</span></span><br><span class="line">innodb_print_all_deadlocks=1 <span class="comment"># 打印死锁信息到错误日志</span></span><br><span class="line">innodb_online_alter_log_max_size=128M <span class="comment"># 设置在线DDL操作生成的重做日志的最大大小</span></span><br><span class="line">innodb_lock_wait_timeout=10 <span class="comment"># 设置事务等待行锁的最长时间</span></span><br><span class="line">innodb_doublewrite=ON <span class="comment"># 启用InnoDB的双重写入缓冲区功能</span></span><br><span class="line">innodb_file_format=Barracuda <span class="comment"># 设置InnoDB表的文件格式。Barracuda格式支持压缩和动态行格式。</span></span><br><span class="line">innodb_log_file_size=512M  <span class="comment"># InnoDB日志文件大小  </span></span><br><span class="line">innodb_log_buffer_size=16M  <span class="comment"># InnoDB日志缓冲区大小  </span></span><br><span class="line">innodb_flush_log_at_trx_commit=1  <span class="comment"># 每事务提交时刷新日志，设为1保证数据完整性  </span></span><br><span class="line">innodb_file_per_table=1  <span class="comment"># 每个表一个独立表空间文件  </span></span><br><span class="line">innodb_open_files=300  <span class="comment"># InnoDB打开的文件数量  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#bin log</span></span><br><span class="line">expire_logs_days=30 <span class="comment"># 二进制日志（binlog）的自动删除天数</span></span><br><span class="line">max_binlog_cache_size=1024M <span class="comment"># 设置会话级别的二进制日志缓存的最大大小</span></span><br><span class="line">sync_binlog=1 <span class="comment"># 每次提交事务后都同步到日志</span></span><br><span class="line">server_id=1001 <span class="comment"># 服务器的唯一标识符用于区分主从服务器</span></span><br><span class="line">gtid-mode=on <span class="comment"># 启用全局事务标识符（GTID）模式</span></span><br><span class="line">enforce-gtid-consistency=<span class="literal">true</span> <span class="comment"># 在GTID模式下，强制要求事务的一致性</span></span><br><span class="line">master-info-repository=TABLE <span class="comment"># 主服务器信息的存储位置</span></span><br><span class="line">relay-log-info-repository=TABLE <span class="comment"># 中继日志信息的存储位置</span></span><br><span class="line">sync-master-info=1000 <span class="comment"># 将主服务器信息同步到磁盘的频率</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 临时表和相关设置  </span></span><br><span class="line">tmp_table_size=64M  </span><br><span class="line">max_heap_table_size=64M  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 日志和错误报告  </span></span><br><span class="line">log_error=/var/log/mysql/mysqld.log </span><br><span class="line">slow_query_log=1  <span class="comment"># 开启慢查询</span></span><br><span class="line">slow_query_log_file=/var/log/mysql/mysql-slow.log  </span><br><span class="line">long_query_time=2  <span class="comment"># 记录执行时间超过2秒的查询  </span></span><br><span class="line">log_queries_not_using_indexes=1  <span class="comment"># 记录未使用索引的查询</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>layui动态添加option</title>
      <link href="/2024/04/23/layui%E5%8A%A8%E6%80%81%E6%B7%BB%E5%8A%A0option/"/>
      <url>/2024/04/23/layui%E5%8A%A8%E6%80%81%E6%B7%BB%E5%8A%A0option/</url>
      
        <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先获取select</span></span><br><span class="line"><span class="keyword">var</span> select = $(<span class="string">&quot;#serverId&quot;</span>)</span><br><span class="line"><span class="comment">// 这个是一个默认的option</span></span><br><span class="line">select.<span class="title function_">append</span>(<span class="keyword">new</span> <span class="title class_">Option</span>(<span class="string">&quot;请选择&quot;</span>,<span class="string">&quot;&quot;</span>))</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  select.<span class="title function_">append</span>(<span class="keyword">new</span> <span class="title class_">Option</span>(data[i].<span class="property">tags</span>,data[i].<span class="property">id</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> curServer = <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;curServer&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (curServer != <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">  select.<span class="title function_">val</span>(curServer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 最后一定重新渲染</span></span><br><span class="line">form.<span class="title function_">render</span>();</span><br></pre></td></tr></table></figure><hr><p>重新渲染的表格，可能会出现白底白字导致看不清</p><p><img src="/img/posts/515ddeb73705758bcaf5a995379c5034.png"></p><p>这块只能在外层的div块中添加<code>style=&quot;color: #0C0C0C&quot;</code>手动渲染</p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Layui </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>print输出进度条</title>
      <link href="/2024/04/23/print%E8%BE%93%E5%87%BA%E8%BF%9B%E5%BA%A6%E6%9D%A1/"/>
      <url>/2024/04/23/print%E8%BE%93%E5%87%BA%E8%BF%9B%E5%BA%A6%E6%9D%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h2><p>在处理大量数据或执行耗时较长的操作时，用户往往需要了解程序的执行进度。通过在命令行中显示进度条，可以直观地展示任务的完成情况，提升用户体验。本文介绍如何使用Python的<code>print</code>函数实现一个简单而实用的命令行进度条。</p><h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><p>命令行进度条的核心原理是利用回车符<code>\r</code>实现同一行的刷新。当<code>print</code>函数中使用<code>end=&quot;&quot;</code>参数时，可以防止自动换行，配合<code>\r</code>可以实现在同一行不断更新内容，从而呈现出进度条动态变化的效果。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">display_progress_bar</span>(<span class="params">current, total, bar_length=<span class="number">20</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    显示进度条</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">    - current: 当前进度</span></span><br><span class="line"><span class="string">    - total: 总任务数</span></span><br><span class="line"><span class="string">    - bar_length: 进度条长度</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    progress_percent = <span class="built_in">int</span>(current / total * <span class="number">100</span>)</span><br><span class="line">    filled_length = <span class="built_in">int</span>(bar_length * (progress_percent / <span class="number">100</span>))</span><br><span class="line">    bar = <span class="string">&quot;|&quot;</span> + <span class="string">&quot;-&quot;</span> * filled_length + <span class="string">&quot; &quot;</span> * (bar_length - filled_length) + <span class="string">&quot;|&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;\r正在处理: <span class="subst">&#123;bar&#125;</span> <span class="subst">&#123;progress_percent&#125;</span>% (<span class="subst">&#123;current&#125;</span>/<span class="subst">&#123;total&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例数组，实际应用中可替换为任何可迭代对象</span></span><br><span class="line">data_array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">num = <span class="built_in">len</span>(data_array)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理数组中的每个元素</span></span><br><span class="line"><span class="keyword">for</span> index, element <span class="keyword">in</span> <span class="built_in">enumerate</span>(data_array):</span><br><span class="line">    i = index + <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 模拟处理时间</span></span><br><span class="line">    time.sleep(<span class="number">0.3</span>)  <span class="comment"># 实际应用中，这里是您的处理逻辑</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 每处理2个元素或处理到最后一个元素时更新进度条</span></span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">or</span> i == num:</span><br><span class="line">        <span class="built_in">print</span>(display_progress_bar(i, num), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理完成后换行</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n处理完成!&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="进阶用法"><a href="#进阶用法" class="headerlink" title="进阶用法"></a>进阶用法</h2><h3 id="1-添加处理速度和预估剩余时间"><a href="#1-添加处理速度和预估剩余时间" class="headerlink" title="1. 添加处理速度和预估剩余时间"></a>1. 添加处理速度和预估剩余时间</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">display_advanced_progress_bar</span>(<span class="params">current, total, start_time, bar_length=<span class="number">20</span></span>):</span><br><span class="line">    progress_percent = <span class="built_in">int</span>(current / total * <span class="number">100</span>)</span><br><span class="line">    filled_length = <span class="built_in">int</span>(bar_length * (progress_percent / <span class="number">100</span>))</span><br><span class="line">    bar = <span class="string">&quot;|&quot;</span> + <span class="string">&quot;-&quot;</span> * filled_length + <span class="string">&quot; &quot;</span> * (bar_length - filled_length) + <span class="string">&quot;|&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算速度和剩余时间</span></span><br><span class="line">    elapsed_time = time.time() - start_time</span><br><span class="line">    <span class="keyword">if</span> current == <span class="number">0</span>:</span><br><span class="line">        items_per_second = <span class="number">0</span></span><br><span class="line">        eta = <span class="string">&quot;未知&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        items_per_second = current / elapsed_time</span><br><span class="line">        eta_seconds = (total - current) / items_per_second <span class="keyword">if</span> items_per_second &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 格式化剩余时间</span></span><br><span class="line">        <span class="keyword">if</span> eta_seconds &lt; <span class="number">60</span>:</span><br><span class="line">            eta = <span class="string">f&quot;<span class="subst">&#123;eta_seconds:<span class="number">.1</span>f&#125;</span>秒&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> eta_seconds &lt; <span class="number">3600</span>:</span><br><span class="line">            eta = <span class="string">f&quot;<span class="subst">&#123;eta_seconds/<span class="number">60</span>:<span class="number">.1</span>f&#125;</span>分钟&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            eta = <span class="string">f&quot;<span class="subst">&#123;eta_seconds/<span class="number">3600</span>:<span class="number">.1</span>f&#125;</span>小时&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;\r进度: <span class="subst">&#123;bar&#125;</span> <span class="subst">&#123;progress_percent&#125;</span>% (<span class="subst">&#123;current&#125;</span>/<span class="subst">&#123;total&#125;</span>) 速度: <span class="subst">&#123;items_per_second:<span class="number">.2</span>f&#125;</span>项/秒 剩余时间: <span class="subst">&#123;eta&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line">start_time = time.time()</span><br><span class="line">data = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, _ <span class="keyword">in</span> <span class="built_in">enumerate</span>(data):</span><br><span class="line">    <span class="comment"># 模拟处理</span></span><br><span class="line">    time.sleep(<span class="number">0.05</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 更新进度条</span></span><br><span class="line">    <span class="keyword">if</span> (i + <span class="number">1</span>) % <span class="number">5</span> == <span class="number">0</span> <span class="keyword">or</span> i + <span class="number">1</span> == <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="built_in">print</span>(display_advanced_progress_bar(i + <span class="number">1</span>, <span class="built_in">len</span>(data), start_time), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n处理完成!&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="2-使用tqdm库"><a href="#2-使用tqdm库" class="headerlink" title="2. 使用tqdm库"></a>2. 使用tqdm库</h3><p>对于更专业的进度条需求，可以使用<code>tqdm</code>库，它提供了更丰富的功能：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建进度条</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">100</span>), desc=<span class="string">&quot;处理进度&quot;</span>):</span><br><span class="line">    <span class="comment"># 模拟处理</span></span><br><span class="line">    time.sleep(<span class="number">0.05</span>)</span><br></pre></td></tr></table></figure><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ol><li><strong>数据处理</strong>：处理大量数据时显示进度</li><li><strong>文件操作</strong>：上传、下载或复制大文件时显示进度</li><li><strong>批量任务</strong>：执行批量操作时显示完成情况</li><li><strong>长时间计算</strong>：执行需要较长时间的计算任务时提供反馈</li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>进度条更新频率不宜过高，否则会影响性能</li><li>在多线程环境中使用时需要注意线程安全</li><li>在某些环境（如Jupyter Notebook）中，<code>\r</code>可能无法正常工作，需要使用其他方法</li><li>对于非常大的数据集，可以考虑按百分比而非按项目数更新进度条</li></ol><p>通过合理使用进度条，可以显著提升命令行应用的用户体验，让用户清楚地了解程序执行情况。</p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定时刷新图表</title>
      <link href="/2024/04/23/%E5%AE%9A%E6%97%B6%E5%88%B7%E6%96%B0%E5%9B%BE%E8%A1%A8/"/>
      <url>/2024/04/23/%E5%AE%9A%E6%97%B6%E5%88%B7%E6%96%B0%E5%9B%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自动刷新</span></span><br><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> intervalId = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">let</span> intervalValue = <span class="built_in">parseInt</span>($(<span class="string">&quot;#time&quot;</span>).<span class="title function_">val</span>() * <span class="number">1000</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setNewInterval</span>(intervalValue);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">setNewInterval</span>(<span class="params">intervalValue</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (intervalId) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(intervalId)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(intervalValue) &amp;&amp; intervalValue &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      intervalId = <span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">flashDashboardChart</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;定时获取数据&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(intervalValue)</span><br><span class="line">      &#125;, intervalValue);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $(<span class="string">&quot;#time&quot;</span>).<span class="title function_">on</span>(<span class="string">&#x27;input propertychange&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalValue = <span class="built_in">parseInt</span>($(<span class="variable language_">this</span>).<span class="title function_">val</span>() * <span class="number">1000</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(intervalValue)</span><br><span class="line">    <span class="title function_">setNewInterval</span>(intervalValue);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用<code>$(document).ready</code>进入页面就直接刷新，<code>time</code>是可以选时间的块，从中可以获取值从而改变定时器的频率，而<code>flashDashboardChart()</code>是刷新图表的方法</p>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Echarts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原生JS实现聊天窗口</title>
      <link href="/2024/04/23/%E5%8E%9F%E7%94%9FJS%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E7%AA%97%E5%8F%A3/"/>
      <url>/2024/04/23/%E5%8E%9F%E7%94%9FJS%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E7%AA%97%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<p>弹窗页面的样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.talk_con</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#666</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">50px</span> auto <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#f9f9f9</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.talk_show</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">580px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">420px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#666</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">10px</span> auto <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">overflow</span>: auto;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.talk_input</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">580px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">10px</span> auto <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.whotalk</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">outline</span>: none;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.talk_word</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">420px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">26px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">outline</span>: none;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-indent</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.talk_sub</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">56px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin-left</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.atalk</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.atalk</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#0181cc</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.btalk</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: right;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.btalk</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#ef8201</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/assets/js/jquery-3.5.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">      $(<span class="string">&quot;input&quot;</span>).<span class="title function_">keypress</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span>(e.<span class="property">which</span> == <span class="number">13</span>)&#123;<span class="comment">//检测回车键</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//执行回车事件</span></span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">send</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> <span class="title class_">Words</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;words&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> <span class="title class_">Who</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;who&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> <span class="title class_">TalkWords</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;talkwords&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> <span class="title class_">TalkSub</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;talksub&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//定义空字符串</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="title class_">TalkWords</span>.<span class="property">value</span> == <span class="string">&quot;&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 消息为空时弹窗</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;消息不能为空&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> word = <span class="title class_">TalkWords</span>.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;talkwords&quot;</span>).<span class="property">value</span>=<span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      str = <span class="string">&#x27;&lt;div class=&quot;btalk&quot;&gt;&lt;span&gt;&#x27;</span> + word + <span class="string">&#x27;&lt;/span&gt;&lt;/div&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">Words</span>.<span class="property">innerHTML</span> = <span class="title class_">Words</span>.<span class="property">innerHTML</span> + str;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">add</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">url</span>: <span class="string">&#x27;/AiController/query&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">content</span>: word,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">beforeSend</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&quot;body&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;div id=&quot;load&quot; style=&quot;position:fixed;top:30%;z-index:1200;background:url(/static/admin/images/loading.gif) top center no-repeat;width:100%;height:140px;margin:auto auto;&quot;&gt;&lt;/div&gt;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">complete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&quot;#load&quot;</span>).<span class="title function_">remove</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">var</span> response = res.<span class="property">msg</span>;</span></span><br><span class="line"><span class="language-javascript">          str = <span class="string">&#x27;&lt;div class=&quot;atalk&quot;&gt;&lt;span&gt;&#x27;</span> + response + <span class="string">&#x27;&lt;/span&gt;&lt;/div&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">Words</span>.<span class="property">innerHTML</span> = <span class="title class_">Words</span>.<span class="property">innerHTML</span> + str;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">add</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;words&#x27;</span>).<span class="property">scrollTop</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;words&#x27;</span>).<span class="property">scrollHeight</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;talk_con&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;talk_show&quot;</span> <span class="attr">id</span>=<span class="string">&quot;words&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;atalk&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;asay&quot;</span>&gt;</span>您好：我是您的智能小助手Hibiki<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btalk&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;bsay&quot;</span>&gt;</span>你好<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;talk_input&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;whotalk&quot;</span> <span class="attr">id</span>=<span class="string">&quot;who&quot;</span> <span class="attr">value</span>=<span class="string">&quot;输入&quot;</span> <span class="attr">disabled</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;talk_word&quot;</span> <span class="attr">id</span>=<span class="string">&quot;talkwords&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;发送&quot;</span> <span class="attr">class</span>=<span class="string">&quot;talk_sub&quot;</span> <span class="attr">id</span>=<span class="string">&quot;talksub&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;send()&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在使用的页面引入按钮</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;pear-btn pear-btn-warming pear-btn-md&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;message()&quot;</span> <span class="attr">title</span>=<span class="string">&quot;智能小助手&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;layui-icon layui-icon-template&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>用layui打开弹窗</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">message</span>(<span class="params"></span>)&#123;</span><br><span class="line">  layer.<span class="title function_">open</span>(&#123;</span><br><span class="line">    <span class="comment">//layer提供了5种层类型。可传入的值有：0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）</span></span><br><span class="line">    <span class="attr">type</span>:<span class="number">2</span>,</span><br><span class="line">    <span class="attr">title</span>:<span class="string">&quot;智能助手&quot;</span>,</span><br><span class="line">    <span class="attr">area</span>: [<span class="string">&#x27;50%&#x27;</span>,<span class="string">&#x27;85%&#x27;</span>],</span><br><span class="line">    <span class="attr">content</span>:  rootPath + <span class="string">&quot;/AiController/view&quot;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>用js打开弹窗</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> screenWidth = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span>;</span><br><span class="line"><span class="keyword">var</span> screenHeight = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span>;</span><br><span class="line"><span class="keyword">var</span> popupWidth = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">var</span> popupHeight = <span class="number">600</span>;</span><br><span class="line"><span class="keyword">var</span> left = (screenWidth - popupWidth)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> top = (screenHeight - popupHeight)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> popupWindow = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;AI.html&#x27;</span>, <span class="string">&#x27;popup&#x27;</span>, <span class="string">&#x27;width=&#x27;</span> + popupWidth + <span class="string">&#x27;,height=&#x27;</span> + popupHeight + <span class="string">&#x27;,left=&#x27;</span> + left + <span class="string">&#x27;,top=&#x27;</span> + top);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用的镜像地址</title>
      <link href="/2024/04/23/%E5%B8%B8%E7%94%A8%E7%9A%84%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80/"/>
      <url>/2024/04/23/%E5%B8%B8%E7%94%A8%E7%9A%84%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80/</url>
      
        <content type="html"><![CDATA[<p>npm  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><p>nvm</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node_mirror: https://npmmirror.com/mirrors/node/</span><br><span class="line">npm_mirror: https://npmmirror.com/mirrors/npm/</span><br></pre></td></tr></table></figure><p>python</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install  -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</span><br></pre></td></tr></table></figure><p>kali</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">中科大 </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line"> </span><br><span class="line">阿里云 </span><br><span class="line">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line"> </span><br><span class="line">清华大学 </span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free </span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line"> </span><br><span class="line">说明：deb代表软件的位置，deb-src代表软件的源代码位置</span><br><span class="line"> </span><br><span class="line">配置kali apt为阿里源实例：</span><br><span class="line">配置思路方法 修改 /etc/apt/sources.list，加入以下内容将相关url改成阿里云的源。 </span><br><span class="line"> </span><br><span class="line">deb https://mirrors.aliyun.com/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src https://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最详细的MySQL部署</title>
      <link href="/2024/04/23/%E6%9C%80%E8%AF%A6%E7%BB%86%E7%9A%84MySQL%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/23/%E6%9C%80%E8%AF%A6%E7%BB%86%E7%9A%84MySQL%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="rpm安装MySQL"><a href="#rpm安装MySQL" class="headerlink" title="rpm安装MySQL"></a>rpm安装MySQL</h2><h3 id="先下载所需的包"><a href="#先下载所需的包" class="headerlink" title="先下载所需的包"></a>先下载所需的包</h3><p>分别下载 MySQL5.7的<code>common</code> 、<code>libs</code>、<code>client</code>、<code>server</code>4个RPM包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https://repo.huaweicloud.com/mysql/Downloads/MySQL-5.7/mysql-community-common-5.7.33-1.el6.x86_64.rpm</span><br><span class="line"></span><br><span class="line">wget https://repo.huaweicloud.com/mysql/Downloads/MySQL-5.7/mysql-community-libs-5.7.33-1.el6.x86_64.rpm</span><br><span class="line"></span><br><span class="line">wget https://repo.huaweicloud.com/mysql/Downloads/MySQL-5.7/mysql-community-client-5.7.33-1.el6.x86_64.rpm</span><br><span class="line"></span><br><span class="line">wget https://repo.huaweicloud.com/mysql/Downloads/MySQL-5.7/mysql-community-server-5.7.33-1.el6.x86_64.rpm</span><br></pre></td></tr></table></figure><h3 id="安装4个rmp包"><a href="#安装4个rmp包" class="headerlink" title="安装4个rmp包"></a>安装4个rmp包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh *.rpm --nodeps –-force</span><br></pre></td></tr></table></figure><h3 id="配置MySQL的配置文件"><a href="#配置MySQL的配置文件" class="headerlink" title="配置MySQL的配置文件"></a>配置MySQL的配置文件</h3><p>在&#x2F;etc&#x2F;my.cnf 里面配置<code>MySQL</code>的配置</p><h3 id="启动MySQL服务"><a href="#启动MySQL服务" class="headerlink" title="启动MySQL服务"></a>启动MySQL服务</h3><p>启动MySQL服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service mysqld start</span><br><span class="line">or</span><br><span class="line">systemctl start mysqld</span><br></pre></td></tr></table></figure><p>查看MySQL服务状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service mysqld status</span><br><span class="line">or</span><br><span class="line">systemctl status mysqld</span><br></pre></td></tr></table></figure><hr><h2 id="yum安装MySQL"><a href="#yum安装MySQL" class="headerlink" title="yum安装MySQL"></a>yum安装MySQL</h2><h3 id="先卸载MySQL"><a href="#先卸载MySQL" class="headerlink" title="先卸载MySQL"></a>先卸载MySQL</h3><p>查看旧的MySQL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep MySQL</span><br></pre></td></tr></table></figure><p>卸载所有 MySQL 服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e  xxxxxxxxxxxxx</span><br></pre></td></tr></table></figure><p>使用yum卸载MySQL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum list installed | grep mysql</span><br><span class="line">yum remove mysql</span><br></pre></td></tr></table></figure><h3 id="安装MySQL的yum源"><a href="#安装MySQL的yum源" class="headerlink" title="安装MySQL的yum源"></a>安装MySQL的yum源</h3><p>可以从下面这个网站选择对应的版本</p><blockquote><p><a href="http://repo.mysql.com/">http://repo.mysql.com/</a></p></blockquote><p>下载并安装yum源</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm</span><br></pre></td></tr></table></figure><ul><li>执行完毕后克可以查看源文件：&#x2F;etc&#x2F;yum.repos.d&#x2F;</li><li>会多出一个 MySQL 的 rpm 包和两个 MySQL 开头的源</li><li>该命令执行完成后，会在&#x2F;etc&#x2F;yum.repos.d&#x2F;目录下创建一个mysql-community.repo文件，这就是mysql的yum源</li><li>当然你也可通过命令的方式查看mysql的yum源是否安装成功。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist enabled | grep <span class="string">&quot;mysql.*-community.*&quot;</span></span><br></pre></td></tr></table></figure><h3 id="使用yum命令安装MySQL"><a href="#使用yum命令安装MySQL" class="headerlink" title="使用yum命令安装MySQL"></a>使用yum命令安装MySQL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-server</span><br></pre></td></tr></table></figure><p>出现 Complete！即表示安装成功。<br>然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep MySQL</span><br></pre></td></tr></table></figure><p>列出MySQL的服务，表示安装成功</p><h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld start</span><br></pre></td></tr></table></figure><hr><h2 id="Windows下使用文件夹安装"><a href="#Windows下使用文件夹安装" class="headerlink" title="Windows下使用文件夹安装"></a>Windows下使用文件夹安装</h2><h3 id="先到官网下载MySQL安装包"><a href="#先到官网下载MySQL安装包" class="headerlink" title="先到官网下载MySQL安装包"></a>先到官网下载MySQL安装包</h3><p>下载完成解压之后文件应该如下</p><p><img src="/img/posts/20240617013240.png">!</p><h3 id="创建一个my-ini文件"><a href="#创建一个my-ini文件" class="headerlink" title="创建一个my.ini文件"></a>创建一个my.ini文件</h3><p>添加数据的配置</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="params">#</span>设置3306端口号</span><br><span class="line">port=3306</span><br><span class="line"><span class="params">#</span>设置MySQL的安装目录</span><br><span class="line">basedir=</span><br><span class="line"><span class="params">#</span>设置MySQL数据库的数据存放目录</span><br><span class="line">datadir=</span><br><span class="line"><span class="params">#</span>运行最大连接数</span><br><span class="line">max<span class="built_in">_</span>connections=200</span><br><span class="line"><span class="params">#</span>运行连接失败的次数。</span><br><span class="line">max<span class="built_in">_</span>connect<span class="built_in">_</span>errors=10</span><br><span class="line"><span class="params">#</span>服务端使用的字符集默认为utf-8</span><br><span class="line">character-set-server=utf8</span><br><span class="line">[mysql]</span><br><span class="line"><span class="params">#</span>客户端使用的字符集默认为utf8</span><br><span class="line">default-character-set=utf8</span><br><span class="line">[client]</span><br><span class="line"><span class="params">#</span>客户端默认端口号为3306</span><br><span class="line">port=3306</span><br></pre></td></tr></table></figure><h3 id="安装（需要使用管理员打开CMD）"><a href="#安装（需要使用管理员打开CMD）" class="headerlink" title="安装（需要使用管理员打开CMD）"></a>安装（需要使用管理员打开CMD）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqld --install</span><br><span class="line">mysqld --initialize --console</span><br></pre></td></tr></table></figure><p>可以看到密码</p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>打开Windows的服务，找到MySQL然后启动</p><hr><h2 id="5-7版本修改root的密码"><a href="#5-7版本修改root的密码" class="headerlink" title="5.7版本修改root的密码"></a>5.7版本修改root的密码</h2><h3 id="查看MySQL的密码"><a href="#查看MySQL的密码" class="headerlink" title="查看MySQL的密码"></a>查看MySQL的密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /var/log/mysqld.log | grep password</span><br></pre></td></tr></table></figure><p>如果更改了MySQL的配置文件，需要在里面查看mysql的日志路径</p><h3 id="登录MySQL服务器"><a href="#登录MySQL服务器" class="headerlink" title="登录MySQL服务器"></a>登录MySQL服务器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p </span><br></pre></td></tr></table></figure><p>输入用户名密码，密码就是刚才看的</p><h3 id="修改root登录密码"><a href="#修改root登录密码" class="headerlink" title="修改root登录密码"></a>修改root登录密码</h3><p>登录状态下<br>设置密码校验强度为最低级别</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> global validate_password_policy=0;</span><br></pre></td></tr></table></figure><p>设置密码长度最少为4个字符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> global validate_password_length=4;</span><br></pre></td></tr></table></figure><p>修改密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;你的密码&#x27;</span>;</span><br></pre></td></tr></table></figure><p>刷新权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flush privileges; </span><br></pre></td></tr></table></figure><hr><h2 id="8-0版本修改密码"><a href="#8-0版本修改密码" class="headerlink" title="8.0版本修改密码"></a>8.0版本修改密码</h2><h3 id="先查看MySQL的密码"><a href="#先查看MySQL的密码" class="headerlink" title="先查看MySQL的密码"></a>先查看MySQL的密码</h3><h3 id="登录后到MySQL"><a href="#登录后到MySQL" class="headerlink" title="登录后到MySQL"></a>登录后到MySQL</h3><h3 id="修改密码策略"><a href="#修改密码策略" class="headerlink" title="修改密码策略"></a>修改密码策略</h3><p>查看密码策略</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;validate%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>修改策略</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--可以使用以下命令进行修改</span></span><br><span class="line"><span class="comment">--密码验证策略低要求(0或LOW代表低级)</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_policy<span class="operator">=</span>MEDIUM;</span><br><span class="line"></span><br><span class="line"><span class="comment">--密码至少要包含的小写字母个数和大写字母个数</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_mixed_case_count<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--密码至少要包含的数字个数。</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_number_count<span class="operator">=</span><span class="number">1</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">--密码至少要包含的特殊字符数</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_special_char_count<span class="operator">=</span><span class="number">1</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 密码长度</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_length<span class="operator">=</span><span class="number">6</span>;  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h3><p>如果密码为空直接修改</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">user</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;你的密码&#x27;</span>; </span><br></pre></td></tr></table></figure><p>如果不为空</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">with</span> mysql_native_password <span class="keyword">by</span> <span class="string">&#x27;你的密码&#x27;</span>;</span><br></pre></td></tr></table></figure><p>如果要远程连接改成<code>%</code></p><p>刷新权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>监测本地storage的数值变化</title>
      <link href="/2024/04/23/%E7%9B%91%E6%B5%8B%E6%9C%AC%E5%9C%B0storage%E7%9A%84%E6%95%B0%E5%80%BC%E5%8F%98%E5%8C%96/"/>
      <url>/2024/04/23/%E7%9B%91%E6%B5%8B%E6%9C%AC%E5%9C%B0storage%E7%9A%84%E6%95%B0%E5%80%BC%E5%8F%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h2><p>在前端开发中，我们经常需要在不同页面或不同标签页之间共享数据。<code>localStorage</code>是浏览器提供的一种持久化存储机制，可以在不同页面之间共享数据。但有时候，我们需要实时监听这些数据的变化，以便及时更新页面内容。本文将介绍如何监测本地<code>localStorage</code>的数值变化。</p><h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><p>浏览器提供了<code>storage</code>事件，当<code>localStorage</code>中的数据发生变化时，会触发该事件。需要注意的是，<strong>该事件只会在数据发生变化的页面以外的其他页面触发</strong>，即如果在当前页面修改了<code>localStorage</code>的值，当前页面不会触发<code>storage</code>事件，但其他打开的同域名页面会触发该事件。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听localStorage变化</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;storage&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="comment">// 检查是否是我们关心的键发生了变化</span></span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">key</span> === <span class="string">&#x27;curServer&#x27;</span>) &#123; </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;localStorage key &quot;curServer&quot; changed from:&#x27;</span>, event.<span class="property">oldValue</span>, <span class="string">&#x27;to:&#x27;</span>, event.<span class="property">newValue</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 根据新值重新加载表格数据</span></span><br><span class="line">    table.<span class="title function_">reload</span>(<span class="string">&#x27;var-table&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="variable constant_">MODULE_PATH</span> + <span class="string">&#x27;/&#x27;</span> + <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;curServer&quot;</span>) + <span class="string">&#x27;/globalVariables&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>这种技术在以下场景特别有用：</p><ol><li><strong>多标签页应用</strong>：用户在一个标签页中修改了设置，其他标签页需要同步更新</li><li><strong>实时数据同步</strong>：不同页面需要共享同一份数据，并在数据变化时同步更新</li><li><strong>用户偏好设置</strong>：用户更改了主题、语言等偏好设置，所有打开的页面都需要立即应用新设置</li></ol><h2 id="关于表格重载"><a href="#关于表格重载" class="headerlink" title="关于表格重载"></a>关于表格重载</h2><p>在使用表格组件（如Layui Table）时，表格初始化后的URL是固定的。如果数据源发生变化，需要通过<code>table.reload()</code>方法重新指定URL并刷新表格：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重载表格，更新数据源URL</span></span><br><span class="line">table.<span class="title function_">reload</span>(<span class="string">&#x27;table-id&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;新的数据源URL&#x27;</span>  <span class="comment">// 动态构建新的URL</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li><code>storage</code>事件只在值真正改变时触发，如果设置的值与原值相同，则不会触发事件</li><li>该事件不会在触发变化的当前页面中触发，只会在同域名的其他页面中触发</li><li>事件对象包含以下有用的属性：<ul><li><code>key</code>: 发生变化的键名</li><li><code>oldValue</code>: 变化前的值</li><li><code>newValue</code>: 变化后的值</li><li><code>storageArea</code>: 指向发生变化的 Storage 对象</li><li><code>url</code>: 触发该变化的页面的URL</li></ul></li></ol><p>通过这种方式，我们可以实现不同页面间的数据实时同步，提升用户体验。</p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给已经打好的jar包添加依赖jar包重新打包</title>
      <link href="/2024/04/23/%E7%BB%99%E5%B7%B2%E7%BB%8F%E6%89%93%E5%A5%BD%E7%9A%84jar%E5%8C%85%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96jar%E5%8C%85%E9%87%8D%E6%96%B0%E6%89%93%E5%8C%85/"/>
      <url>/2024/04/23/%E7%BB%99%E5%B7%B2%E7%BB%8F%E6%89%93%E5%A5%BD%E7%9A%84jar%E5%8C%85%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96jar%E5%8C%85%E9%87%8D%E6%96%B0%E6%89%93%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<h2 id="问题背景"><a href="#问题背景" class="headerlink" title="问题背景"></a>问题背景</h2><p>在Java开发中，有时我们需要给已经打包好的JAR文件添加额外的依赖库。这种情况通常发生在：</p><ol><li>没有源代码但需要扩展第三方JAR包功能</li><li>紧急修复生产环境中缺少的依赖</li><li>为特定环境添加驱动程序（如数据库驱动）</li><li>避免重新构建整个项目的耗时过程</li></ol><p>本文将介绍如何给已经打好的JAR包添加依赖，并重新打包。</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="方法一：手动解压添加依赖"><a href="#方法一：手动解压添加依赖" class="headerlink" title="方法一：手动解压添加依赖"></a>方法一：手动解压添加依赖</h3><p>这种方法适用于Spring Boot可执行JAR或普通JAR包。</p><h4 id="步骤详解"><a href="#步骤详解" class="headerlink" title="步骤详解"></a>步骤详解</h4><ol><li><p><strong>解压原始JAR包</strong></p><p>使用压缩软件（如WinRAR、7-Zip）或命令行解压JAR文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用命令行解压</span></span><br><span class="line"><span class="built_in">mkdir</span> jar-extract</span><br><span class="line"><span class="built_in">cd</span> jar-extract</span><br><span class="line">jar -xf ../original-app.jar</span><br></pre></td></tr></table></figure><p>解压后的目录结构通常如下（以Spring Boot JAR为例）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">jar-extract/</span><br><span class="line">├── BOOT-INF/</span><br><span class="line">│   ├── classes/      # 应用程序类文件</span><br><span class="line">│   └── lib/          # 依赖库</span><br><span class="line">├── META-INF/</span><br><span class="line">│   ├── MANIFEST.MF   # 清单文件</span><br><span class="line">│   └── ...</span><br><span class="line">└── org/              # Spring Boot Loader类</span><br></pre></td></tr></table></figure></li><li><p><strong>添加依赖JAR包</strong></p><p>将需要添加的依赖JAR包复制到<code>BOOT-INF/lib/</code>目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如添加MySQL驱动</span></span><br><span class="line"><span class="built_in">cp</span> /path/to/mysql-connector-java-8.0.28.jar jar-extract/BOOT-INF/lib/</span><br></pre></td></tr></table></figure><p>对于普通JAR包（非Spring Boot），可能没有<code>BOOT-INF/lib/</code>目录，这时可以创建一个新的目录来存放依赖：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p jar-extract/lib</span><br><span class="line"><span class="built_in">cp</span> /path/to/dependency.jar jar-extract/lib/</span><br></pre></td></tr></table></figure><p>然后修改<code>META-INF/MANIFEST.MF</code>文件，添加Class-Path条目：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class-Path: lib/dependency.jar</span><br></pre></td></tr></table></figure></li><li><p><strong>重新打包JAR文件</strong></p><p>进入解压目录，执行打包命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入解压目录</span></span><br><span class="line"><span class="built_in">cd</span> jar-extract</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新打包，保留原始MANIFEST.MF</span></span><br><span class="line">jar cvfm0 ../new-app.jar ./META-INF/MANIFEST.MF *</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li><code>c</code>: 创建新的JAR文件</li><li><code>v</code>: 生成详细输出</li><li><code>f</code>: 指定JAR文件名</li><li><code>m</code>: 包含指定的清单文件</li><li><code>0</code>: 不压缩（仅存储，加快打包速度）</li></ul></li></ol><h3 id="方法二：使用Maven-Shade-Plugin（有源码情况下）"><a href="#方法二：使用Maven-Shade-Plugin（有源码情况下）" class="headerlink" title="方法二：使用Maven Shade Plugin（有源码情况下）"></a>方法二：使用Maven Shade Plugin（有源码情况下）</h3><p>如果你有项目源码，可以使用Maven Shade Plugin将依赖打包进JAR：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactSet</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">include</span>&gt;</span>mysql:mysql-connector-java<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">artifactSet</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="方法三：使用JarUpdate工具"><a href="#方法三：使用JarUpdate工具" class="headerlink" title="方法三：使用JarUpdate工具"></a>方法三：使用JarUpdate工具</h3><p>对于简单的JAR更新，可以使用Java自带的jar工具的更新功能：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将新的文件添加到现有JAR中</span></span><br><span class="line">jar -uf original-app.jar -C /path/to/files/ .</span><br></pre></td></tr></table></figure><h2 id="实际案例：添加MySQL驱动到Spring-Boot应用"><a href="#实际案例：添加MySQL驱动到Spring-Boot应用" class="headerlink" title="实际案例：添加MySQL驱动到Spring Boot应用"></a>实际案例：添加MySQL驱动到Spring Boot应用</h2><p>下面是一个完整的实例，演示如何给Spring Boot应用添加MySQL驱动：</p><ol><li><p><strong>解压原始JAR包</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> app-extract</span><br><span class="line"><span class="built_in">cd</span> app-extract</span><br><span class="line">jar -xf ../yaay-app-user.jar</span><br></pre></td></tr></table></figure></li><li><p><strong>添加MySQL驱动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载MySQL驱动（如果没有）</span></span><br><span class="line">wget https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.28/mysql-connector-java-8.0.28.jar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制到lib目录</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-8.0.28.jar BOOT-INF/lib/</span><br></pre></td></tr></table></figure></li><li><p><strong>重新打包</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jar cvfm0 ../yaay-app-user-with-mysql.jar ./META-INF/MANIFEST.MF *</span><br></pre></td></tr></table></figure></li><li><p><strong>验证新JAR包</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出JAR包内容，确认驱动已添加</span></span><br><span class="line">jar -tf ../yaay-app-user-with-mysql.jar | grep mysql</span><br></pre></td></tr></table></figure></li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li><strong>版本兼容性</strong>：确保添加的依赖与应用程序兼容，特别是版本号</li><li><strong>清单文件</strong>：保留原始的MANIFEST.MF文件，尤其是Main-Class和Start-Class条目</li><li><strong>JAR签名</strong>：如果原始JAR已签名，添加新依赖后需要重新签名</li><li><strong>类路径冲突</strong>：注意可能的类路径冲突和依赖重复</li><li><strong>文件大小</strong>：添加依赖会增加JAR文件大小，可能影响部署和启动时间</li></ol><h2 id="替代方案"><a href="#替代方案" class="headerlink" title="替代方案"></a>替代方案</h2><ol><li><strong>外部依赖</strong>：将依赖放在外部目录，通过<code>-Dloader.path</code>参数指定（Spring Boot应用）</li><li><strong>容器管理</strong>：在应用服务器中配置共享库</li><li><strong>重新构建</strong>：如果可能，最好从源码重新构建，确保依赖正确管理</li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>给已打包的JAR添加依赖是一种应急解决方案，适用于无法立即重新构建项目的情况。通过解压JAR包、添加依赖文件并重新打包，可以快速解决依赖缺失问题。但从长期来看，建议在源码级别正确管理依赖，使用Maven或Gradle等构建工具进行标准化构建。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/executable-jar.html">Spring Boot 可执行JAR格式</a></li><li><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jar.html">Java JAR命令文档</a></li><li>原文链接：<a href="https://blog.csdn.net/itwxming/article/details/104478226">https://blog.csdn.net/itwxming/article/details/104478226</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>获取汉字拼音首字母</title>
      <link href="/2024/04/23/%E8%8E%B7%E5%8F%96%E6%B1%89%E5%AD%97%E6%8B%BC%E9%9F%B3%E9%A6%96%E5%AD%97%E6%AF%8D/"/>
      <url>/2024/04/23/%E8%8E%B7%E5%8F%96%E6%B1%89%E5%AD%97%E6%8B%BC%E9%9F%B3%E9%A6%96%E5%AD%97%E6%AF%8D/</url>
      
        <content type="html"><![CDATA[<blockquote><p>添加所需的依赖</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.belerweb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建一个方法来，转换拼音</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getPinYinHeadChar</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isNull(str)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">convert</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; str.length(); j++) &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">word</span> <span class="operator">=</span> str.charAt(j);</span><br><span class="line">        <span class="comment">// 提取汉字的首字母</span></span><br><span class="line">        String[] pinyinArray = PinyinHelper.toHanyuPinyinStringArray(word);</span><br><span class="line">        <span class="keyword">if</span> (pinyinArray != <span class="literal">null</span>) &#123;</span><br><span class="line">            convert += pinyinArray[<span class="number">0</span>].charAt(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            convert += word;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    convert = string2AllTrim(convert);</span><br><span class="line">    <span class="keyword">return</span> convert.toLowerCase();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>其中PinyinHelper的方法能将汉字字符串转换成首字母拼音的字符串数组</em></p><p>main方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> PingYinUtil.getPinYinHeadChar(<span class="string">&quot;支付宝&quot;</span>);</span><br><span class="line">    System.out.println(s);</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; str = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    List&lt;String&gt; pin = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    List&lt;String&gt; level = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="string">&quot;D:\\bin\\桌面\\h_fever_outpatient_org_info.xlsx&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//创建工作簿对象</span></span><br><span class="line">        <span class="type">XSSFWorkbook</span> <span class="variable">xssfWorkbook</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(fileName));</span><br><span class="line">        <span class="comment">//获取工作簿下sheet的个数</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">sheetNum</span> <span class="operator">=</span> xssfWorkbook.getNumberOfSheets();</span><br><span class="line">        System.out.println(<span class="string">&quot;该excel文件中总共有：&quot;</span>+sheetNum+<span class="string">&quot;个sheet&quot;</span>);</span><br><span class="line">        <span class="comment">//遍历工作簿中的所有数据</span></span><br><span class="line">        List&lt;Grade&gt; grades = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;sheetNum;i++) &#123;</span><br><span class="line">            <span class="comment">//读取第i个工作表</span></span><br><span class="line">            System.out.println(<span class="string">&quot;读取第&quot;</span>+(i+<span class="number">1</span>)+<span class="string">&quot;个sheet&quot;</span>);</span><br><span class="line">            <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> xssfWorkbook.getSheetAt(i);</span><br><span class="line">            <span class="comment">//获取最后一行的num，即总行数。此处从0开始</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">maxRow</span> <span class="operator">=</span> sheet.getLastRowNum();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> <span class="number">0</span>; row &lt;= maxRow; row++) &#123;</span><br><span class="line">                <span class="comment">//获取最后单元格num，即总单元格数 ***注意：此处从1开始计数***</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">maxRol</span> <span class="operator">=</span> sheet.getRow(row).getLastCellNum();</span><br><span class="line">                <span class="comment">// System.out.println(&quot;--------第&quot; + row + &quot;行的数据如下--------&quot;);</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> sheet.getRow(row).getCell(<span class="number">0</span>).toString();</span><br><span class="line">                str.add(a);</span><br><span class="line">                pin.add(PingYinUtil.getPinYinHeadChar(a));</span><br><span class="line">                level.add(sheet.getRow(row).getCell(<span class="number">2</span>).toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (<span class="comment">//创建工作薄对象</span></span><br><span class="line">             <span class="type">SXSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SXSSFWorkbook</span>()) &#123;</span><br><span class="line">            <span class="comment">//创建工作表对象</span></span><br><span class="line">            <span class="type">SXSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.createSheet();</span><br><span class="line">            <span class="comment">//创建工作表的行</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;str.size();i++)&#123;</span><br><span class="line">                <span class="type">SXSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(i);<span class="comment">//设置第一行，从零开始</span></span><br><span class="line">                row.createCell(<span class="number">0</span>).setCellValue(str.get(i));<span class="comment">//第一行第一列为</span></span><br><span class="line">                row.createCell(<span class="number">1</span>).setCellValue(pin.get(i));<span class="comment">//第一行第二列为日期</span></span><br><span class="line">                row.createCell(<span class="number">2</span>).setCellValue(level.get(i));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            workbook.setSheetName(<span class="number">0</span>,<span class="string">&quot;sheet&quot;</span>);<span class="comment">//设置sheet的Name</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//文档输出</span></span><br><span class="line">            <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;D:\\bin\\桌面\\&quot;</span> + <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMddHHmmss&quot;</span>).format(<span class="keyword">new</span> <span class="title class_">Date</span>()).toString() +<span class="string">&quot;.xlsx&quot;</span>);</span><br><span class="line">            workbook.write(out);</span><br><span class="line">            out.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL字节超长</title>
      <link href="/2024/04/21/MYSQL%20%20ERROR%201118%20(42000)%20Row%20size%20too%20large/"/>
      <url>/2024/04/21/MYSQL%20%20ERROR%201118%20(42000)%20Row%20size%20too%20large/</url>
      
        <content type="html"><![CDATA[<p>报错信息如下：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ERROR</span> <span class="string">1118 (42000): Row size too large. </span></span><br><span class="line"> <span class="attr">The</span> <span class="string">maximum row size for the used table type, not counting BLOBs, is 65535. </span></span><br><span class="line"> <span class="attr">This</span> <span class="string">includes storage overhead, check the manual. </span></span><br><span class="line"> <span class="attr">You</span> <span class="string">have to change some columns to TEXT or BLOBs</span></span><br></pre></td></tr></table></figure><p>报错的信息很简单，就是创建表的时候，所有字段的字节长度加起来超过了65535</p><p>解决的办法就是:<br><strong>将长的字段格式改成longtext 或者是 longblob</strong></p><p><em>这两个类型的区别是：如果存放二进制文件就用longblob，如果存放长文本，就用longtext</em></p><p>到这里基本能解决了</p><h3 id="！！！"><a href="#！！！" class="headerlink" title="！！！"></a><code>！！！</code></h3><p>如果还是爆超长，则需要查看数据库的字符集类型<br>需要注意一下字符集：</p><p><strong>utf8与utf8mb4区别</strong></p><blockquote><p>utf8 使用1~4个字节，一种变长的编码格式，字符编码。utf8mb4 即most bytes 4，使用4个字节来表示完整的UTF-8</p></blockquote><p>结论：如果数据库的字符集是utf8mb4，那就改成utf8，<del><em>嗯，排序规则也改</em></del> ，65535其实是字节长度，如果是utf8mb4，会算成4个字节，很容易就会超长。</p>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginx</title>
      <link href="/2024/04/21/nginx/"/>
      <url>/2024/04/21/nginx/</url>
      
        <content type="html"><![CDATA[<h2 id="Ngixn-部分功能介绍"><a href="#Ngixn-部分功能介绍" class="headerlink" title="Ngixn 部分功能介绍"></a>Ngixn 部分功能介绍</h2><h3 id="1-http服务器"><a href="#1-http服务器" class="headerlink" title="1.http服务器"></a>1.http服务器</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">当只有静态资源的时候，可以使用Nginx做HTTP服务器，可以将服务器上的静态文件（如HTML、图片）通过HTTP协议展现给客户端。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">动静分离常用于前后端分离，Nginx提供的动静分离是指把动态请求和静态请求分离开，合适的服务器处理相应的请求，使整个服务器系统的性能、效率更高。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Nginx可以根据配置对不同的请求做不同转发，这是动静分离的基础。静态请求对应的静态资源可以直接放在Nginx上做缓冲，更好的做法是放在相应的缓冲服务器上。动态请求由相应的后端服务器处理。</span></span><br></pre></td></tr></table></figure><h3 id="2-正向代理和反向代理"><a href="#2-正向代理和反向代理" class="headerlink" title="2.正向代理和反向代理"></a>2.正向代理和反向代理</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">正向代理：</span></span><br><span class="line"></span><br><span class="line"><span class="attr">正向代理，是一个位于客户端与原始服务器之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定原始目标（原始服务器），然后代理向原始服务器转交请求并将获得的内容返回给客户端。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">反向代理：</span></span><br><span class="line"></span><br><span class="line"><span class="attr">客户端本来可以直接通过HTTP协议访问某网站应用服务器，网站管理员可以在中间加上一个Nginx，客户端请求Nginx，Nginx请求应用服务器，然后将结果返回给客户端，此时Nginx就是反向代理服务器。</span></span><br></pre></td></tr></table></figure><h3 id="3-负载均衡"><a href="#3-负载均衡" class="headerlink" title="3.负载均衡"></a>3.负载均衡</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">负载均衡多在高并发情况下需要使用。原理是将数据流量分摊到多个服务器执行，减轻每台服务器的压力，多台服务器(集群)共同完成工作任务，从而提高了数据的吞吐量。同时带来的好处是，其中一台服务器万一宕机，只要还有其他服务器正常运行，就不会影响用户使用。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Nginx可以通过反向代理来实现负载均衡。Nginx可使用的负载均衡策略有：轮询（默认）、权重、ip_hash、url_hash(第三方模块)、fair(第三方模块)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">weight轮询（默认）：接收到的请求按照顺序逐一分配到不同的后端服务器，即使在使用过程中，某一台后端服务器宕机，nginx会自动将该服务器剔除出队列，请求受理情况不会受到任何影响。</span> <span class="string">这种方式下，可以给不同的后端服务器设置一个权重值（weight），用于调整不同的服务器上请求的分配率；权重数据越大，被分配到请求的几率越大；该权重值，主要是针对实际工作环境中不同的后端服务器硬件配置进行调整的。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">ip_hash：每个请求按照发起客户端的ip的hash结果进行匹配，这样的算法下一个固定ip地址的客户端总会访问到同一个后端服务器，这也在一定程度上解决了集群部署环境下session共享的问题。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">fair：智能调整调度算法，动态的根据后端服务器的请求处理到响应的时间进行均衡分配，响应时间短处理效率高的服务器分配到请求的概率高，响应时间长处理效率低的服务器分配到的请求少；结合了前两者的优点的一种调度算法。nginx默认不支持fair算法，如果要使用这种调度算法，需安装upstream_fair模块。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">url_hash：按照访问的url的hash结果分配请求，每个请求的url会指向后端固定的某个服务器，可以在nginx作为静态服务器的情况下提高缓存效率。nginx默认不支持这种调度算法，要使用的话需要安装nginx的hash软件包。</span> <span class="string"></span></span><br></pre></td></tr></table></figure><h3 id="4-Nginx模块"><a href="#4-Nginx模块" class="headerlink" title="4.Nginx模块"></a>4.Nginx模块</h3><h4 id="4-1-nginx状态信息"><a href="#4-1-nginx状态信息" class="headerlink" title="4.1 nginx状态信息"></a>4.1 nginx状态信息</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nginx中的stub_status模块主要用于查看Nginx的一些状态信息。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">本模块默认是不会编译进Nginx的,如果要使用该模块,则要在编译安装Nginx时指定。</span> <span class="string"></span></span><br></pre></td></tr></table></figure><h4 id="4-1-1-加载http-stub-status模块"><a href="#4-1-1-加载http-stub-status模块" class="headerlink" title="4.1.1 加载http_stub_status模块"></a>4.1.1 加载http_stub_status模块</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attr">./configure</span> <span class="string">--prefix=/usr/local/nginx --with-http_stub_status_module</span></span><br><span class="line"><span class="attr">make</span> <span class="string">&amp;&amp; make install</span></span><br></pre></td></tr></table></figure><h4 id="4-1-2-修改nginx配置文件"><a href="#4-1-2-修改nginx配置文件" class="headerlink" title="4.1.2 修改nginx配置文件"></a>4.1.2 修改nginx配置文件</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">在server中，添加如下代码：</span></span><br><span class="line"></span><br><span class="line"><span class="attr">location</span> <span class="string">/NginxStatus &#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">stub_status</span> <span class="string">on;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">access_log</span> <span class="string">on;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">auth_basic</span> <span class="string">&quot;NginxStatus&quot;;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">auth_basic_user_file</span> <span class="string">htpasswd;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">命令行操作：</span></span><br><span class="line"></span><br><span class="line"><span class="attr">htpasswd</span> <span class="string">-c /usr/local/nginx/conf/htpasswd nginx_focus #连续输入两次密码</span></span><br><span class="line"></span><br><span class="line"><span class="attr">New</span> <span class="string">password:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Re-type</span> <span class="string">new password:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Adding</span> <span class="string">password for user nginx_focus</span></span><br></pre></td></tr></table></figure><h4 id="4-1-3-打开nginx-的stub-status"><a href="#4-1-3-打开nginx-的stub-status" class="headerlink" title="4.1.3 打开nginx 的stub_status"></a>4.1.3 打开nginx 的stub_status</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">可以通过页面链接看到如下信息</span>:<span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="attr">Active</span> <span class="string">connections: 145</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server</span> <span class="string">accepts handled requests</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">1749</span> <span class="string">1749 3198</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Reading</span>: <span class="string">0 Writing: 3 Waiting: 142</span></span><br><span class="line"></span><br><span class="line"><span class="attr">参数详解：</span>  <span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="attr">Active</span> <span class="string">connections：145           </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#nginx 正处理的活动连接数145个。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server</span> <span class="string">accepts handled requests</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">1749</span> <span class="string">1749 3198                   </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#nginx启动到现在共处理了 1749个连接 ,nginx启动到现在共成功创建 1749次握手 请求丢失数=(握手-连接),可以看出，我们没丢请求;总共处理了3198 次请求。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Reading</span>: <span class="string">0 Writing: 3 Waiting: 142</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#Reading ：nginx读取到客户端的Header信息数。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#Writing ： nginx返回给客户端的Header信息数。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#Waiting ： Nginx已经处理完正在等候下一次请求指令的驻留连接.开启keep-alive的情况下,这个值等于active–(reading+writing)。 </span></span><br></pre></td></tr></table></figure><h4 id="4-1-4-访问量统计"><a href="#4-1-4-访问量统计" class="headerlink" title="4.1.4 访问量统计"></a>4.1.4 访问量统计</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1、叙述</span></span><br><span class="line"></span><br><span class="line"><span class="attr">PV（Page</span> <span class="string">View）：即页面浏览量或者点击量，用户每一次对网站中每个页面访问均记录1个PV。用户对同一页面的多次访问，访问量累积。</span></span><br><span class="line"><span class="attr">UV（Unique</span> <span class="string">Visitor）：指通过互联网浏览这个网页的人，电脑称为一个访客、手机也称为一个访客，一天之内相同的客户端只能被计算一次。</span></span><br><span class="line"><span class="attr">IP（Internet</span> <span class="string">Protocol）：指独立IP访问站点的IP总数，一天内相同IP只能算一次。</span></span><br><span class="line"><span class="attr">VV（Visit</span> <span class="string">View）：指所有访客一天内访问网站的次数，当访客完成所有浏览并最终关闭网站的所有页面时变完成了一次访问，同一访客一天内可能有多次访问行为，访问次数累积。 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">1.根据访问IP统计UV</span></span><br><span class="line"></span><br><span class="line"><span class="attr">awk</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;  access.log|sort | uniq -c |wc -l</span></span><br><span class="line"></span><br><span class="line"><span class="attr">2.统计访问URL统计PV</span></span><br><span class="line"></span><br><span class="line"><span class="attr">awk</span> <span class="string">&#x27;&#123;print $7&#125;&#x27; access.log|wc -l</span></span><br><span class="line"></span><br><span class="line"><span class="attr">3.查询访问最频繁的URL</span></span><br><span class="line"></span><br><span class="line"><span class="attr">awk</span> <span class="string">&#x27;&#123;print $7&#125;&#x27; access.log|sort | uniq -c |sort -n -k 1 -r|more</span></span><br><span class="line"></span><br><span class="line"><span class="attr">4.查询访问最频繁的IP</span></span><br><span class="line"></span><br><span class="line"><span class="attr">awk</span> <span class="string">&#x27;&#123;print $1&#125;&#x27; access.log|sort | uniq -c |sort -n -k 1 -r|more</span></span><br><span class="line"></span><br><span class="line"><span class="attr">5.根据时间段统计查看日志</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">cat</span>  <span class="string">access.log| sed -n  &#x27;/14\/Mar\/2015:21/,/14\/Mar\/2015:22/p&#x27;|more </span></span><br></pre></td></tr></table></figure><h4 id="4-2-nginx健康检查机制"><a href="#4-2-nginx健康检查机制" class="headerlink" title="4.2 nginx健康检查机制"></a>4.2 nginx健康检查机制</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nginx原生的健康检测主要涉及两个模块</span>:<span class="string">ngx_http_proxy_module和ngx_http_upstream_module </span></span><br></pre></td></tr></table></figure><h4 id="4-2-1-ngx-http-proxy-module"><a href="#4-2-1-ngx-http-proxy-module" class="headerlink" title="4.2.1 ngx_http_proxy_module"></a>4.2.1 ngx_http_proxy_module</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">upstream</span> <span class="string">backend &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">server</span> <span class="string">127.0.0.1:8080 max_fails=3 fail_timeout=30s;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">1.max_fails</span></span><br><span class="line"></span><br><span class="line"><span class="attr">设定Nginx与服务器通信的尝试失败的次数。在fail_timeout参数定义的时间段内，如果失败的次数达到此值，Nginx就认为服务器不可用。在下一个fail_timeout时间段，服务器不会再被尝试。</span> <span class="string">失败的尝试次数默认是1。设为0就会停止统计尝试次数，认为服务器是一直可用的。 你可以通过指令proxy_next_upstream、fastcgi_next_upstream和 memcached_next_upstream来配置什么是失败的尝试。 默认配置时，http_404状态不被认为是失败的尝试。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">2.fail_timeout</span></span><br><span class="line"></span><br><span class="line"><span class="attr">设定服务器被认为不可用的时间段以及统计失败尝试次数的时间段。在这段时间中，服务器失败次数达到指定的尝试次数，服务器就被认为不可用。默认情况下，该超时时间是10秒。</span> <span class="string"></span></span><br></pre></td></tr></table></figure><h4 id="4-2-2-ngx-http-proxy-module"><a href="#4-2-2-ngx-http-proxy-module" class="headerlink" title="4.2.2 ngx_http_proxy_module"></a>4.2.2 ngx_http_proxy_module</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1.proxy_connect_timeout</span></span><br><span class="line"></span><br><span class="line"><span class="attr">与后端服务器建立连接的超时时间</span></span><br><span class="line"></span><br><span class="line"><span class="attr">2.proxy_read_timeout</span></span><br><span class="line"></span><br><span class="line"><span class="attr">定义从后端服务器读取响应的超时。此超时是指相邻两次读操作之间的最长时间间隔，而不是整个响应传输完成的最长时间。如果后端服务器在超时时间段内没有传输任何数据，连接将被关闭</span></span><br><span class="line"></span><br><span class="line"><span class="attr">3.proxy_next_upstream</span></span><br><span class="line"></span><br><span class="line"><span class="attr">指定在何种情况下一个失败的请求应该被发送到下一台后端服务器</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="attr">需要理解一点的是，只有在没有向客户端发送任何数据以前，将请求转给下一台后端服务器才是可行的。也就是说，如果在传输响应到客户端时出现错误或者超时，这类错误是不可能恢复的。</span> <span class="string"></span></span><br></pre></td></tr></table></figure><h2 id="zookeeper"><a href="#zookeeper" class="headerlink" title="zookeeper"></a>zookeeper</h2><h3 id="1-zookeeper-概述"><a href="#1-zookeeper-概述" class="headerlink" title="1. zookeeper 概述"></a>1. zookeeper 概述</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">zookeeper是一种观察者模式的设计模式。负责管理存储数据，然后接受观察者的注册，一旦数据的状态发生变化，zookeeper就将负责通知已经在zookeeper上注册的那些观察者做出相应的反应</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>观察者模式</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">观察者模式是一种对象行为模式。它定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。在观察者模式中，主体是通知的发布者，它发出通知时并不需要知道谁是它的观察者，可以有任意数目的观察者订阅并接收通知。观察者模式不仅被广泛应用于软件界面元素之间的交互，在业务对象之间的交互、权限管理等方面也有广泛的应用。</span></span><br></pre></td></tr></table></figure><h3 id="2-zookeeper的特点"><a href="#2-zookeeper的特点" class="headerlink" title="2. zookeeper的特点"></a>2. zookeeper的特点</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1.</span> <span class="string">zookeeper是一个领导者和多个跟随着组成的集群。</span></span><br><span class="line"><span class="attr">2.</span> <span class="string">集群中只w要有半数以上的节点存活，zookeeper集群就能正常服务</span></span><br><span class="line"><span class="attr">3.</span> <span class="string">全局数据一直：每个service保存一份相同的数据副本，client无论连接到哪个service，数据都是一致的</span></span><br><span class="line"><span class="attr">4.</span> <span class="string">更新顺序执行</span></span><br><span class="line"><span class="attr">5.</span> <span class="string">数据更新原子性，要么成功要么失败</span></span><br><span class="line"><span class="attr">6.</span> <span class="string">实时性，能读到最新数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-zookeeper-的应用场景"><a href="#3-zookeeper-的应用场景" class="headerlink" title="3. zookeeper 的应用场景"></a>3. zookeeper 的应用场景</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wallpaper视频一键转移</title>
      <link href="/2024/04/21/wallpaper%E8%A7%86%E9%A2%91%E4%B8%80%E9%94%AE%E8%BD%AC%E7%A7%BB/"/>
      <url>/2024/04/21/wallpaper%E8%A7%86%E9%A2%91%E4%B8%80%E9%94%AE%E8%BD%AC%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><p>将wallpaper目录下面的视频转移到自己所需的目录下面</p><hr><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>三个输入：</p><h5 id="第一个输入的是wallpaper存放壁纸的地址"><a href="#第一个输入的是wallpaper存放壁纸的地址" class="headerlink" title="第一个输入的是wallpaper存放壁纸的地址"></a>第一个输入的是wallpaper存放壁纸的地址</h5><p><img src="https://s3.bmp.ovh/imgs/2024/04/21/31a2eade7b26ed2f.png"></p><p>其中地址就为</p><p>E:\steam\Steam\steamapps\workshop\content\431960</p><p>如果不知道也可以右键壁纸查看 </p><h5 id="第二个输入的是下载的时间，"><a href="#第二个输入的是下载的时间，" class="headerlink" title="第二个输入的是下载的时间，"></a>第二个输入的是下载的时间，</h5><p>意思就是从哪个时间开始的壁纸，就比如2022-12-4-19-0，就会找12月4号下午七点以后下载的壁纸</p><h5 id="第三个输入的是存放地址"><a href="#第三个输入的是存放地址" class="headerlink" title="第三个输入的是存放地址"></a>第三个输入的是存放地址</h5><p>这个就填要存放在哪里的地址。可以是电脑的，也可以把手机连上直接下载</p><hr><h3 id="所需依赖："><a href="#所需依赖：" class="headerlink" title="所需依赖："></a>所需依赖：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="更新了方法"><a href="#更新了方法" class="headerlink" title="更新了方法"></a>更新了方法</h3><ul><li><p>使用了线程池，线程池的数量等于cpu核处理速度最快</p></li><li><p>使用了Files.copy方法，使用该方法在复制小文件的过程中速度比BufferedInputStream更快</p></li><li><p>使用了synchronizedList来统计文件的个数，因为此集合是线程安全的。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.StandardCopyOption;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WallPaper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ParseException, InterruptedException &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd-HH-mm&quot;</span>);</span><br><span class="line">        List&lt;String&gt; list = Collections.synchronizedList(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;());</span><br><span class="line"></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入wallpaper下载的地址&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        <span class="type">File</span> <span class="variable">sfile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(str);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入时间(格式为:年-月-日-小时-分钟)&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">time</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> sdf.parse(time);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入需要存放的地址&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        <span class="type">File</span> <span class="variable">tfile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(str2);</span><br><span class="line">        <span class="keyword">if</span> (!tfile.exists() &amp;&amp; !tfile.isDirectory()) &#123;</span><br><span class="line">            tfile = <span class="keyword">new</span> <span class="title class_">File</span>(tfile.getParentFile(), <span class="string">&quot;wallpaper下载的视频&quot;</span>);</span><br><span class="line">            System.out.println(tfile.getAbsolutePath());</span><br><span class="line">            tfile.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!sfile.exists() &amp;&amp; !sfile.isDirectory()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;地址不对哦&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sfile.isDirectory()) &#123;</span><br><span class="line">            File[] fs = sfile.listFiles();</span><br><span class="line">            <span class="type">File</span> <span class="variable">finalTfile</span> <span class="operator">=</span> tfile;</span><br><span class="line">            <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">assert</span> fs != <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * *先统计文件的个数</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (File x : fs) &#123;</span><br><span class="line">                <span class="type">Date</span> <span class="variable">date1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(x.lastModified());</span><br><span class="line">                <span class="keyword">if</span> (date1.compareTo(date) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">needFilename</span> <span class="operator">=</span> x.getAbsolutePath() + <span class="string">&quot;\\project.json&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">File</span>(needFilename).exists()) &#123;</span><br><span class="line">                        flag = isNeedFile(needFilename);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                        tmp++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">CountDownLatch</span> <span class="variable">cdl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(tmp);</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             *多线程进行复制</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="type">Date</span> <span class="variable">startDate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">            <span class="keyword">for</span> (File x : fs) &#123;</span><br><span class="line">                executor.submit(</span><br><span class="line">                        () -&gt; &#123;</span><br><span class="line">                            <span class="type">Date</span> <span class="variable">date1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(x.lastModified());</span><br><span class="line">                            <span class="keyword">if</span> (date1.compareTo(date) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                                <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">                                <span class="type">String</span> <span class="variable">needFilename</span> <span class="operator">=</span> x.getAbsolutePath() + <span class="string">&quot;\\project.json&quot;</span>;</span><br><span class="line">                                <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">File</span>(needFilename).exists()) &#123;</span><br><span class="line">                                    flag = isNeedFile(needFilename);</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                                    <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> x.getAbsolutePath() + <span class="string">&quot;\\&quot;</span> + Filename(needFilename);</span><br><span class="line">                                    <span class="type">File</span> <span class="variable">tf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(finalTfile.getAbsoluteFile() + <span class="string">&quot;\\&quot;</span> + Filename(needFilename));</span><br><span class="line">                                    <span class="keyword">try</span> &#123;</span><br><span class="line">                                        copyfile(<span class="keyword">new</span> <span class="title class_">File</span>(filename), tf);</span><br><span class="line">                                        <span class="keyword">synchronized</span> (list)&#123;</span><br><span class="line">                                            list.add(<span class="string">&quot;成功&quot;</span>);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        System.out.println(<span class="string">&quot;将 &quot;</span> + Filename(needFilename) + <span class="string">&quot;  复制到 &quot;</span> + finalTfile.getAbsolutePath() + <span class="string">&quot; 中&quot;</span>);</span><br><span class="line">                                    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                        e.printStackTrace();</span><br><span class="line">                                        System.out.println(Filename(needFilename) + <span class="string">&quot;复制失败&quot;</span>);</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                    cdl.countDown();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            cdl.await();</span><br><span class="line">            executor.shutdown();</span><br><span class="line">            System.out.println(<span class="string">&quot;复制完成，共&quot;</span> + list.size() + <span class="string">&quot;个文件&quot;</span>);</span><br><span class="line">            <span class="type">Date</span> <span class="variable">endDate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">            System.out.println(endDate.getTime()-startDate.getTime());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;地址不对哦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//复制文件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span>  <span class="title function_">copyfile</span><span class="params">(File fs, File ft)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ft.exists()) &#123;</span><br><span class="line">            System.out.println(ft.getName() + <span class="string">&quot;重复....&quot;</span> + <span class="string">&quot;正在删除&quot;</span>);</span><br><span class="line">            ft.delete();</span><br><span class="line">        &#125;</span><br><span class="line">        Files.copy(fs.toPath(),ft.toPath(),StandardCopyOption.REPLACE_EXISTING);</span><br><span class="line"><span class="comment">//        FileInputStream fi = new FileInputStream(fs);</span></span><br><span class="line"><span class="comment">//        FileOutputStream fo = new FileOutputStream(ft);</span></span><br><span class="line"><span class="comment">//        BufferedInputStream bfi = null;</span></span><br><span class="line"><span class="comment">//        BufferedOutputStream bfo = null;</span></span><br><span class="line"><span class="comment">//        bfi = new BufferedInputStream(fi);</span></span><br><span class="line"><span class="comment">//        bfo = new BufferedOutputStream(fo);</span></span><br><span class="line"><span class="comment">//        int count = -1;</span></span><br><span class="line"><span class="comment">//        while ((count = bfi.read()) != -1) &#123;</span></span><br><span class="line"><span class="comment">//            bfo.write(count);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        bfo.flush();</span></span><br><span class="line"><span class="comment">//        bfo.close();</span></span><br><span class="line"><span class="comment">//        bfi.close();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//查找是否是所需的视频文件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isNeedFile</span><span class="params">(String filename)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> readJsonFile(filename);</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jobj</span> <span class="operator">=</span> JSON.parseObject(s);</span><br><span class="line">        <span class="keyword">if</span> (jobj.get(<span class="string">&quot;contentrating&quot;</span>) != <span class="literal">null</span> &amp;&amp; !jobj.get(<span class="string">&quot;contentrating&quot;</span>).equals(<span class="string">&quot;&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span> jobj.get(<span class="string">&quot;contentrating&quot;</span>).toString().equals(<span class="string">&quot;Mature&quot;</span>) &amp;&amp; (jobj.get(<span class="string">&quot;type&quot;</span>).toString().equals(<span class="string">&quot;Video&quot;</span>) || jobj.get(<span class="string">&quot;type&quot;</span>).toString().equals(<span class="string">&quot;video&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Filename</span><span class="params">(String filename)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> readJsonFile(filename);</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jobj</span> <span class="operator">=</span> JSON.parseObject(s);</span><br><span class="line">        <span class="keyword">return</span> jobj.get(<span class="string">&quot;file&quot;</span>).toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//读取json文件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">readJsonFile</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonStr</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">jsonFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fileName);</span><br><span class="line">            <span class="type">FileReader</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(jsonFile);</span><br><span class="line">            <span class="type">Reader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(jsonFile), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">ch</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">            <span class="keyword">while</span> ((ch = reader.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                sb.append((<span class="type">char</span>) ch);</span><br><span class="line">            &#125;</span><br><span class="line">            fileReader.close();</span><br><span class="line">            reader.close();</span><br><span class="line">            jsonStr = sb.toString();</span><br><span class="line">            <span class="keyword">return</span> jsonStr;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用反射实现orm</title>
      <link href="/2024/04/21/%E5%88%A9%E7%94%A8%E5%8F%8D%E5%B0%84%E5%AE%9E%E7%8E%B0orm/"/>
      <url>/2024/04/21/%E5%88%A9%E7%94%A8%E5%8F%8D%E5%B0%84%E5%AE%9E%E7%8E%B0orm/</url>
      
        <content type="html"><![CDATA[<p>需求：从数据库表中查询数据，并且以json的格式输出</p><p>由于类中的属性太多了，不想一个一个写了，所以使用反射直接set进去，这样比较方便，也比较实用，并且加深了对反射的理解。</p><p>并且使用了jackson 将List转换成了 json格式的字符串</p><p>代码如下 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/book_shop?useSSL=false&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;111111&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;连接数据库成功&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 先查询图书的种类</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        statement= connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        resultSet = statement.executeQuery(<span class="string">&quot;SELECT * FROM TB_CATEGORY&quot;</span>);</span><br><span class="line">        List&lt;category&gt; c = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">            <span class="type">category</span> <span class="variable">category</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">category</span>();</span><br><span class="line">            category.setCategoryId(resultSet.getInt(<span class="number">1</span>));</span><br><span class="line">            category.setCategoryName(resultSet.getString(<span class="number">2</span>));</span><br><span class="line">            c.add(category);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 利用反射，读取book里面的属性</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(Book.class.getName());</span><br><span class="line">        Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">        List&lt;String&gt; fs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Field f: fields) &#123;</span><br><span class="line">            fs.add(String.valueOf(f));</span><br><span class="line"><span class="comment">//            System.out.println(f);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 使用流,将 属性名前面的去掉,留下简化的属性名</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        fs = fs.stream().map(x-&gt;x.replaceAll(x,x.split(<span class="string">&quot;\\.&quot;</span>)[x.split(<span class="string">&quot;\\.&quot;</span>).length-<span class="number">1</span>])).collect(Collectors.toList());</span><br><span class="line"><span class="comment">//        System.out.println(fs);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 查询图书</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM TB_BOOK&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        st = connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        rs = st.executeQuery(sql);</span><br><span class="line">        <span class="type">ResultSetMetaData</span> <span class="variable">rd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> rd.getColumnCount();</span><br><span class="line">        List&lt;Book&gt; books = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line">            <span class="keyword">while</span> (i&lt;count)&#123;</span><br><span class="line">                <span class="comment">//循环将数据库中的值set 到book类中</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">stringValue</span> <span class="operator">=</span> rs.getString(i);</span><br><span class="line">                <span class="type">String</span> <span class="variable">ColumnName</span> <span class="operator">=</span> rd.getColumnName(i);</span><br><span class="line">                setValues(ColumnName,stringValue,book,fs);</span><br><span class="line">                <span class="comment">//book中category代表数的种类,但是是用数字表示的,因此要转换成为name并且赋值</span></span><br><span class="line">                <span class="keyword">if</span>(ColumnName.equals(<span class="string">&quot;category_id&quot;</span>))&#123;</span><br><span class="line">                    <span class="keyword">for</span>(category category: c)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(category.getCategoryId()==Integer.valueOf(stringValue))&#123;</span><br><span class="line">                            book.setCategory_name(category.getCategoryName());</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            books.add(book);</span><br><span class="line"><span class="comment">//            System.out.println();</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        for(Book b:books)&#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(b);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 利用jackson实现序列化</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//创建映射对象</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> mapper.writeValueAsString(books);</span><br><span class="line">            System.out.println(json);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用反射,调用 set方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ColumnName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stringValue</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> book</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ClassNotFoundException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setValues</span><span class="params">(String ColumnName,String stringValue, Book book,List&lt;String&gt; fs)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> book.getClass();</span><br><span class="line">        Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">//我们这里要获得与之对应的属性,因为要调用set,必须得传参数进去,因此我们需要得到属性的类型</span></span><br><span class="line">        <span class="keyword">for</span>(Field field:fields )&#123;</span><br><span class="line">            <span class="keyword">if</span>(ColumnName.equals(field.toString().split(<span class="string">&quot;\\.&quot;</span>)[field.toString().split(<span class="string">&quot;\\.&quot;</span>).length-<span class="number">1</span>]))&#123;</span><br><span class="line">                f = field;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//准备拼接set方法,将属性名称前面改为大写</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> initStr(ColumnName);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//拼接方法</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">setBookValue</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;set&quot;</span>+fileName,f.getType());</span><br><span class="line"><span class="comment">//            System.out.println(f.getType());</span></span><br><span class="line">            <span class="comment">//book属性中有integer类型,因此需要判断并且转换类型</span></span><br><span class="line">            <span class="keyword">if</span>(f.getType().toString().equals(<span class="string">&quot;class java.lang.Integer&quot;</span>))&#123;</span><br><span class="line">                setBookValue.invoke(book,Integer.valueOf(stringValue));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//同理,有int类型</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(f.getType().toString().equals(<span class="string">&quot;int&quot;</span>))&#123;</span><br><span class="line">                setBookValue.invoke(book,Integer.valueOf(stringValue));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                setBookValue.invoke(book,stringValue);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException | IllegalAccessException | InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将首个字母大小写</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> old</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">initStr</span><span class="params">(String old)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> old.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase() + old.substring(<span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> str ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>Book类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line"></span><br><span class="line">    Integer book_id;</span><br><span class="line">    Integer category_id;<span class="comment">//类别</span></span><br><span class="line">    String category_name;<span class="comment">//类别名称</span></span><br><span class="line">    String book_name;</span><br><span class="line">    String author;</span><br><span class="line">    String publisher;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> price;</span><br><span class="line">    <span class="type">int</span> sale_price;</span><br><span class="line">    <span class="type">int</span> amount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getBook_id</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> book_id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBook_id</span><span class="params">(Integer book_id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.book_id = book_id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getCategory_id</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> category_id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCategory_id</span><span class="params">(Integer category_id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.category_id = category_id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCategory_name</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> category_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCategory_name</span><span class="params">(String category_name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.category_name = category_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getBook_name</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> book_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBook_name</span><span class="params">(String book_name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.book_name = book_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSale_price</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sale_price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSale_price</span><span class="params">(<span class="type">int</span> sale_price)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sale_price = sale_price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAuthor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAuthor</span><span class="params">(String author)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.author = author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPublisher</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> publisher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPublisher</span><span class="params">(String publisher)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.publisher = publisher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPrice</span><span class="params">(<span class="type">int</span> price)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAmount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAmount</span><span class="params">(<span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.amount = amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Book&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;book_id=&quot;</span> + book_id +</span><br><span class="line">                <span class="string">&quot;, category_id=&quot;</span> + category_id +</span><br><span class="line">                <span class="string">&quot;, category_name=&#x27;&quot;</span> + category_name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, book_name=&#x27;&quot;</span> + book_name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, author=&#x27;&quot;</span> + author + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, publisher=&#x27;&quot;</span> + publisher + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, price=&quot;</span> + price +</span><br><span class="line">                <span class="string">&quot;, sale_price=&quot;</span> + sale_price +</span><br><span class="line">                <span class="string">&quot;, amount=&quot;</span> + amount +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>categorie 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">category</span> &#123;</span><br><span class="line">    Integer categoryId;<span class="comment">//类别</span></span><br><span class="line">    String categoryName;<span class="comment">//类别名称</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getCategoryId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> categoryId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCategoryId</span><span class="params">(Integer categoryId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.categoryId = categoryId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCategoryName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> categoryName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCategoryName</span><span class="params">(String categoryName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.categoryName = categoryName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;category&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;categoryId=&quot;</span> + categoryId +</span><br><span class="line">                <span class="string">&quot;, categoryName=&#x27;&quot;</span> + categoryName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见Linux命令</title>
      <link href="/2024/04/21/%E5%B8%B8%E8%A7%81Linux%E5%91%BD%E4%BB%A4/"/>
      <url>/2024/04/21/%E5%B8%B8%E8%A7%81Linux%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Linux系统是开发和运维工作中不可或缺的操作系统，掌握常用的Linux命令可以大大提高工作效率。本文整理了日常工作中经常使用的Linux命令，按功能分类并提供详细解释和实用示例，方便查阅和使用。</p><h2 id="系统信息查看"><a href="#系统信息查看" class="headerlink" title="系统信息查看"></a>系统信息查看</h2><h3 id="查看系统版本"><a href="#查看系统版本" class="headerlink" title="查看系统版本"></a>查看系统版本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看Linux发行版信息</span></span><br><span class="line"><span class="built_in">cat</span> /etc/redhat-release    <span class="comment"># CentOS/RHEL系统</span></span><br><span class="line">lsb_release -a             <span class="comment"># 大多数Linux发行版</span></span><br><span class="line"><span class="built_in">cat</span> /etc/issue             <span class="comment"># 查看系统信息</span></span><br><span class="line"><span class="built_in">uname</span> -a                   <span class="comment"># 查看内核信息</span></span><br></pre></td></tr></table></figure><h3 id="查看资源使用情况"><a href="#查看资源使用情况" class="headerlink" title="查看资源使用情况"></a>查看资源使用情况</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看磁盘空间</span></span><br><span class="line"><span class="built_in">df</span> -h                      <span class="comment"># 以人类可读方式显示磁盘使用情况</span></span><br><span class="line"><span class="built_in">du</span> -sh /path/to/directory  <span class="comment"># 查看指定目录大小</span></span><br><span class="line">free -m                    <span class="comment"># 查看内存使用情况(MB)</span></span><br><span class="line">top                        <span class="comment"># 实时查看系统资源使用情况</span></span><br><span class="line">htop                       <span class="comment"># 更友好的top替代品(需安装)</span></span><br></pre></td></tr></table></figure><h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><h3 id="基本文件操作"><a href="#基本文件操作" class="headerlink" title="基本文件操作"></a>基本文件操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -la                     <span class="comment"># 列出所有文件(包括隐藏文件)及详细信息</span></span><br><span class="line"><span class="built_in">cp</span> -r <span class="built_in">source</span> destination   <span class="comment"># 递归复制目录</span></span><br><span class="line"><span class="built_in">mv</span> <span class="built_in">source</span> destination      <span class="comment"># 移动文件或重命名</span></span><br><span class="line"><span class="built_in">rm</span> -rf directory           <span class="comment"># 递归强制删除目录(谨慎使用!)</span></span><br><span class="line"><span class="built_in">touch</span> filename             <span class="comment"># 创建空文件或更新文件时间戳</span></span><br></pre></td></tr></table></figure><h3 id="文件查找和内容搜索"><a href="#文件查找和内容搜索" class="headerlink" title="文件查找和内容搜索"></a>文件查找和内容搜索</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find /path -name <span class="string">&quot;*.txt&quot;</span>   <span class="comment"># 查找指定路径下的txt文件</span></span><br><span class="line">grep <span class="string">&quot;pattern&quot;</span> filename    <span class="comment"># 在文件中查找匹配内容</span></span><br><span class="line">grep -r <span class="string">&quot;pattern&quot;</span> /path    <span class="comment"># 递归查找目录中的匹配内容</span></span><br></pre></td></tr></table></figure><h2 id="网络相关"><a href="#网络相关" class="headerlink" title="网络相关"></a>网络相关</h2><h3 id="端口和连接管理"><a href="#端口和连接管理" class="headerlink" title="端口和连接管理"></a>端口和连接管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看网络连接和端口</span></span><br><span class="line">netstat -tlpn              <span class="comment"># 查看所有TCP监听端口</span></span><br><span class="line">netstat -aon|findstr <span class="string">&quot;8080&quot;</span> <span class="comment"># 在Windows中查找使用8080端口的进程</span></span><br><span class="line">ss -tnl                    <span class="comment"># 显示TCP监听端口(ss是netstat的替代)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 精确查找特定端口</span></span><br><span class="line">PORT=88</span><br><span class="line">netstat -lntup | awk -v port=<span class="string">&quot;<span class="variable">$PORT</span>&quot;</span> <span class="string">&#x27;NR&gt;2 &amp;&amp; $4 ~ &quot;:&quot;port&quot;$&quot; &#123;gsub(/.*:/,&quot;&quot;,$4); print $4&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看特定端口的进程</span></span><br><span class="line">lsof -i:8080               <span class="comment"># 查看使用8080端口的进程</span></span><br></pre></td></tr></table></figure><h3 id="防火墙管理"><a href="#防火墙管理" class="headerlink" title="防火墙管理"></a>防火墙管理</h3><h4 id="CentOS-x2F-RHEL-firewalld"><a href="#CentOS-x2F-RHEL-firewalld" class="headerlink" title="CentOS&#x2F;RHEL (firewalld)"></a>CentOS&#x2F;RHEL (firewalld)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看防火墙状态和端口</span></span><br><span class="line">firewall-cmd --state                      <span class="comment"># 查看防火墙状态</span></span><br><span class="line">firewall-cmd --zone=public --list-ports   <span class="comment"># 查看开放的端口</span></span><br><span class="line">firewall-cmd --query-port=80/tcp          <span class="comment"># 查询特定端口是否开放</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 管理防火墙规则</span></span><br><span class="line">firewall-cmd --zone=public --add-port=9913/tcp --permanent  <span class="comment"># 永久开放端口</span></span><br><span class="line">firewall-cmd --zone=public --remove-port=9913/tcp --permanent  <span class="comment"># 永久关闭端口</span></span><br><span class="line">firewall-cmd --reload                     <span class="comment"># 重新加载防火墙配置</span></span><br></pre></td></tr></table></figure><h4 id="Ubuntu-ufw"><a href="#Ubuntu-ufw" class="headerlink" title="Ubuntu (ufw)"></a>Ubuntu (ufw)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw status                <span class="comment"># 查看防火墙状态</span></span><br><span class="line">sudo ufw <span class="built_in">enable</span>                <span class="comment"># 开启防火墙</span></span><br><span class="line">sudo ufw allow 22              <span class="comment"># 开放22端口</span></span><br><span class="line">sudo ufw delete allow 21       <span class="comment"># 关闭21端口</span></span><br></pre></td></tr></table></figure><h2 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ps aux                         <span class="comment"># 查看所有进程</span></span><br><span class="line">ps aux | grep process_name     <span class="comment"># 查找特定进程</span></span><br><span class="line"><span class="built_in">kill</span> -9 PID                    <span class="comment"># 强制终止进程</span></span><br><span class="line">killall process_name           <span class="comment"># 终止所有指定名称的进程</span></span><br><span class="line">tasklist|findstr <span class="string">&quot;2668&quot;</span>        <span class="comment"># Windows中查找PID为2668的进程</span></span><br></pre></td></tr></table></figure><h2 id="Redis操作"><a href="#Redis操作" class="headerlink" title="Redis操作"></a>Redis操作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redis集群操作</span></span><br><span class="line">/usr/local/redis/bin/redis-cli -a 123456 --cluster create \</span><br><span class="line">  10.101.37.179:6381 10.101.37.179:6380 10.101.37.200:6381 \</span><br><span class="line">  10.101.37.200:6380 10.101.37.111:6381 10.101.37.111:6380 \</span><br><span class="line">  --cluster-replicas 1         <span class="comment"># 创建Redis集群</span></span><br><span class="line"></span><br><span class="line">/usr/local/redis/bin/redis-cli -a 123456 --cluster check 10.101.37.179:6381  <span class="comment"># 检查集群状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis服务管理</span></span><br><span class="line">/usr/local/redis/bin/redis-server /data/redis/6379/redis.conf  <span class="comment"># 启动Redis服务</span></span><br><span class="line">/usr/local/redis/bin/redis-cli -a 123456 -p 6380 shutdown     <span class="comment"># 关闭Redis服务</span></span><br><span class="line">/usr/local/redis/bin/redis-cli -a 123456                      <span class="comment"># 连接Redis客户端</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis文件清理</span></span><br><span class="line"><span class="built_in">rm</span> -rf appendonly.aof   <span class="comment"># 删除AOF文件</span></span><br><span class="line"><span class="built_in">rm</span> -rf dump.rdb         <span class="comment"># 删除RDB文件</span></span><br><span class="line"><span class="built_in">rm</span> -rf nodes.conf       <span class="comment"># 删除节点配置文件</span></span><br></pre></td></tr></table></figure><h2 id="MySQL操作"><a href="#MySQL操作" class="headerlink" title="MySQL操作"></a>MySQL操作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySQL管理命令</span></span><br><span class="line">mysqladmin -u root password 123456   <span class="comment"># 设置root用户密码</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改MySQL密码(MySQL 8.0+)</span></span><br><span class="line">ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库备份</span></span><br><span class="line">mysqldump -u username -p database_name &gt; backup.sql  <span class="comment"># 备份数据库</span></span><br><span class="line">mysqldump -u username -p --all-databases &gt; all_db_backup.sql  <span class="comment"># 备份所有数据库</span></span><br></pre></td></tr></table></figure><h2 id="系统环境设置"><a href="#系统环境设置" class="headerlink" title="系统环境设置"></a>系统环境设置</h2><h3 id="字符编码设置"><a href="#字符编码设置" class="headerlink" title="字符编码设置"></a>字符编码设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前编码</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$LANG</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置编码为zh_CN.UTF-8</span></span><br><span class="line"><span class="built_in">export</span> LANG=zh_CN.UTF-8</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次查看当前编码</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$LANG</span></span><br></pre></td></tr></table></figure><h2 id="NPM相关"><a href="#NPM相关" class="headerlink" title="NPM相关"></a>NPM相关</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解决依赖冲突问题</span></span><br><span class="line">npm install --legacy-peer-deps</span><br></pre></td></tr></table></figure><h2 id="命令行参数处理"><a href="#命令行参数处理" class="headerlink" title="命令行参数处理"></a>命令行参数处理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># getopt命令用于解析命令行参数</span></span><br><span class="line"><span class="comment"># -o或--options选项后面接可接受的短选项，如ab:c::</span></span><br><span class="line"><span class="comment"># -l或--long选项后面接可接受的长选项，用逗号分开</span></span><br><span class="line"><span class="comment"># -n选项后接选项解析错误时提示的脚本名字</span></span><br><span class="line">ARGS=`getopt -o s: --long p: -n <span class="string">&quot;<span class="variable">$BASH_NAME</span>&quot;</span> -- <span class="string">&quot;<span class="variable">$@</span>&quot;</span>`</span><br></pre></td></tr></table></figure><h2 id="安装问题解决"><a href="#安装问题解决" class="headerlink" title="安装问题解决"></a>安装问题解决</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果安装发生SSL/TLS错误(443)</span></span><br><span class="line">yum install ca-certificates -y  <span class="comment"># 安装证书</span></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">yum install ssl-cert -y</span><br></pre></td></tr></table></figure><h2 id="实用技巧"><a href="#实用技巧" class="headerlink" title="实用技巧"></a>实用技巧</h2><h3 id="网络调试"><a href="#网络调试" class="headerlink" title="网络调试"></a>网络调试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建临时监听端口(用于测试)</span></span><br><span class="line">nc -l 8080</span><br></pre></td></tr></table></figure><h3 id="命令组合"><a href="#命令组合" class="headerlink" title="命令组合"></a>命令组合</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 组合命令查找特定信息</span></span><br><span class="line">netstat -lntup | awk <span class="string">&#x27;NR&gt;2&#123;gsub(/.*:/,&quot; &quot;,$4);print $4&#125;&#x27;</span> | grep <span class="string">&quot; 31059$&quot;</span>  <span class="comment"># 精确找出端口31059</span></span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文整理了Linux系统中常用的命令，涵盖了系统信息查看、文件操作、网络管理、进程管理、数据库操作等多个方面。这些命令在日常的开发和运维工作中非常实用，掌握这些命令可以帮助我们更高效地完成工作任务。</p><p>对于更复杂的操作，建议查阅相关命令的手册页(使用<code>man command</code>命令)或官方文档，以获取更详细的信息和选项说明。</p>]]></content>
      
      
      <categories>
          
          <category> 小笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>doris删除工具</title>
      <link href="/2024/04/21/doris%E5%88%A0%E9%99%A4%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/04/21/doris%E5%88%A0%E9%99%A4%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><blockquote><p>对于Doris的 Unique 模型，在删除数据的时候只能根据key删除，如果使用其他条件就会报错</p></blockquote><h2 id="整体架构流程"><a href="#整体架构流程" class="headerlink" title="整体架构流程"></a>整体架构流程</h2><p>先获得表的key，然后在通过输入的条件获得key的所有值，最后通过key的值拼接删除语句，调用线程删除。</p><h2 id="技术名词解释"><a href="#技术名词解释" class="headerlink" title="技术名词解释"></a>技术名词解释</h2><ul><li>jsqlparser ：SQL解析工具，能将字符串解析出SQL的表，值，条件等</li><li>HikariCP ：数据库连接池</li><li>单例模式：单例模式调用数据库连接</li></ul><h2 id="技术细节"><a href="#技术细节" class="headerlink" title="技术细节"></a>技术细节</h2><ul><li>多线程：使用线程池开启线程，也可以使用分页线程</li><li>时间显示：时间显示使用无符号的时间格式</li></ul><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>具体实现代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.example.SqlParserExample.getTableName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        initLogRecord.initLog();</span><br><span class="line">        System.out.println(<span class="string">&quot;================================================================&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> HikariConfigs.HikariConn();</span><br><span class="line">        <span class="comment">// Statement stmt = conn.createStatement();</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;===========================请输入删除的语句=========================&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        <span class="type">String</span> <span class="variable">where</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (sql.indexOf(<span class="string">&quot;where&quot;</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            where = sql.substring(sql.indexOf(<span class="string">&quot;where&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sql.indexOf(<span class="string">&quot;WHERE&quot;</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            where = sql.substring(sql.indexOf(<span class="string">&quot;WHERE&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;=======================获取WHERE条件=============================&quot;</span>);</span><br><span class="line">        System.out.println(where);</span><br><span class="line">        <span class="type">String</span> <span class="variable">table</span> <span class="operator">=</span> getTableName(sql);</span><br><span class="line">        <span class="type">String</span> <span class="variable">getKey</span> <span class="operator">=</span> <span class="string">&quot;select * from information_schema.columns where TABLE_NAME = ? &quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ptmt_getKey</span> <span class="operator">=</span> conn.prepareStatement(getKey);</span><br><span class="line">        ptmt_getKey.setString(<span class="number">1</span>, table);</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ptmt_getKey.executeQuery();</span><br><span class="line">        List&lt;String&gt; key = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        Map&lt;String, String&gt; key_type = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        System.out.println(<span class="string">&quot;=======================获取KEY==================================&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (rs.getString(<span class="string">&quot;column_key&quot;</span>).equals(<span class="string">&quot;UNI&quot;</span>)) &#123;</span><br><span class="line">                key.add(rs.getString(<span class="string">&quot;column_name&quot;</span>));</span><br><span class="line">                key_type.put(rs.getString(<span class="string">&quot;column_name&quot;</span>), rs.getString(<span class="string">&quot;DATA_TYPE&quot;</span>));</span><br><span class="line">                System.out.println(rs.getString(<span class="string">&quot;column_name&quot;</span>) + <span class="string">&quot;  &quot;</span> + rs.getString(<span class="string">&quot;column_key&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;=======================拼接key==================================&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">column</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (String s : key) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!Objects.equals(column, <span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">                column = column + <span class="string">&quot;,&quot;</span> + s;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                column = s;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(column);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 拼接SELECT 语句</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">newSQL</span> <span class="operator">=</span> <span class="string">&quot;SELECT &quot;</span> + column + <span class="string">&quot; FROM &quot;</span> + table + <span class="string">&quot; &quot;</span> + where;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">pstm_getkeyvalue</span> <span class="operator">=</span> conn.prepareStatement(newSQL);</span><br><span class="line">        rs = pstm_getkeyvalue.executeQuery();</span><br><span class="line">        List&lt;Map&lt;String, String&gt;&gt; values = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">            Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (String x : key) &#123;</span><br><span class="line">                map.put(x, rs.getString(x));</span><br><span class="line">            &#125;</span><br><span class="line">            values.add(map);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// for (int i =0 ;i&lt; values.size();i++)&#123;</span></span><br><span class="line">        <span class="comment">// System.out.println(values.get(i));;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 循环拼接删除的where 条件</span></span><br><span class="line">        StringBuilder delete_where;</span><br><span class="line">        String delete_sql;</span><br><span class="line">        List&lt;String&gt; delete_sqls = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Map&lt;String, String&gt; x : values) &#123;</span><br><span class="line">            delete_where = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">for</span> (String y : x.keySet()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (delete_where.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// 时间格式的拼接</span></span><br><span class="line">                    <span class="keyword">if</span> (key_type.get(y).equals(<span class="string">&quot;datetime&quot;</span>)) &#123;</span><br><span class="line">                        <span class="type">LocalDateTime</span> <span class="variable">date</span> <span class="operator">=</span> LocalDateUtils.parseLocalDateTime(x.get(y),</span><br><span class="line">                                LocalDateUtils.DATETIME_PATTERN);</span><br><span class="line">                        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> LocalDateUtils.format(date, LocalDateUtils.UNSIGNED_DATETIME_PATTERN);</span><br><span class="line">                        delete_where.append(<span class="string">&quot; AND &quot;</span>).append(y).append(<span class="string">&quot;=&quot;</span>).append(<span class="string">&quot;&#x27;&quot;</span>).append(str).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        delete_where.append(<span class="string">&quot; AND &quot;</span>).append(y).append(<span class="string">&quot;=&quot;</span>).append(<span class="string">&quot;&#x27;&quot;</span>).append(x.get(y)).append(<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (key_type.get(y).equals(<span class="string">&quot;datetime&quot;</span>)) &#123;</span><br><span class="line">                        <span class="type">LocalDate</span> <span class="variable">date</span> <span class="operator">=</span> LocalDateUtils.parseLocalDate(x.get(y), LocalDateUtils.DATETIME_PATTERN);</span><br><span class="line">                        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> LocalDateUtils.format(date, LocalDateUtils.UNSIGNED_DATETIME_PATTERN);</span><br><span class="line">                        delete_where = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(y + <span class="string">&quot;=&quot;</span> + <span class="string">&quot;&#x27;&quot;</span> + str + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        delete_where = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(y + <span class="string">&quot;=&quot;</span> + <span class="string">&quot;&#x27;&quot;</span> + x.get(y) + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            delete_sql = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            delete_sql = <span class="string">&quot;DELETE FROM &quot;</span> + table + <span class="string">&quot; WHERE &quot;</span> + delete_where;</span><br><span class="line">            delete_sqls.add(delete_sql);</span><br><span class="line">            <span class="comment">// System.out.println(&quot;删除语句：&quot;+ delete_sql);</span></span><br><span class="line">            <span class="comment">// if (dels.executeUpdate(delete_sql)&gt;0)&#123;</span></span><br><span class="line">            <span class="comment">// i++;</span></span><br><span class="line">            <span class="comment">// System.out.println(&quot;=======================删除成功=======================&quot;);</span></span><br><span class="line">            <span class="comment">// &#125;else&#123;</span></span><br><span class="line">            <span class="comment">// System.out.println(&quot;!!!!!!!!!!!!!!!!!删除失败!!!!!!!!!!!!!!!!!&quot;);</span></span><br><span class="line">            <span class="comment">// j++;</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">        conn.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用线程执行sql</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=====================  需要删除数据的总数为: &quot;</span> + delete_sqls.size() + <span class="string">&quot;  =================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;======================  请确认是否删除？ yes or no=====================&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">is_delete</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        <span class="keyword">if</span> (!is_delete.equals(<span class="string">&quot;yes&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ExecutorService executor = Executors.newFixedThreadPool(10); // 创建一个固定大小的线程池</span></span><br><span class="line">        <span class="comment">// AtomicInteger successCount = new AtomicInteger(0); // 原子计数器，用于记录成功执行的SQL数量</span></span><br><span class="line">        <span class="comment">// AtomicInteger failureCount = new AtomicInteger(0); // 统计失败次数</span></span><br><span class="line">        <span class="comment">// long start = System.currentTimeMillis();</span></span><br><span class="line">        <span class="comment">// executor.submit(() -&gt; &#123;</span></span><br><span class="line">        <span class="comment">//     try (Connection connection = HikariConfigs.HikariConn();) &#123;</span></span><br><span class="line">        <span class="comment">//         for (int i = 0; i &lt; delete_sqls.size(); i++) &#123;</span></span><br><span class="line">        <span class="comment">//             Statement statement = connection.createStatement();</span></span><br><span class="line">        <span class="comment">//             String deletesql = delete_sqls.get(i);</span></span><br><span class="line">        <span class="comment">//             System.out.println(&quot;!!!正在删除数据：&quot; + deletesql);</span></span><br><span class="line">        <span class="comment">//             // int updateCount = statement.executeUpdate(deletesql);</span></span><br><span class="line">        <span class="comment">//             // if (updateCount &gt; -1) &#123;</span></span><br><span class="line">        <span class="comment">//             //     successCount.incrementAndGet(); // 如果删除成功，增加本地计数器</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//             // &#125; else &#123;</span></span><br><span class="line">        <span class="comment">//             //     failureCount.incrementAndGet();// 如果删除失败</span></span><br><span class="line">        <span class="comment">//             // &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//             statement.addBatch(deletesql);</span></span><br><span class="line">        <span class="comment">//             successCount.incrementAndGet(); // 如果删除成功，增加本地计数器</span></span><br><span class="line">        <span class="comment">//             if (i % 500 == 0) &#123;</span></span><br><span class="line">        <span class="comment">//                 statement.executeBatch();</span></span><br><span class="line">        <span class="comment">//             &#125;</span></span><br><span class="line">        <span class="comment">//         &#125;</span></span><br><span class="line">        <span class="comment">//     &#125; catch (SQLException e) &#123;</span></span><br><span class="line">        <span class="comment">//         e.printStackTrace();</span></span><br><span class="line">        <span class="comment">//     &#125; catch (InterruptedException ex) &#123;</span></span><br><span class="line">        <span class="comment">//         ex.printStackTrace();</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// executor.shutdown(); // 关闭线程池</span></span><br><span class="line">        <span class="comment">// executor.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS); // 等待所有任务完成</span></span><br><span class="line">        <span class="comment">// long end = System.currentTimeMillis();</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">successCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>); <span class="comment">// 原子计数器，用于记录成功执行的SQL数量</span></span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">failureCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>); <span class="comment">// 统计失败次数</span></span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> delete_sqls.size();</span><br><span class="line">        <span class="type">int</span> <span class="variable">theadCount</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">splitCount</span> <span class="operator">=</span> size / theadCount + (size % theadCount != <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>); <span class="comment">//计算分拆数量，向上取整</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">CountDownLatch</span> <span class="variable">cdl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(theadCount);<span class="comment">// 定义线程数量</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">starttime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">1</span>; k &lt;= theadCount; k++) &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">int</span> <span class="variable">beign</span> <span class="operator">=</span> (k - <span class="number">1</span>)  * splitCount;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> (k * splitCount) &gt; size ? size : k * splitCount;</span><br><span class="line">            <span class="keyword">if</span>(beign &gt;= end) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> JDBCTools.getConnection();</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> con.createStatement();</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; delete_sqls.size(); i++) &#123;</span><br><span class="line">                            <span class="type">String</span> <span class="variable">deletesql</span> <span class="operator">=</span> delete_sqls.get(i);</span><br><span class="line">                            System.out.println(<span class="string">&quot;!!!正在删除数据：&quot;</span> + deletesql);</span><br><span class="line">                            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> st.executeUpdate(deletesql);</span><br><span class="line">                            <span class="keyword">if</span> (count &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                                successCount.incrementAndGet();</span><br><span class="line">                            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                failureCount.incrementAndGet();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        cdl.countDown(); <span class="comment">// 执行完一个线程，递减1</span></span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            con.close();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cdl.await();    <span class="comment">//前面线程没执行完，其他线程等待，不往下执行</span></span><br><span class="line">            <span class="type">long</span> spendtime=System.currentTimeMillis()-starttime;</span><br><span class="line">            System.out.println( theadCount+<span class="string">&quot;个线程花费时间:&quot;</span>+spendtime);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">endtime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;已完成删除&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;成功删除数据 &quot;</span> + successCount + <span class="string">&quot; 条&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;删除失败 &quot;</span> + failureCount + <span class="string">&quot; 条&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;消耗的时间为（毫秒）：&quot;</span> + (endtime - starttime));</span><br><span class="line">        System.out.println(<span class="string">&quot;消耗的时间为（秒）：&quot;</span> + TimeUnit.MILLISECONDS.toSeconds(endtime - starttime));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>完整的项目git地址：<a href="https://gitee.com/reisen7/doristool">Doris工具</a></p>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Doris </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国内镜像下载node-sass</title>
      <link href="/2024/04/21/%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BDnode-sass/"/>
      <url>/2024/04/21/%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E4%B8%8B%E8%BD%BDnode-sass/</url>
      
        <content type="html"><![CDATA[<p>npm 下载 gpy（给爷爬）失败，大概率是下载node-sass失败<br>👇👇👇</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">npm</span> <span class="string">ERR! path xxx\src\main\webapp\admin\node_modules\node-sass</span></span><br></pre></td></tr></table></figure><p><strong>解决办法</strong></p><p>在项目根目录添加 <em><code>.npmrc</code></em><br>例如：</p><p><img src="/img/posts/b329c4d44eeb5c45c7d1d53e8c3d3d85.png"><br>在里面写如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">registry=https://registry.npmmirror.com</span><br><span class="line">sass_binary_site=https://npmmirror.com/mirrors/node-sass/</span><br><span class="line">phantomjs_cdnurl=https://npmmirror.com/mirrors/phantomjs/</span><br><span class="line">electron_mirror=https://npmmirror.com/mirrors/electron/</span><br><span class="line">sqlite3_binary_host_mirror=http://npmmirror.com/mirrors/</span><br><span class="line">profiler_binary_host_mirror=http://npmmirror.com/mirrors/node-inspector/</span><br><span class="line">chromedriver_cdnurl=https://npmmirror.com/mirrors/chromedriver</span><br><span class="line">sentrycli_cdnurl=https://npmmirror.com/mirrors/sentry-cli/</span><br></pre></td></tr></table></figure><h2 id="另外需要注意node的版本"><a href="#另外需要注意node的版本" class="headerlink" title="另外需要注意node的版本"></a>另外需要注意node的版本</h2><p>博主使用 14.17.0 能正常下载，使用16就报错了，建议使用nvm管理</p><h3 id="后来经过反复的部署项目，发现node-sass需要和node的版本号相互匹配"><a href="#后来经过反复的部署项目，发现node-sass需要和node的版本号相互匹配" class="headerlink" title="后来经过反复的部署项目，发现node-sass需要和node的版本号相互匹配"></a>后来经过反复的部署项目，发现node-sass需要和node的版本号相互匹配</h3><p><img src="/img/posts/78012a241d234e3fb3263e6f5b0a0dac.png"></p>]]></content>
      
      
      <categories>
          
          <category> 解决方案 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue2：创建一个聊天弹窗</title>
      <link href="/2024/04/17/Vue2%EF%BC%9A%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%81%8A%E5%A4%A9%E5%BC%B9%E7%AA%97/"/>
      <url>/2024/04/17/Vue2%EF%BC%9A%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%81%8A%E5%A4%A9%E5%BC%B9%E7%AA%97/</url>
      
        <content type="html"><![CDATA[<hr><h2 id="创建一个聊天窗口"><a href="#创建一个聊天窗口" class="headerlink" title="创建一个聊天窗口"></a>创建一个聊天窗口</h2><ul><li><input disabled="" type="checkbox"> 先创建一个Model.vue 该文件作为弹窗的内容</li></ul><h3 id="前端代码如下"><a href="#前端代码如下" class="headerlink" title="前端代码如下"></a>前端代码如下</h3><hr><p>页面部分：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-bg&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;show&quot;</span> @<span class="attr">mousemove</span>=<span class="string">&quot;modelMove&quot;</span> @<span class="attr">mouseup</span>=<span class="string">&quot;cancelMove&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-container&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-header&quot;</span> @<span class="attr">mousedown</span>=<span class="string">&quot;setStartingPoint&quot;</span>&gt;</span></span><br><span class="line">                &#123;&#123; title &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-main&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,i) in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;item.id== 2 ? &#x27;atalk&#x27; : &#x27;btalk&#x27;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; item.content &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;wordone&quot;</span>  <span class="attr">class</span>=<span class="string">&quot;inputword&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;sendmsg&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;isButtonDisabled&quot;</span> <span class="attr">round</span>  @<span class="attr">click</span>=<span class="string">&quot;sendmsg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btnsend&quot;</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;model-footer&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">round</span> @<span class="attr">click</span>=<span class="string">&quot;cancel&quot;</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">Loading</span>&gt;</span><span class="tag">&lt;/<span class="name">Loading</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>分为两块：</li><li>上面的 model-main 为聊天信息的内容，其中根据list的id来判断聊天消息在左侧和在右侧</li><li>下面的 text 为聊天的按钮</li></ul><hr><p>js部分</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Loading</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Loading.vue&quot;</span>;<span class="comment">//引用loading组件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">title</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="string">&#x27;智能助手&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">node</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="attr">isCanMove</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">isButtonDisabled</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">typingSpeed</span>: <span class="number">100</span>, <span class="comment">// 每个字符之间的延迟时间（毫秒）</span></span><br><span class="line">            <span class="attr">list</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;111&#x27;</span>,</span><br><span class="line">                    <span class="attr">content</span>: <span class="string">&#x27;你好&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">id</span>: <span class="number">2</span>,</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;222&#x27;</span>,</span><br><span class="line">                    <span class="attr">content</span>: <span class="string">&#x27;你好👋，我是你的智能小助手&#x27;</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">wordone</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="attr">wordtow</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">Loading</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">node</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.model-container&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">sendmsg</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> $this = <span class="variable language_">this</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> == <span class="literal">false</span>)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;sigtuna&#x27;</span>, <span class="attr">content</span>: <span class="variable language_">this</span>.<span class="property">wordone</span> &#125;);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">getBotContent</span>($this);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">true</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">wordone</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">wordone</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="comment">// console.log(this.list)</span></span><br><span class="line">            <span class="keyword">var</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span><br><span class="line">            &#125;, <span class="number">0</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//模拟逐字进行返回数据</span></span><br><span class="line">        <span class="title function_">getChatContent</span>(<span class="params">text</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; text.<span class="property">length</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">list</span>[<span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span> - <span class="number">1</span>].<span class="property">content</span> += text.<span class="title function_">charAt</span>(i);</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">var</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span><br><span class="line">                    &#125;, <span class="number">0</span>)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>); <span class="comment">// 清除定时器</span></span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="variable language_">this</span>.<span class="property">typingSpeed</span>);</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">getBotContent</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">bus</span>.$emit(<span class="string">&quot;loading&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(</span><br><span class="line">            &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;kanade&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;思考中...&#x27;</span> &#125;</span><br><span class="line">            );</span><br><span class="line">            <span class="variable language_">this</span>.$http(&#123;</span><br><span class="line">                <span class="attr">url</span>:<span class="string">&quot;/AiController/query?content=&quot;</span>+<span class="variable language_">this</span>.<span class="property">wordone</span>,</span><br><span class="line">                <span class="attr">method</span>:<span class="string">&quot;post&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">                <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>)&#123;</span><br><span class="line">                    <span class="keyword">var</span> data = res.<span class="property">data</span>.<span class="property">msg</span>;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">list</span>[<span class="variable language_">this</span>.<span class="property">list</span>.<span class="property">length</span>-<span class="number">1</span>].<span class="property">content</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">getChatContent</span>(data);</span><br><span class="line">                    <span class="keyword">var</span> div = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">box</span>;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        div.<span class="property">scrollTop</span> = div.<span class="property">scrollHeight</span>;</span><br><span class="line">                    &#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">bus</span>.$emit(<span class="string">&quot;loading&quot;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isButtonDisabled</span> = <span class="literal">false</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(err.<span class="property">message</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="title function_">cancel</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;cancel&#x27;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="title function_">submit</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;submit&#x27;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setStartingPoint</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">x</span> = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">offsetLeft</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">y</span> = e.<span class="property">clientY</span> - <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">offsetTop</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isCanMove</span> = <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="title function_">modelMove</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isCanMove</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">style</span>.<span class="property">left</span> = e.<span class="property">clientX</span> - <span class="variable language_">this</span>.<span class="property">x</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">node</span>.<span class="property">style</span>.<span class="property">top</span> = e.<span class="property">clientY</span> - <span class="variable language_">this</span>.<span class="property">y</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="title function_">cancelMove</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isCanMove</span> = <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><em>点击发送，向后端发送请求，然后更新消息list</em></p><hr><p>css部分</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped&gt;</span><br><span class="line"><span class="selector-class">.model-bg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.model-container</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">40%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.model-header</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">56px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#409EFF</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">cursor</span>: move;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.model-footer</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">57px</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.model-footer</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.model-main</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">70%</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">85%</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: scroll;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span>::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.atalk</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.atalk</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">3px</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid aliceblue;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btalk</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: right;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btalk</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">3px</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid aliceblue;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.sendbox</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">border-bottom-left-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">border-bottom-right-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">2%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inputword</span> &#123;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">85%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">text-indent</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btnsend</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">13%</span>;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>通过想后端发送请求，可以实现在线聊天功能，也可以通过接入AI来实现客服对话功能</p></blockquote><hr><h3 id="Loading"><a href="#Loading" class="headerlink" title="Loading"></a>Loading</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;loadingBox&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-show</span>=<span class="string">&quot;loading&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;background-color: rgba(0, 0, 0, 0.5)&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;sun-loading&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;loading&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">loading</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> that = <span class="variable language_">this</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">bus</span>.$on(<span class="string">&quot;loading&quot;</span>, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        that.<span class="property">loading</span> = !!data;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.sun-loading</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">45px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">45px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation</span>: sunLoading <span class="number">1s</span> <span class="built_in">steps</span>(<span class="number">12</span>, end) infinite;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: transparent</span></span><br><span class="line"><span class="language-css">      <span class="built_in">url</span>(<span class="string">&quot;http://www.sucaijishi.com/uploadfile/2018/0919/20180919030731920.gif?imageMogr2/format/jpg/blur/1x0/quality/60&quot;</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-size</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: auto;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>在main.js里面添加</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bus</span> = <span class="keyword">new</span> <span class="title class_">Vue</span>();</span><br></pre></td></tr></table></figure><h3 id="后代码如下"><a href="#后代码如下" class="headerlink" title="后代码如下"></a>后代码如下</h3><p>service层</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;ai-key&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String apiKey;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">query</span><span class="params">(String queryMessage)</span> &#123;</span><br><span class="line">        Constants.apiKey = apiKey;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Generation</span> <span class="variable">gen</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Generation</span>();</span><br><span class="line">            <span class="type">MessageManager</span> <span class="variable">msgManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageManager</span>(<span class="number">10</span>);</span><br><span class="line">            <span class="type">Message</span> <span class="variable">systemMsg</span> <span class="operator">=</span> Message.builder().role(Role.SYSTEM.getValue()).content(<span class="string">&quot;你是Hibiki开发的智能助手，你只回答与动漫的问题，不要回答其他问题！&quot;</span>).build();</span><br><span class="line">            <span class="type">Message</span> <span class="variable">userMsg</span> <span class="operator">=</span> Message.builder().role(Role.USER.getValue()).content(queryMessage).build();</span><br><span class="line">            msgManager.add(systemMsg);</span><br><span class="line">            msgManager.add(userMsg);</span><br><span class="line">            <span class="type">QwenParam</span> <span class="variable">param</span> <span class="operator">=</span> QwenParam.builder().model(Generation.Models.QWEN_TURBO).messages(msgManager.get()).resultFormat(QwenParam.ResultFormat.MESSAGE).build();</span><br><span class="line">            <span class="type">GenerationResult</span> <span class="variable">result</span> <span class="operator">=</span> gen.call(param);</span><br><span class="line">            <span class="type">GenerationOutput</span> <span class="variable">output</span> <span class="operator">=</span> result.getOutput();</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> output.getChoices().get(<span class="number">0</span>).getMessage();</span><br><span class="line">            <span class="keyword">return</span> message.getContent();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;智能助手现在不在线，请稍后再试～&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>通过阿里的通义千问大模型，可以实现在线的对话机器人功能<br>也能自定义模型的回答类型，非常实用</p></blockquote><h3 id="所需的依赖"><a href="#所需的依赖" class="headerlink" title="所需的依赖"></a>所需的依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--GSON --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/dashscope-sdk-java --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dashscope-sdk-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ok http client--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>okhttp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>其中阿里的sdk会有依赖冲突，exclusion看情况添加</strong></p><h3 id="在所需页面里引入弹窗"><a href="#在所需页面里引入弹窗" class="headerlink" title="在所需页面里引入弹窗"></a>在所需页面里引入弹窗</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;navbar&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&#x27;&#123; &quot;cursor&quot;: &quot;pointer&quot;, &quot;margin&quot;: &quot;0 5px&quot;, &quot;lineHeight&quot;: &quot;44px&quot;, &quot;color&quot;: &quot;#fff&quot; &#125;&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;logout&quot;</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;diaglog&quot;</span>&gt;</span>智能助手<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Model</span> <span class="attr">:show</span>=<span class="string">&quot;show&quot;</span> @<span class="attr">cancel</span>=<span class="string">&quot;cancel&quot;</span> @<span class="attr">submit</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Model</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Model</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Model.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Model</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">cancel</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 取消弹窗回调</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">submit</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 确认弹窗回调</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">diaglog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">show</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">onLogout</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> storage = <span class="variable language_">this</span>.<span class="property">$storage</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> router = <span class="variable language_">this</span>.<span class="property">$router</span></span></span><br><span class="line"><span class="language-javascript">            storage.<span class="title function_">clear</span>()</span></span><br><span class="line"><span class="language-javascript">            router.<span class="title function_">replace</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">name</span>: <span class="string">&quot;login&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">onIndexTap</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.$base.indexUrl&#125;</span>`</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">.navbar &#123;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode配置</title>
      <link href="/2023/09/26/vscode%E9%85%8D%E7%BD%AE/"/>
      <url>/2023/09/26/vscode%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;workbench.iconTheme&quot;: &quot;material-icon-theme&quot;,</span><br><span class="line">    &quot;editor.guides.bracketPairs&quot;: true,</span><br><span class="line">    &quot;workbench.colorCustomizations&quot;: &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;editor.codeActionsOnSave&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;files.autoSave&quot;: &quot;afterDelay&quot;,</span><br><span class="line">    //  代理配置</span><br><span class="line">    // &quot;http.proxy&quot;: &quot;&quot;,</span><br><span class="line">    // &quot;http.proxyStrictSSL&quot;: false,</span><br><span class="line">    // &quot;http.proxySupport&quot;: &quot;on&quot;,</span><br><span class="line"></span><br><span class="line">    // springboot 配置</span><br><span class="line">    &quot;java.jdt.ls.java.home&quot;:&quot;d:\\etc\\jdk-17.0.8.7-hotspot&quot;,</span><br><span class="line">    &quot;java.configuration.maven.userSettings&quot;: &quot;D:\\usr\\apache-maven-3.9.4\\conf\\settings.xml&quot;,</span><br><span class="line">    &quot;java.configuration.maven.globalSettings&quot;: &quot;D:\\usr\\apache-maven-3.9.4\\conf\\settings.xml&quot;,</span><br><span class="line">    &quot;maven.executable.path&quot;: &quot;D:\\usr\\apache-maven-3.9.4\\bin\\mvn.cmd&quot;,</span><br><span class="line"></span><br><span class="line">    &quot;maven.excludedFolders&quot;: [</span><br><span class="line"></span><br><span class="line">        &quot;**/.*&quot;,</span><br><span class="line">        &quot;**/node_modules&quot;,</span><br><span class="line">        &quot;**/target&quot;,</span><br><span class="line">        &quot;**/bin&quot;,</span><br><span class="line">        &quot;**/archetype-resources&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;extensions.autoUpdate&quot;: false,</span><br><span class="line">    &quot;redhat.telemetry.enabled&quot;: true,</span><br><span class="line"></span><br><span class="line">    // java</span><br><span class="line">    &quot;java.configuration.runtimes&quot;: [</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;JavaSE-1.8&quot;,</span><br><span class="line">          &quot;path&quot;: &quot;D:\\etc\\jdk-1.8&quot;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;JavaSE-11&quot;,</span><br><span class="line">          &quot;path&quot;: &quot;D:\\etc\\jdk-11.0.20.8-hotspot&quot;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;JavaSE-17&quot;,</span><br><span class="line">          &quot;path&quot;: &quot;D:\\etc\\jdk-17.0.8.7-hotspot&quot;,</span><br><span class="line">          &quot;default&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">      &quot;boot-java.rewrite.reconcile&quot;: true,</span><br><span class="line">      &quot;security.workspace.trust.untrustedFiles&quot;: &quot;open&quot;,</span><br><span class="line">      &quot;remote.SSH.remotePlatform&quot;: &#123;</span><br><span class="line">        &quot;60.204.200.91&quot;: &quot;linux&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;workbench.colorTheme&quot;: &quot;Default Dark+&quot;,</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VsCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>普罗米修斯</title>
      <link href="/2023/08/01/%E6%99%AE%E7%BD%97%E7%B1%B3%E4%BF%AE%E6%96%AF/"/>
      <url>/2023/08/01/%E6%99%AE%E7%BD%97%E7%B1%B3%E4%BF%AE%E6%96%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="Prometheus简介"><a href="#Prometheus简介" class="headerlink" title="Prometheus简介"></a>Prometheus简介</h2><p>Prometheus（普罗米修斯）是一个开源的系统监控和告警工具包，最初由SoundCloud开发，现在已成为云原生计算基金会（CNCF）的第二个项目（仅次于Kubernetes）。Prometheus以其强大的多维度数据模型、灵活的查询语言、高效的时间序列数据库和现代化的告警处理而闻名。</p><h2 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h2><ol><li><strong>多维数据模型</strong>：通过指标名称和键值对（标签）来标识时间序列数据</li><li><strong>强大的查询语言PromQL</strong>：支持对收集的数据进行复杂查询和分析</li><li><strong>不依赖分布式存储</strong>：单个服务器节点是自治的</li><li><strong>通过HTTP拉取模式收集时间序列数据</strong></li><li><strong>通过中间网关支持推送时间序列数据</strong></li><li><strong>通过服务发现或静态配置发现目标</strong></li><li><strong>支持多种图形和仪表盘</strong>，特别是与Grafana集成</li></ol><h2 id="架构组件"><a href="#架构组件" class="headerlink" title="架构组件"></a>架构组件</h2><p><img src="https://prometheus.io/assets/architecture.png" alt="Prometheus架构图"></p><p>Prometheus生态系统由多个组件组成：</p><ol><li><strong>Prometheus Server</strong>：核心组件，负责数据采集和存储</li><li><strong>Exporters</strong>：为特定服务暴露指标，如Node Exporter、MySQL Exporter等</li><li><strong>Pushgateway</strong>：支持短期作业的指标推送</li><li><strong>Alertmanager</strong>：处理告警</li><li><strong>Web UI</strong>：内置的表达式浏览器和图形界面</li></ol><h2 id="安装Prometheus"><a href="#安装Prometheus" class="headerlink" title="安装Prometheus"></a>安装Prometheus</h2><h3 id="使用Docker安装"><a href="#使用Docker安装" class="headerlink" title="使用Docker安装"></a>使用Docker安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取Prometheus镜像</span></span><br><span class="line">docker pull prom/prometheus</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建配置文件目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /etc/prometheus</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建基本配置文件</span></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/prometheus/prometheus.yml &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">global:</span></span><br><span class="line"><span class="string">  scrape_interval: 15s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">scrape_configs:</span></span><br><span class="line"><span class="string">  - job_name: &#x27;prometheus&#x27;</span></span><br><span class="line"><span class="string">    static_configs:</span></span><br><span class="line"><span class="string">      - targets: [&#x27;localhost:9090&#x27;]</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动Prometheus容器</span></span><br><span class="line">docker run -d \</span><br><span class="line">  --name prometheus \</span><br><span class="line">  -p 9090:9090 \</span><br><span class="line">  -v /etc/prometheus:/etc/prometheus \</span><br><span class="line">  prom/prometheus \</span><br><span class="line">  --config.file=/etc/prometheus/prometheus.yml</span><br></pre></td></tr></table></figure><h3 id="使用二进制文件安装"><a href="#使用二进制文件安装" class="headerlink" title="使用二进制文件安装"></a>使用二进制文件安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载最新版本</span></span><br><span class="line">wget https://github.com/prometheus/prometheus/releases/download/v2.37.0/prometheus-2.37.0.linux-amd64.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压文件</span></span><br><span class="line">tar -xvf prometheus-2.37.0.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">cd</span> prometheus-2.37.0.linux-amd64/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动Prometheus</span></span><br><span class="line">./prometheus --config.file=prometheus.yml</span><br></pre></td></tr></table></figure><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="1-数据模型"><a href="#1-数据模型" class="headerlink" title="1. 数据模型"></a>1. 数据模型</h3><p>Prometheus存储的所有数据都是时间序列，由以下要素标识：</p><ul><li><strong>指标名称</strong>：如<code>http_requests_total</code></li><li><strong>标签</strong>：键值对，如<code>&#123;method=&quot;GET&quot;, endpoint=&quot;/api&quot;&#125;</code></li><li><strong>时间戳</strong>：精确到毫秒的时间点</li><li><strong>值</strong>：64位浮点数</li></ul><h3 id="2-指标类型"><a href="#2-指标类型" class="headerlink" title="2. 指标类型"></a>2. 指标类型</h3><ul><li><strong>Counter</strong>：只增不减的计数器，如请求总数</li><li><strong>Gauge</strong>：可增可减的仪表盘，如内存使用量</li><li><strong>Histogram</strong>：对观测值进行采样并分布到可配置的桶中</li><li><strong>Summary</strong>：类似Histogram，但提供分位数计算</li></ul><h3 id="3-PromQL查询语言"><a href="#3-PromQL查询语言" class="headerlink" title="3. PromQL查询语言"></a>3. PromQL查询语言</h3><p>PromQL是Prometheus的查询语言，用于选择和聚合时间序列数据：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 查询HTTP请求总数</span><br><span class="line">http_requests_total</span><br><span class="line"></span><br><span class="line"># 按method标签过滤</span><br><span class="line">http_requests_total&#123;method=&quot;GET&quot;&#125;</span><br><span class="line"></span><br><span class="line"># 计算5分钟内的请求率</span><br><span class="line">rate(http_requests_total[5m])</span><br><span class="line"></span><br><span class="line"># 聚合所有实例的CPU使用率</span><br><span class="line">sum(rate(node_cpu_seconds_total&#123;mode!=&quot;idle&quot;&#125;[1m])) by (instance)</span><br></pre></td></tr></table></figure><h2 id="监控实例：Node-Exporter"><a href="#监控实例：Node-Exporter" class="headerlink" title="监控实例：Node Exporter"></a>监控实例：Node Exporter</h2><p>Node Exporter是Prometheus官方提供的用于监控Linux系统指标的导出器。</p><h3 id="安装Node-Exporter"><a href="#安装Node-Exporter" class="headerlink" title="安装Node Exporter"></a>安装Node Exporter</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用Docker</span></span><br><span class="line">docker run -d \</span><br><span class="line">  --name node-exporter \</span><br><span class="line">  --net=<span class="string">&quot;host&quot;</span> \</span><br><span class="line">  --pid=<span class="string">&quot;host&quot;</span> \</span><br><span class="line">  -v <span class="string">&quot;/:/host:ro,rslave&quot;</span> \</span><br><span class="line">  prom/node-exporter \</span><br><span class="line">  --path.rootfs=/host</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用二进制文件</span></span><br><span class="line">wget https://github.com/prometheus/node_exporter/releases/download/v1.3.1/node_exporter-1.3.1.linux-amd64.tar.gz</span><br><span class="line">tar -xvf node_exporter-1.3.1.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">cd</span> node_exporter-1.3.1.linux-amd64/</span><br><span class="line">./node_exporter</span><br></pre></td></tr></table></figure><h3 id="配置Prometheus采集Node-Exporter指标"><a href="#配置Prometheus采集Node-Exporter指标" class="headerlink" title="配置Prometheus采集Node Exporter指标"></a>配置Prometheus采集Node Exporter指标</h3><p>在<code>prometheus.yml</code>中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;localhost:9100&#x27;</span>]</span><br></pre></td></tr></table></figure><h2 id="告警配置"><a href="#告警配置" class="headerlink" title="告警配置"></a>告警配置</h2><h3 id="创建告警规则"><a href="#创建告警规则" class="headerlink" title="创建告警规则"></a>创建告警规则</h3><p>在<code>prometheus.yml</code>同级目录创建<code>alert.rules.yml</code>：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">groups:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">example</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">HighCPULoad</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="number">100</span> <span class="bullet">-</span> <span class="string">(avg</span> <span class="string">by(instance)</span> <span class="string">(irate(node_cpu_seconds_total&#123;mode=&quot;idle&quot;&#125;[5m]))</span> <span class="string">*</span> <span class="number">100</span><span class="string">)</span> <span class="string">&gt;</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">5m</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;High CPU load (instance <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>)&quot;</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">&quot;CPU load is &gt; 80%\n  VALUE = <span class="template-variable">&#123;&#123; $value &#125;&#125;</span>\n  LABELS: <span class="template-variable">&#123;&#123; $labels &#125;&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><h3 id="在prometheus-yml中引用规则文件"><a href="#在prometheus-yml中引用规则文件" class="headerlink" title="在prometheus.yml中引用规则文件"></a>在prometheus.yml中引用规则文件</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;alert.rules.yml&quot;</span></span><br></pre></td></tr></table></figure><h2 id="与Grafana集成"><a href="#与Grafana集成" class="headerlink" title="与Grafana集成"></a>与Grafana集成</h2><p>Grafana是可视化监控数据的最佳选择，与Prometheus配合使用效果极佳：</p><ol><li><p><strong>安装Grafana</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name grafana \</span><br><span class="line">  -p 3000:3000 \</span><br><span class="line">  grafana/grafana</span><br></pre></td></tr></table></figure></li><li><p><strong>添加Prometheus数据源</strong>：</p><ul><li>访问<code>http://localhost:3000</code>（默认用户名&#x2F;密码：admin&#x2F;admin）</li><li>配置 -&gt; 数据源 -&gt; 添加数据源 -&gt; 选择Prometheus</li><li>URL设置为<code>http://prometheus:9090</code>（如果在同一网络）或<code>http://localhost:9090</code></li></ul></li><li><p><strong>导入仪表盘</strong>：</p><ul><li>Grafana官方提供了许多预配置的仪表盘，如Node Exporter仪表盘ID: 1860</li></ul></li></ol><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ol><li><strong>合理设置采集间隔</strong>：根据监控需求和资源消耗平衡</li><li><strong>使用标签进行多维度分析</strong>：充分利用Prometheus的标签系统</li><li><strong>设置适当的数据保留期</strong>：避免存储空间过度消耗</li><li><strong>实施高可用性</strong>：关键环境中部署Prometheus的高可用方案</li><li><strong>定期备份数据</strong>：使用<code>prometheus</code>的<code>--storage.tsdb.path</code>选项指定数据存储路径</li></ol><h2 id="常见问题排查"><a href="#常见问题排查" class="headerlink" title="常见问题排查"></a>常见问题排查</h2><ol><li><strong>无法抓取目标</strong>：检查网络连接、防火墙设置和目标服务状态</li><li><strong>数据不完整</strong>：检查采集间隔和数据保留策略</li><li><strong>高内存使用</strong>：调整查询复杂度和并发查询数量</li><li><strong>告警未触发</strong>：验证告警规则表达式和阈值设置</li></ol><h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ul><li><a href="https://prometheus.io/docs/introduction/overview/">Prometheus官方文档</a></li><li><a href="https://github.com/prometheus/prometheus">Prometheus GitHub仓库</a></li><li><a href="https://grafana.com/docs/">Grafana官方文档</a></li><li><a href="https://prometheus.io/docs/practices/naming/">Prometheus最佳实践</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Prometheus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 入门基础（一）</title>
      <link href="/2023/02/24/Java_%E5%85%A5%E9%97%A8/"/>
      <url>/2023/02/24/Java_%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="javaSE基础"><a href="#javaSE基础" class="headerlink" title="javaSE基础"></a>javaSE基础</h1><h2 id="javaSe-整体大纲"><a href="#javaSe-整体大纲" class="headerlink" title="javaSe 整体大纲"></a>javaSe 整体大纲</h2><ol><li>java基础 （循环，数组）</li><li>OOP</li><li>API</li></ol><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><ul><li>编程的本质&#x3D;数据结构+算法</li><li>什么是编程：就是让计算机按自己的意图去工作</li></ul><h2 id="编程语言的发展史（了解）"><a href="#编程语言的发展史（了解）" class="headerlink" title="编程语言的发展史（了解）"></a>编程语言的发展史（了解）</h2><ol><li>机器语言：0101</li><li>汇编语言:   助记符</li><li>高级语言：java,c,c++,python,basic</li></ol><h2 id="为什么是java"><a href="#为什么是java" class="headerlink" title="为什么是java"></a>为什么是java</h2><p>流行的语言：</p><ul><li>java,python,c,C++,javascript,go…..</li><li>语言没有好坏之分，只有适不适用？</li></ul><p>厨房中的刀，哪把刀更好：砍刀，切菜刀，西瓜刀，水果刀？</p><ul><li>每个语言都有适用的场景</li><li>数据分析：python,</li><li>3D游戏：C++   </li><li>前端页面：javascript</li><li>应用程序的后台：java</li></ul><h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2><p>1.学习方法：编码-》巩固-》检索    3F：focus-&gt;feedback-&gt;fix<br>2.课程   se:1.基础 2.oop,3API<br>3.编程的基础： 数据结构+算法&#x3D;程序<br>4.编程语言的发展史</p><ol><li>机器语言</li><li>汇编语言</li><li>高级语言</li></ol><p>5.java</p><ul><li>企业后台</li><li>安卓</li><li>大数据</li><li>桌面</li></ul><p>6.java语言的发展史</p><h2 id="java语言的发展"><a href="#java语言的发展" class="headerlink" title="java语言的发展"></a>java语言的发展</h2><p>高斯林（高司令）：嵌入式程序</p><p>99年，三个版本：javase,javame,javaee</p><ul><li>LTS</li><li>JDK8</li><li>JDK11</li><li>JDK17</li></ul><h2 id="java-语言的特点"><a href="#java-语言的特点" class="headerlink" title="java 语言的特点"></a>java 语言的特点</h2><ul><li>面向对象</li><li>简单</li><li>跨平台</li></ul><h2 id="java语言的三个版本"><a href="#java语言的三个版本" class="headerlink" title="java语言的三个版本"></a>java语言的三个版本</h2><ul><li>A：javaSE：标准版本：基础，桌面级应用</li><li>B：javaEE：企业版：服务器端的大网络，分布式</li><li>C：javaME：微型版本：嵌入式设备，小设备</li></ul><p><img src="https://s3.bmp.ovh/imgs/2023/02/24/1a4a6b994af3b594.png"></p><h2 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h2><h3 id="JDK"><a href="#JDK" class="headerlink" title="JDK"></a>JDK</h3><blockquote><p>java development kid:java开发包</p><p>作用：开发，运行java程序</p><p><strong>JRE</strong>:java runtime environmentjava 运行环境</p><p>作用：运行java程序</p><p>JDK包含了JRE</p><p><strong>JVM</strong>：java virtual machine:java虚拟机</p><p>作用：用来运行java程序  不包含类库和命令</p><p>JDK中包含了JRE，JRE中包含了JVM</p></blockquote><h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><p>建议：安装 11，8，</p><p>安装注意事项</p><ol><li>傻瓜式安装，按步骤来就行</li><li>安装路径不要有空格，不要使用中文路径   </li><li>安装后会有两个目录<ul><li>bin:包含了java命令：javac(编译)，java(运行)，javadoc(生成文档)</li><li>lib:包含了java类库</li></ul></li></ol><p>配置：</p><blockquote><p>配置环境变量？</p></blockquote><h2 id="DOS命令"><a href="#DOS命令" class="headerlink" title="DOS命令"></a>DOS命令</h2><p>DOS：disk operation system：命令行   </p><blockquote><p>命令：</p></blockquote><ul><li><p>cd:改变目录</p></li><li><p>dir:查看当前目录下的内容</p></li><li><p>盘符：切换到其它盘，例如 D:</p></li><li><p>d:切换到D盘</p></li><li><p>cd ..:切换到上层目录</p></li><li><p>cd bin:进入取bin子目录</p></li><li><p>dir:显示当前目录中的内容   </p><blockquote><p>问题？<br>java.exe,javac.exe在  d:&#x2F;java&#x2F;jdk-11.0.8&#x2F;bin下，如果想使用java,javac命令，必须先进入到d:&#x2F;java&#x2F;jdk-11.0.8&#x2F;bin下才可以使用，如果希望在任何一个目录下都使用此命令，则需要配置环境变量才可以   </p><p>环境变量中有一个叫path的<br>path的作用是，当运行一个命令时，先从当前路径找，如找不到，再去path中找   </p><p>如果在path中设置一个值  d:&#x2F;java&#x2F;jdk-11.0.8&#x2F;bin<br>当我们在 e:盘下，运行  java</p></blockquote></li><li><p>1.先在 e:&#x2F;下找java</p></li><li><p>2.如找不到，再到path下找</p></li></ul><blockquote><p>环境变量<br>path:路径<br>classpath:类路径   .d:&#x2F;java&#x2F;jdk-11.0.8&#x2F;lib</p></blockquote><p>window: 图形界面</p><p>android:图形</p><p>linux:有图形 </p><h2 id="第一个java程序"><a href="#第一个java程序" class="headerlink" title="第一个java程序"></a>第一个java程序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;这是我的第一个java程序，我好高兴呀，今天晚上给自己加一个鸡腿吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>HelloWorld:是类名，类名必须要与文件名相同   （HelloWorld.java</li><li>System.out.println(“”)：代表输出   “”中可以写任何字符串 </li><li>所有的标点符号都是英文半角   </li><li>java是区分大小写的</li></ol><p>​</p><h2 id="HelloWorld详解"><a href="#HelloWorld详解" class="headerlink" title="HelloWorld详解"></a>HelloWorld详解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">       </span><br><span class="line">       System.out.println();</span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Hello是类名</span></span><br><span class="line"><span class="comment">//public static void main(String[] args):是主函数，程序的入口，如果想直接运行此类，必须有此方法  </span></span><br><span class="line"><span class="comment">//System.out.println();输出内容后换行</span></span><br><span class="line"><span class="comment">//System.out.print();输出内容后不换行</span></span><br><span class="line"><span class="comment">//无论是print还是println都只能输出一个内容，内容可以是字符串，数字，布尔等等  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//9+9  </span></span><br><span class="line"><span class="comment">//&quot;hello&quot;+&quot;hello&quot;+9</span></span><br></pre></td></tr></table></figure><h2 id="java命令"><a href="#java命令" class="headerlink" title="java命令"></a>java命令</h2><blockquote><p>javac:编译<br>java:运行<br>javadoc:生成文档</p></blockquote><blockquote><p>javac语法</p><p>javac 文件名.java<br>javac HelloWorld.java<br>作用：将.java的源代码编译成.class文件，如果代码有错误，将无法完成编译   </p></blockquote><blockquote><p>java 语法</p><p>java 类名<br>java HelloWorld<br>注意：千万不要写.class<br>作用：运行java类，要求此类必须有主函数   </p></blockquote><blockquote><p>javadoc:生成文档<br>javadoc 类名.java</p></blockquote><h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><blockquote><p>作用：为了让程序员更容易理解代码的含义，可以使用注释加以说明   注释不会影响代码的运行</p><p>注释有三种   </p><p>&#x2F;&#x2F;:单行<br>&#x2F;*  <em>&#x2F;：块注释<br>&#x2F;</em>* *&#x2F;：文档注释</p></blockquote><h1 id="java编程基础"><a href="#java编程基础" class="headerlink" title="java编程基础"></a>java编程基础</h1><h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><ul><li><p>什么是关键字：在java语言有，有特殊含义的一些单词就是关键字   </p></li><li><p>关键字的特点：全部都有小写</p></li></ul><h2 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h2><ul><li>什么标识符：用来标识某种东西的符号就是标识符</li></ul><blockquote><p>比如：类，方法名，变量名，参数名，</p></blockquote><p>定义标识符的规则</p><ul><li><p>标识符中可包含字母，数字，_,$,中文也可以（不建议）</p></li><li><p>不能以数字开头</p></li><li><p>不能是关键字</p></li><li><p>长度无限制，最好做到“见名知义”</p><p>  ​</p></li></ul><p></p><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>变量：就是内存中的一个区域，为了便于使用，需要给变量起个名字</p><p>变量用法：</p><ol><li><p>变量一定要先定义，再使用</p></li><li><p>定义变量的格式是 </p><blockquote><p>数据类型 变量名&#x3D;初始值</p></blockquote></li><li><p>变量的值是可以改变的</p></li><li><p>在一个作用域中，变量名是不能重复的</p></li></ol><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>java的数据类型分为两大类，分别是</p><ul><li>基本数据类型</li><li>引用数据类型<ul><li>类，接口，数组</li></ul></li></ul><h3 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h3><ul><li><p>整数</p><ul><li>byte  :1</li><li>short:1</li><li>int :2</li><li>long:2</li></ul></li><li><p>浮点数</p><ul><li>float:45.6f</li><li>double:444.4</li></ul></li><li><p>字符</p><ul><li>char     ‘a’</li></ul></li><li><p>布尔</p><ul><li>boolean  :true,false</li></ul></li></ul><h4 id="整数："><a href="#整数：" class="headerlink" title="整数："></a>整数：</h4><ul><li><p>byte:1个字节</p><ul><li><p>位（bit）</p><p>01：bit，每个一个bit只能存储两个值   </p><p>一个字节等于8位二进制</p><blockquote><p>10101011</p></blockquote><p>byte &#x3D; -128~127;</p></li></ul><p></p></li><li><p>short:2个字节</p></li><li><p>int:4个字节</p></li><li><p>long:8个字节</p></li></ul><h4 id="关于容量的换算关系"><a href="#关于容量的换算关系" class="headerlink" title="关于容量的换算关系"></a>关于容量的换算关系</h4><p>字节 B   byte</p><p>1KB-&gt;1024B</p><p>1MB-&gt;1024KB</p><p>1GB-&gt;1024MB</p><p>1TB-&gt;1024GB</p><p>1PB-&gt;1024TB</p><h4 id="进制的转换"><a href="#进制的转换" class="headerlink" title="进制的转换"></a>进制的转换</h4><blockquote><p>1.10进制-》二进制<br>        除2取余法   </p><p>2.二进制-》十进制<br>        乘权相加法<br>    110101<br>    1+4+16+32&#x3D;53<br>3.二进制-》十六进制<br>    1011 1010<br>      B   A<br>     100011111<br>4.十六进制-》二进制<br>     6E-》</p></blockquote><h3 id="字面值（literal）"><a href="#字面值（literal）" class="headerlink" title="字面值（literal）"></a>字面值（literal）</h3><p>字面值也叫直接量   </p><blockquote><p>1.整数的字面值的类型默认为是int<br>2.十六进制 0x开头<br>3.八进制以0开头，例如  int a&#x3D;011<br>4.如果想表示一个long值，可以使用 L结尾，例如 long a&#x3D;12312312399L</p></blockquote><h3 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h3><table><thead><tr><th></th><th>字节</th><th>范围</th></tr></thead><tbody><tr><td>float</td><td>4</td><td>-3.403E38 ~ 3.403E38</td></tr><tr><td>double</td><td>8</td><td>-1.798E308 ~ 1.798E308</td></tr></tbody></table><blockquote><p>总结<br>1.浮点数只能表示出一个近似数，而不能表示出一个准确的数<br>2.浮点数的字值的类型是double,如果想表示一个float，应该使用 F结尾   </p></blockquote><h3 id="字符型"><a href="#字符型" class="headerlink" title="字符型"></a>字符型</h3><p>用 一对‘’引起的单个字符就是字符，字符可以以数字，英文字母，标点符号，还可以表示任何语言的单字符   例如，中文，法文，俄文，日文   </p><blockquote><p>每个字符存储时，都会转换成与之对应的数字<br>字符与数字之间的对应关系就是一种字符集   UTF-8   GBK,GB2312<br>char有三种表示方式<br>1.‘’<br>2.‘\转义字符’ ，例如 ‘\n’:换行<br>3.unicode码    ‘\uXXXX’</p></blockquote><h3 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h3><blockquote><p>boolean叫布尔<br>只有两个值，分别是true,false<br>通常来说，可以使用boolean来存储一个状态   </p><p>是否打开音乐<br>boolean isMusic&#x3D;false</p></blockquote><h3 id="String类型"><a href="#String类型" class="headerlink" title="String类型"></a>String类型</h3><blockquote><p>String代表字符串，即用双引号引起的多个字符序列<br>String不是基本数据类型，而是一种引用类型   </p><p>String name&#x3D;”刘备”</p></blockquote><h2 id="java代码三级跳"><a href="#java代码三级跳" class="headerlink" title="java代码三级跳"></a>java代码三级跳</h2><blockquote><p>1.表达式<br>    类似于语文中的汉字，词组，例如 a+b,c*d<br>2.语句<br>    类似于语文中的句子。以   号结束   一个语句中会包含多个表达式，</p><p>​    int a&#x3D;5;<br>​int b&#x3D;a+b;<br>​c&#x3D;sum+a;<br>3.代码段<br>​相当于语文的作文，一个代码段中包含多个语句   </p></blockquote><h2 id="数据类型的转换"><a href="#数据类型的转换" class="headerlink" title="数据类型的转换"></a>数据类型的转换</h2><blockquote><p>两种转换<br>1.自动转换：低精度向高精度可以自动转换，安全<br>2.强制转换：高精度向低精度转换时可以采用强制转换，强转可能会造成精度丢失   </p></blockquote><blockquote><p>数值类的的精度<br>byte-&gt;short-&gt;int-&gt;long-&gt;float-&gt;double<br>         char</p></blockquote><h4 id="自动类型转换发生在两种情况"><a href="#自动类型转换发生在两种情况" class="headerlink" title="自动类型转换发生在两种情况"></a>自动类型转换发生在两种情况</h4><ul><li>赋值</li><li>运算</li></ul><h4 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h4><ul><li>高精度向低精度转换时，可使用强转</li><li>强转的语法是  （数据类型）   例如  long b&#x3D;6677;  int a&#x3D;(int)b;</li></ul><h2 id="Scanner"><a href="#Scanner" class="headerlink" title="Scanner"></a>Scanner</h2><blockquote><p>&#x2F;&#x2F;有交互的程序<br>交互的方式主要用两种<br>1.命令行<br>2.图形<br>Scanner叫扫描器，他可以接收用户输入的数据   例如数字，字符串，布尔值等   </p></blockquote><blockquote><p>使用Scanner的步骤<br>1.导包 import java.util.*<br>2.创建Scanner对象<br>    Scanner s&#x3D;new Scanner(System.in)<br>3.接收数据<br>    int a&#x3D;s.nextInt()</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;  <span class="comment">//1.导包</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Circle</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//2.创建一个扫描器  </span></span><br><span class="line">Scanner scanner=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入半径&quot;</span>);</span><br><span class="line"><span class="comment">//3.接收一个半径</span></span><br><span class="line"><span class="type">double</span> r=scanner.nextDouble();</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> area=r*r*<span class="number">3.14</span>;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;圆的面积是：&quot;</span>+area);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><p> 运算符可以有两种分在方式</p><ol><li>功能<ul><li>算术运算符</li><li>赋值运算符</li><li>比较运算符</li><li>位运算符</li><li>逻辑运算符</li><li>条件（三元）运算符</li></ul></li><li>操作数的个数<ul><li>一元操作符：    ++b, </li><li>二元操作符：    a+b</li><li>三元操作符      a&gt;b?a:b</li></ul></li></ol><h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">++,--</span><br><span class="line">可以放在操作数之前，也可以放在操作数之后  </span><br><span class="line"></span><br><span class="line">a++操作符有作用  </span><br><span class="line"><span class="number">1.</span>对a做一个加操作  </span><br><span class="line"><span class="number">2.</span>a++也是一个表达式，即将表达式的结果赋给一个变量  </span><br><span class="line">b=a++;</span><br><span class="line">b=++a;</span><br><span class="line"></span><br><span class="line">a++;</span><br><span class="line">++a;</span><br></pre></td></tr></table></figure><h3 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=</span><br><span class="line">例如： a=<span class="number">9</span>+<span class="number">8</span>;</span><br><span class="line">特点：</span><br><span class="line"><span class="number">1.</span>操作符的结合性是从右到左  </span><br><span class="line"><span class="number">2.</span>操作符左侧一定是一个变量  </span><br></pre></td></tr></table></figure><h3 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">==  </span><br><span class="line">!=</span><br><span class="line">&lt;</span><br><span class="line">=</span><br><span class="line">&lt;=</span><br><span class="line"><span class="keyword">instanceof</span></span><br><span class="line"></span><br><span class="line">所有比较运算符的计算结果的类型都是<span class="type">boolean</span>; <span class="literal">true</span>,<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">注意，</span><br><span class="line">=是赋值</span><br><span class="line">==是比较  </span><br></pre></td></tr></table></figure><h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">与： &amp; ,&amp;&amp;</span><br><span class="line">或:  |  ||</span><br><span class="line">非：  !</span><br><span class="line">异或： ^</span><br><span class="line"></span><br><span class="line">与的语法</span><br></pre></td></tr></table></figure> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">表达式<span class="number">1</span>  &amp; 表达式<span class="number">2</span>  </span><br><span class="line">表达式<span class="number">1</span>  &amp;&amp; 表达式<span class="number">2</span>  </span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> 要求，两个表达式都是布尔表达式  </span><br><span class="line"> 即，两个表达式的结果同时为<span class="literal">true</span>时，与后的结果才<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">或：  ｜  ｜｜</span><br><span class="line">作用：两个操作数的结果，只要有一个为<span class="literal">true</span>,那么或的结果就为<span class="literal">true</span>;</span><br><span class="line">非：</span><br><span class="line">取反  </span><br><span class="line">!<span class="literal">true</span>;=<span class="literal">false</span>;</span><br><span class="line">!<span class="literal">false</span>:=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">异或：</span><br><span class="line">作用：两个操作数不同时为<span class="literal">true</span>,否则为<span class="literal">false</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&amp;,&amp;&amp;的区别？</span><br><span class="line">&amp;，&amp;&amp;都是逻辑与，计算的结果是相同的  但运算的过程是有区别的？</span><br><span class="line">例如</span><br><span class="line">a&amp;&amp;b;</span><br><span class="line">假如，a的结果是<span class="literal">false</span>;那么是否需要计算b，才知道整个表达式的结果  </span><br><span class="line"></span><br><span class="line">区别：</span><br><span class="line">&amp;：无论第一个操作数结果是什么，都会计算所有表达式  </span><br><span class="line">&amp;&amp;：如果第一个操作数的结果是<span class="literal">false</span>,那么将不会计算第二个表达式  </span><br></pre></td></tr></table></figure><h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">操作对象：整数（<span class="type">byte</span>,<span class="type">short</span>,<span class="type">int</span>,<span class="type">long</span>）  </span><br><span class="line">作用：将整数转换成二进制后，按位进行运算  常用的操作有，位移，按位与，或，异或  </span><br><span class="line">位运算的优点：效率高  </span><br><span class="line"></span><br><span class="line">:按位右移</span><br><span class="line">&lt;&lt;:按位左移</span><br><span class="line"></span><br><span class="line">:无符号右移</span><br><span class="line">&amp;:按位与</span><br><span class="line">|:按位或</span><br><span class="line">^:按位异或</span><br><span class="line"></span><br><span class="line"><span class="number">895</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="条件运算符"><a href="#条件运算符" class="headerlink" title="条件运算符"></a>条件运算符</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">语法</span><br><span class="line">布尔表达式？表达式<span class="number">1</span>：表达式<span class="number">2</span>  </span><br><span class="line"><span class="type">int</span> c=a&gt;b？a：b;</span><br></pre></td></tr></table></figure><h1 id="Java进阶"><a href="#Java进阶" class="headerlink" title="Java进阶"></a>Java进阶</h1><h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><blockquote><p>三种<br>顺序结构<br>分支（选择）结构：branch<br>循环结构：loop</p></blockquote><blockquote><p>顺序：<br>    程序从上到下，依次执行   </p></blockquote><h2 id="分支语句"><a href="#分支语句" class="headerlink" title="分支语句"></a>分支语句</h2><p>分支语句分为if,switch</p><h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><h3 id="单分支"><a href="#单分支" class="headerlink" title="单分支"></a>单分支</h3><p>语法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(布尔表达式)&#123;</span><br><span class="line">   语句块 </span><br><span class="line">&#125;</span><br><span class="line">。。</span><br></pre></td></tr></table></figure><blockquote><p>适用场景：<br>    为程序增加一个可能执行的代码，此代码有可能执行，有可能不执行   </p></blockquote><h3 id="双分支"><a href="#双分支" class="headerlink" title="双分支"></a>双分支</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(布尔表达式)&#123;</span><br><span class="line">    语句块<span class="number">1</span>  </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    语句块<span class="number">2</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="多分支"><a href="#多分支" class="headerlink" title="多分支"></a>多分支</h3><p>语法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(布尔表达式)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(布尔表达式<span class="number">2</span>)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(布尔表达式<span class="number">3.</span>。。。)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>关于if的小结<br>1.完整的if语句中，包含 if-else if-else<br>2.if语法中，if是必须存在的， else if可有0到n个，可以有0到1个else<br>3.如果存在else,else一定放在最后<br>4.多分支语句中，最多只能执行一个分支，执行此分支后，分支语句结束   </p></blockquote><h3 id="if的嵌套"><a href="#if的嵌套" class="headerlink" title="if的嵌套"></a>if的嵌套</h3><blockquote><p>在一个分支语句块中包含另一个分支语句<br>适用场景：适合解决较为复杂的逻辑问题   </p></blockquote><blockquote><p>例如：<br>    登录<br>    1.成功 用户名，密码，验证码<br>    2.失败<br>        1.验证码？<br>        2.用户名，或密码错误，但少于3次<br>        3.用户名，或密码错误，但大于等于3次   锁定（1个小时）   </p></blockquote><p>语法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(条件)&#123;</span><br><span class="line">System.out.println();</span><br><span class="line">i++;</span><br><span class="line"><span class="keyword">if</span>()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(条件)&#123;</span><br><span class="line"><span class="keyword">if</span>()&#123;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="if语句的简化"><a href="#if语句的简化" class="headerlink" title="if语句的简化"></a>if语句的简化</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果if语句块中只包含一行代码，那么｛｝可以省略，（但不建议省略）</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">true</span>)</span><br><span class="line">System.out.println(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">System.out.println(<span class="string">&quot;else&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="switch-语句"><a href="#switch-语句" class="headerlink" title="switch 语句"></a>switch 语句</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语法</span></span><br><span class="line"><span class="keyword">switch</span>(表达式)&#123;</span><br><span class="line"><span class="keyword">case</span> 值<span class="number">1</span>：</span><br><span class="line">语句;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> 值<span class="number">2</span>：</span><br><span class="line">语句;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">语句<span class="number">3</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//输入一个成绩   5，4，3，2，1，0  </span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>关于break;<br>在switch语句中，如果case 没有break,那么将会穿透   </p></blockquote><blockquote><p>解决问题<br>输入月份，判断此月有多少天？<br>2:28，29<br>1，3，5，7，8，10，12:31<br>4,6,9,11:30</p><p>case:<br>    2,<br>    4,<br>    6,<br>    9,11</p><p>default:</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Switch2</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> </span><br><span class="line">&#123;</span><br><span class="line">Scanner s=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;输入月份&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> month=s.nextInt();</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(month)&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">System.out.println(<span class="string">&quot;28或29天&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">System.out.println(<span class="string">&quot;30天&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">System.out.println(<span class="string">&quot;31天&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>使用switch的注意事项<br>1.switch只能使用等值比较，而且对数据类型有要求（byte,short,int,char,String）<br>2.注意 case穿透   （break）<br>3.switch的结果清晰，但没有if应用的广泛   </p></blockquote><h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><blockquote><p>语法很简单，练习是关键</p></blockquote><h3 id="循环语句的三个部分"><a href="#循环语句的三个部分" class="headerlink" title="循环语句的三个部分"></a>循环语句的三个部分</h3><blockquote><p>1.初始化部分（1次）<br>2.条件部分（多次）<br>3.循环体部分   (多次)</p></blockquote><h3 id="java中，循环语句的分类"><a href="#java中，循环语句的分类" class="headerlink" title="java中，循环语句的分类"></a>java中，循环语句的分类</h3><blockquote><p>1.while<br>2.do-while<br>3.for</p></blockquote><h3 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语法</span></span><br><span class="line">[初始化语句]</span><br><span class="line"><span class="keyword">while</span>(表达式)&#123;</span><br><span class="line">循环体语句;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><blockquote><p>1+2+3+4…..+100;</p><p>int sum&#x3D;0;&#x2F;&#x2F;定义一个变量   用来存储累加的和</p><p>int i&#x3D;1;<br>sum+&#x3D;i;(1.2,3,4,5,5.6,7)</p></blockquote><blockquote><p>盈盈为了考验令狐冲夺冠的决心，要他说一百遍“我能行！”;<br>1+…100;</p></blockquote><h3 id="死循环"><a href="#死循环" class="headerlink" title="死循环"></a>死循环</h3><blockquote><p>死循环：无法结束的循环被称为死循环   </p></blockquote><h3 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h3><p>内层可以使用外层的变量，外层不能使用内层的变量</p><h3 id="do-while"><a href="#do-while" class="headerlink" title="do-while"></a>do-while</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//do-while循环</span></span><br><span class="line">[初使化变量]</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">循环体  </span><br><span class="line">&#125;<span class="keyword">while</span>(布尔表达式);</span><br><span class="line"></span><br><span class="line">特点：至少进入一次循环体  </span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//猜数游戏</span></span><br><span class="line">Random r=<span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="type">int</span> n=r.nextInt(<span class="number">10</span>);<span class="comment">//产生一个随机数，（整数）</span></span><br><span class="line"><span class="type">int</span> i=<span class="number">0</span>;<span class="comment">//代表用户猜的那个数值</span></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line"><span class="comment">//猜数  </span></span><br><span class="line">&#125;<span class="keyword">while</span>(n!=i)</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算一下，用户用了几次机会  </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GuessNumber</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> </span><br><span class="line">&#123;</span><br><span class="line">Random r=<span class="keyword">new</span> <span class="title class_">Random</span>();<span class="comment">//创建一个随机数生成器  </span></span><br><span class="line">Scanner s=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);<span class="comment">//创建一个扫描器，用来接收用户猜的数字</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n=r.nextInt(<span class="number">100</span>)+<span class="number">1</span>;<span class="comment">//获得一个随机数  </span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> i=<span class="number">0</span>;<span class="comment">//i代表用户每次猜的那个数，如果i==n,说明猜对了  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line"><span class="comment">//每次猜数</span></span><br><span class="line">System.out.println(<span class="string">&quot;说出一个数字&quot;</span>);</span><br><span class="line">i=s.nextInt();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i&gt;n)&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;高了&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(i&lt;n)&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;低了&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">while</span>(i!=n);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;你猜对了，这个数就是：&quot;</span>+n);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(初始化变量;条件表达式;循环体的最后一个表达式  )&#123;</span><br><span class="line">循环体  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//特点：非常适用于已知循环次数的程序  </span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">sum+=i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.int i=0;</span></span><br><span class="line"><span class="comment">//2( i&lt;100;  sum+=i; i++)</span></span><br></pre></td></tr></table></figure><h3 id="break-与-continue"><a href="#break-与-continue" class="headerlink" title="break 与 continue"></a>break 与 continue</h3><blockquote><p>break与continue都是关键字，可以在循环体中使用   （for,while,do-while）</p><p>break:结束当前循环（退出循环）<br>continue:结束当次循环，进入下一次循环判断   </p></blockquote><h3 id="嵌套循环"><a href="#嵌套循环" class="headerlink" title="嵌套循环"></a>嵌套循环</h3><blockquote><p>语法结构：<br>    在一个循环体中，包含另外一个循环语句，这种结构就是嵌套循环   </p></blockquote><h3 id="循环中的算法"><a href="#循环中的算法" class="headerlink" title="循环中的算法"></a>循环中的算法</h3><blockquote><p>暴力（穷举）：数字，字母，特殊字符   </p><p>顺推：已知条件推结果</p><p>逆推：已知结果推条件   </p></blockquote><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><h3 id="数组的定义"><a href="#数组的定义" class="headerlink" title="数组的定义"></a>数组的定义</h3><blockquote><p>1.数组是一种引用数据类型，它可以存储多个相同类型的数据   </p><p>2.数组的长度一旦定义，不能改变</p><p>3.数组中的元素可以通过下标来访问，下标的取值范围是0~长度-1</p></blockquote><h3 id="数组-1"><a href="#数组-1" class="headerlink" title="数组"></a>数组</h3><p>数组元素的初始化   </p><blockquote><p>动态：创建数组后，为元素分别赋值</p><p>静态：创建数组的同时，为元素赋值   </p></blockquote><p>for each</p><blockquote><p>增强的for循环   </p><p>作用：遍历集合中的数据   </p><p>语法：</p><p>for(数据类型 变量:数组名){</p><p>}</p><p>将数组中的元素转成字符串   </p><p>Arrays.toString(数组)</p></blockquote><h3 id="内存模型"><a href="#内存模型" class="headerlink" title="内存模型"></a>内存模型</h3><p>java虚拟机将内容主要分为两个区域，分别是栈和堆</p><blockquote><p>基本数据类型，存在栈中   </p><p>int i&#x3D;9;</p><p>基本数据类型变量存储的是数据本身   </p></blockquote><blockquote><p>引用类型是存储在堆中的   </p><p>引用类型有数组，类，接口   </p><p>int[] a&#x3D;new int[5];</p></blockquote><h2 id="排序及二维数组"><a href="#排序及二维数组" class="headerlink" title="排序及二维数组"></a>排序及二维数组</h2><h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><blockquote><p>什么是算法：</p><p>其实就是解决问题？</p><p>如何衡量算法优劣？</p><p>时间</p><p>空间</p><p>时间复杂度：大O表示法   </p><p>O(1):固定次数，常数</p><p>O(logn):二分</p><p>O(n):一层循环</p><p>O(n方):二层循环</p><p>O(n的立方):三层循环</p><p>O(2的n次幂)：</p><p>O(n!):</p></blockquote><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><blockquote><p>排序是最常的算法   </p><p>直接选择排序？</p><p>冒泡排序？</p><p>未排序，已排序   </p><p>相邻比较并交换。整个的过程就像冒水泡一样   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="comment">//冒泡排序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BubbleSort</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>[] nums=&#123;<span class="number">12</span>,<span class="number">45</span>,<span class="number">78</span>,<span class="number">5</span>,<span class="number">75</span>,<span class="number">33</span>,<span class="number">23</span>,<span class="number">47</span>&#125;;</span><br><span class="line">        <span class="type">int</span> temp=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//循环n-1次  </span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line"><span class="comment">//通过冒泡，每次从未排序堆中选一个最大的，放在已排序堆中</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;nums.length-<span class="number">1</span>-i;j++)&#123;</span><br><span class="line"><span class="comment">//交换</span></span><br><span class="line">                <span class="keyword">if</span>(nums[j]&gt;nums[j+<span class="number">1</span>])&#123;</span><br><span class="line">                    temp=nums[j];</span><br><span class="line">                    nums[j]=nums[j+<span class="number">1</span>];</span><br><span class="line">                    nums[j+<span class="number">1</span>]=temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Arrays.toString(nums));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="comment">//直接选择排序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Sort3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>[] nums=&#123;<span class="number">30</span>,<span class="number">78</span>,<span class="number">90</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">67</span>&#125;;</span><br><span class="line"><span class="comment">//将最大的元素与第一个元素进行交换   </span></span><br><span class="line"><span class="comment">//1.定义一个变量，用来存储最大元素的下标</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="type">int</span> max=i;</span><br><span class="line"><span class="comment">//1.向未排序堆中找出最大的元素的下标   </span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;nums.length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[max]&lt;nums[j])&#123;</span><br><span class="line">                    max=j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//2.交换   </span></span><br><span class="line">            <span class="keyword">if</span>(max!=i)&#123;</span><br><span class="line">                <span class="type">int</span> temp=nums[max];</span><br><span class="line">                nums[max]=nums[i];</span><br><span class="line">                nums[i]=temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Arrays.toString(nums));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h3><blockquote><p>二分法，也称为折半查找法   前提是，数据一定是已排序的。</p><p>时间复杂度为O(logn)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BinarySearch</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>[] nums=&#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">56</span>,<span class="number">67</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">100</span>&#125;;</span><br><span class="line">        Scanner s=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入一个数&quot;</span>);</span><br><span class="line">        <span class="type">int</span> n=s.nextInt();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> j=nums.length-<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> m=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//1.编写代码，完成查询，如果找到了，输出位置，否则，输出“查无此数”   </span></span><br><span class="line"><span class="comment">//2.分别使用O(n) O(logn)来解决？</span></span><br><span class="line">        <span class="keyword">while</span>(i&lt;=j)&#123;</span><br><span class="line"><span class="comment">//1.计算出中间位置   </span></span><br><span class="line">            m=(i+j)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(n==nums[m])&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;找到了，位置是：&quot;</span>+m);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[m]&gt;n)&#123;</span><br><span class="line">                j=m-<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                i=m+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;j)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;查无此数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">            </span><br></pre></td></tr></table></figure><h3 id="二位数组"><a href="#二位数组" class="headerlink" title="二位数组"></a>二位数组</h3><p>二维数组</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java中其实没有二维数组，所谓的二维数组其实就是一个数组，只不过数组中的元素还是一个数组   </span><br><span class="line"></span><br><span class="line"><span class="type">int</span>[] nums=&#123;<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> nums=<span class="keyword">new</span> <span class="title class_">int3</span>;</span><br><span class="line"></span><br><span class="line">二维数组的初使化</span><br><span class="line"></span><br><span class="line">静态初使化</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> nums=&#123;&#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>&#125;,&#123;<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>&#125;,&#123;<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">3</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">动态初使化   </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> nums=<span class="keyword">new</span> <span class="title class_">int3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> nums=<span class="keyword">new</span> <span class="title class_">int3</span>;</span><br><span class="line"></span><br><span class="line">nums[<span class="number">0</span>]=<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>&#125;;</span><br><span class="line"></span><br><span class="line">nums[<span class="number">1</span>]=<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">333</span>,<span class="number">56</span>&#125;;</span><br><span class="line"></span><br><span class="line">nums[<span class="number">2</span>]=<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">4</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;;</span><br><span class="line"></span><br><span class="line">String names=&#123;&#123;<span class="string">&quot;刘备&quot;</span>,<span class="string">&quot;张飞&quot;</span>,<span class="string">&quot;关羽&quot;</span>&#125;,&#123;<span class="string">&quot;曹操&quot;</span>&#125;,&#123;<span class="string">&quot;孙权&quot;</span>,<span class="string">&quot;周瑜&quot;</span>&#125;&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="面向对象OOP"><a href="#面向对象OOP" class="headerlink" title="面向对象OOP"></a>面向对象OOP</h1><h2 id="面向过程与面向对象"><a href="#面向过程与面向对象" class="headerlink" title="面向过程与面向对象"></a>面向过程与面向对象</h2><blockquote><p>面向对象，强调由谁来做<br>面向过程，强调怎么做</p><p>面向过程：把解决问题的步骤列出来，再逐步实现</p><p>面向对象：将问题域中的对象找出来，再确定它们之间的关系   </p></blockquote><p>面向对象有什么优点</p><blockquote><p>1.更容易理解<br>2.解决复杂的问题，更有优势</p></blockquote><h2 id="面向对象的基础知识"><a href="#面向对象的基础知识" class="headerlink" title="面向对象的基础知识"></a>面向对象的基础知识</h2><blockquote></blockquote><h3 id="什么是对象"><a href="#什么是对象" class="headerlink" title="什么是对象"></a>什么是对象</h3><blockquote><p>所有具体的事物都是对象（object）</p></blockquote><h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><blockquote><p>类是一组具有相同属性和行为的一组对象的抽象表示<br>类和对象的关系：<br>  类是对象的抽象表示<br>  对象是类的一个具体实例<br>类是抽象的，对象是具体的</p></blockquote><p>class ：</p><h3 id="定义类的语法"><a href="#定义类的语法" class="headerlink" title="定义类的语法"></a>定义类的语法</h3><blockquote><p>回顾</p><p>1.面向过程，面向对象的区别？</p><p>2.面向对象的两个重要的概念</p><p>对象，类   </p><p>3.如何定义一个类   </p><p>class 类名｛</p><p>属性   </p><p>方法   </p><p>}</p></blockquote><p>类中都应该有什么</p><blockquote><p>1.定义一个学生类型</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">student</span>&#123;</span><br><span class="line">    <span class="type">int</span> stuno;     <span class="comment">//定义类的属性</span></span><br><span class="line">    String name;</span><br><span class="line">    String sex;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><blockquote><p>大家用过方法吗？</p><p>用过哪呢？</p><p>Random r&#x3D;new Random();</p><p>int i&#x3D;r.nextInt(10);</p><p>方法中都包括什么？</p><p>方法名：</p><p>参数：多个，每个参数都需要有类型   </p><p>返回值类型：</p><p>定义一个方法，判断是否为闰年   </p></blockquote><p>定义方法的语法?</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">返回值类型 方法名（参数列表 ）｛</span><br><span class="line">方法体   </span><br><span class="line">｝</span><br><span class="line"><span class="type">int</span> <span class="title function_">sum</span><span class="params">(<span class="type">int</span> a)</span>&#123;</span><br><span class="line">    <span class="type">int</span> s=(<span class="number">1</span>+a)*a/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> s=num(<span class="number">100</span>);</span><br><span class="line">s=num(<span class="number">50</span>);</span><br></pre></td></tr></table></figure><blockquote><p>形参和实参的区别？</p><p>形参：定义方法时使用的参数，也叫形式参数   </p><p>实参：调用方法，传递的参数，也叫实际参数   </p><p>传参的过程就是赋值   即把实参赋给形参   </p></blockquote><p>return 用法</p><blockquote><p> 1.return语句 可以放在方法体中，代表返回的意思   </p><p>2.如果一个方法中有return 语句，return 一定作为最后一条语句来存在   </p><p>3.return 后的表达式的类型一定要与方法的返回值类型一致   </p><p>4.如果方法返回值类型为void ,那么可以省略return ,或者直接写return</p></blockquote><h3 id="内存结构"><a href="#内存结构" class="headerlink" title="内存结构"></a>内存结构</h3><p>略</p><h3 id="方法的传参"><a href="#方法的传参" class="headerlink" title="方法的传参"></a>方法的传参</h3><blockquote><p>pass by value:按值传递   </p><p>pass by ref:按引用传递   （引用类型）</p></blockquote><h3 id="重载（overload）"><a href="#重载（overload）" class="headerlink" title="重载（overload）"></a>重载（overload）</h3><blockquote><p>方法重载（overload）：同一类中，方法名相同，参数列表不同的一组方法就叫重载方法   </p><p>输出   </p><p>​       System.out.printlnEmpty();</p><p>​       System.out.printlnString(“hello”);</p><p>​       System.out.printlnInt(8);</p><p>参数列表的不同主要体现在三方面</p><p>1.数量不同</p><p>2.类型不同</p><p>3.顺序不同   </p><p>四件套</p><p>1.理解题意，考虑边界问题</p><p>2.找出所有解</p><p>3.编写代码</p><p>4.测试</p><p>leetcode</p></blockquote><h2 id="构造方法及继承"><a href="#构造方法及继承" class="headerlink" title="构造方法及继承"></a>构造方法及继承</h2><h3 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h3><blockquote><p>构造方法是一种特殊的方法<br>构造方法会给属性赋初值<br>构造方法会自动调用</p><p>构造方法与类同名</p></blockquote><h3 id="默认的构造方法"><a href="#默认的构造方法" class="headerlink" title="默认的构造方法"></a>默认的构造方法</h3><blockquote><p>1.每个类都至少有一个构造方法，如果不显式的定义，java编译器会自动为类创建一个无参的构造方法   即默</p><p>认的构造方法</p><p>2.默认的构造方法没有参数，没有方法体   </p><p>3.如果开发者显式的定义了构造方法，那么java编译器将不会再生成默认构造方法   </p></blockquote><h3 id="构造方法不返回值"><a href="#构造方法不返回值" class="headerlink" title="构造方法不返回值"></a>构造方法不返回值</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Student(<span class="type">int</span> no,String name,<span class="type">int</span> age)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//构造方法前面不能加void (添加后会变成一个普通方法)</span></span><br><span class="line">(<span class="keyword">void</span>)Student()&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>默认的构造方法</p><h3 id="就近原则"><a href="#就近原则" class="headerlink" title="就近原则"></a>就近原则</h3><blockquote><p>就近原则：当访问不同作用域同名变量时   寻找最近的同名变量</p></blockquote><h3 id="this关键字"><a href="#this关键字" class="headerlink" title="this关键字"></a>this关键字</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>代表当前对象的属性引用   </span><br><span class="line"><span class="built_in">this</span> 用法：</span><br><span class="line">    <span class="built_in">this</span>.属性</span><br><span class="line">    <span class="built_in">this</span>.普通方法</span><br><span class="line">    <span class="built_in">this</span>().构造方法</span><br><span class="line">       只有在其他的构造方法中才能使用<span class="built_in">this</span>()来调用;</span><br><span class="line">       <span class="built_in">this</span>()必须位于构造方法第一条语句;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>Person p&#x3D;new Person  一共做了几件事</p><p>1,开辟的新的空间</p><p>2,调用构造方法</p><p>3,返回引用赋值给p</p></blockquote><h3 id="匿名块"><a href="#匿名块" class="headerlink" title="匿名块"></a>匿名块</h3><blockquote><p>作用：将每个构造方法中相同的代码可以写在匿名块中   匿名块中的代码一定是在构造方法之前调用。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//代码   </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="关于构造方法的小结"><a href="#关于构造方法的小结" class="headerlink" title="关于构造方法的小结"></a>关于构造方法的小结</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Person p=<span class="keyword">new</span> <span class="title class_">Person</span>(); <span class="comment">//一共做了三件事</span></span><br><span class="line"><span class="number">1.</span>在堆中开辟内存空间</span><br><span class="line"><span class="number">2.</span>调用构造方法，为属性初使化   </span><br><span class="line"><span class="number">3.</span>将引用返回给p;</span><br></pre></td></tr></table></figure><h2 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">照片   </span><br><span class="line">d:/照片/男朋友/男朋友<span class="number">1</span>   </span><br><span class="line">/</span><br><span class="line">语法格式</span><br><span class="line"><span class="keyword">package</span> com.huayu.oop;</span><br><span class="line">导包   </span><br><span class="line"><span class="keyword">import</span> com.huayu.oop.*;</span><br><span class="line"><span class="keyword">import</span> com.huayu.oop.Person;</span><br></pre></td></tr></table></figure><h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><blockquote><p>继承是面向对象编程的最重要的特性之王一，它可以简化类的设计，利用的原有的类来创建新的类</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>关于继承的总结</p><p>1.java中，只支持继承</p><p>2.子类继承父类的属性和方法，并且可以增加新的属性和方法</p><p>3.使用extends关键字来继承</p><p>4.是否可以使用继承 ，可以通过Instanceof 来判断</p></blockquote><h3 id="方法重写"><a href="#方法重写" class="headerlink" title="方法重写"></a>方法重写</h3><blockquote><p>方法重写（override,overwrite）:在继承关系下，子类覆盖父类的方法覆盖时，要求方法名，参数，返回值都相同</p></blockquote><h3 id="关于继承的小结"><a href="#关于继承的小结" class="headerlink" title="关于继承的小结"></a>关于继承的小结</h3><blockquote><p>1.父类有的，子类一定有</p><p>2.父类没有的，子类可以扩展</p><p>3.父类有的，子类可以更改   </p></blockquote><h3 id="super关键字"><a href="#super关键字" class="headerlink" title="super关键字"></a>super关键字</h3><blockquote><p>super代表父类对象的引用<br>通过super关键字,再子类中可以</p></blockquote><h2 id="多态和封装"><a href="#多态和封装" class="headerlink" title="多态和封装"></a>多态和封装</h2><blockquote><p>面向对象的高级特性   </p><p>封装</p><p>继承 ：复用</p><p>多态</p></blockquote><h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><blockquote><p>多态：同一类事物，可以拥有不同的形态</p><p>动物：吃，喝，行走</p><p>狗：</p><p>猫：</p><p>蛇：</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//子类的对象可以替代父类的对象进行使用</span></span><br><span class="line">Student s=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">Person p=s;</span><br><span class="line">父类 s=<span class="keyword">new</span> 子类</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="编译时类型"><a href="#编译时类型" class="headerlink" title="编译时类型"></a>编译时类型</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当我们使用多态时，定义变量时使用的类型称为编译时类型   我们在使用方法和属性时，只能使用编译时类型</span></span><br><span class="line"><span class="comment">//提供的属性和方法   </span></span><br><span class="line">Person p=<span class="keyword">new</span> <span class="title class_">Student</span>();<span class="comment">//此时，编译时类型是Person   </span></span><br><span class="line">Animal a=<span class="keyword">new</span> <span class="title class_">Dog</span>(); <span class="comment">//编译时类型是Animal</span></span><br><span class="line">a=net <span class="title function_">Cat</span><span class="params">()</span>;</span><br><span class="line">a=<span class="keyword">new</span> <span class="title class_">Fish</span>();</span><br><span class="line">a=<span class="keyword">new</span> <span class="title class_">Bird</span>();</span><br></pre></td></tr></table></figure><h3 id="运行时类型"><a href="#运行时类型" class="headerlink" title="运行时类型"></a>运行时类型</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当我们调用多态的方法时，执行期间，调用的是运行时类型的方法   </span></span><br><span class="line">Animal a=<span class="keyword">new</span> <span class="title class_">Dog</span>(); <span class="comment">//编译时类型是Animal，运行时类型是Dog</span></span><br><span class="line">a=net <span class="title function_">Cat</span><span class="params">()</span>; <span class="comment">//编译时类型是Animal，运行时类型是Cat</span></span><br><span class="line">a=<span class="keyword">new</span> <span class="title class_">Fish</span>(); <span class="comment">//编译时类型是Animal，运行时类型是Fish</span></span><br><span class="line">a=<span class="keyword">new</span> <span class="title class_">Bird</span>(); <span class="comment">//编译时类型是Animal，运行时类型是Bird</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><blockquote><p>downcast:向下转型</p><p>upcast:向上转型</p><p>向上转换：直接转换无风险<br>向下转换：有风险</p><p>例如将，Animal转成Dog就是向下转型，向下转型有风险，建议转型前，使用instanceof来判断   否则可能</p><p>会产生ClassCastException（类型转换异常） 异常   </p></blockquote><h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><blockquote><p>java中，处处皆封装   主要表现在三方面？</p><p>1.类就是一个封装体，类中封装的属性，方法   </p><p>2.方法也是一种封装   （方法中封装的是代码）</p><p>Random r&#x3D;new Random();</p><p>r.nextInt(10);</p><p>3.通过访问修饰符可以改变访问权限</p></blockquote><h3 id="访问修饰符"><a href="#访问修饰符" class="headerlink" title="访问修饰符"></a>访问修饰符</h3><table><thead><tr><th align="center"></th><th align="center">类内部</th><th align="center">同包</th><th align="center">不同包的子类</th><th align="center">不同包的非子类</th></tr></thead><tbody><tr><td align="center">private</td><td align="center">是</td><td align="center">否</td><td align="center">否</td><td align="center">否</td></tr><tr><td align="center">default</td><td align="center">是</td><td align="center">是</td><td align="center">否</td><td align="center">否</td></tr><tr><td align="center">protected</td><td align="center">是</td><td align="center">是</td><td align="center">是</td><td align="center">否</td></tr><tr><td align="center">public</td><td align="center">是</td><td align="center">是</td><td align="center">是</td><td align="center">是</td></tr></tbody></table><h3 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h3><h4 id="final"><a href="#final" class="headerlink" title="final"></a>final</h4><blockquote><p>final修饰属性，类，方法<br>它可以修饰，属性，变量，参数，只能赋值一次 不能被修改<br>修饰类：不能被继承<br>修饰方法：不能被重写</p></blockquote><h4 id="static"><a href="#static" class="headerlink" title="static"></a>static</h4><blockquote><p>static修饰属性，说明当前属性是的类属性，只存在一份整个类共享<br>并且可以直接通过类访问。<br>属性：类属性   类名，属性名<br>方法：类方法   </p><p>示例   </p><p>定义一个学生类，为学生自动生成学号，即创建的第一个学生，学号是1，第二个学生，学号是2   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="type">int</span> stuno;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;学号：&quot;</span> + stuno + <span class="string">&quot;,姓名：&quot;</span> + name + <span class="string">&quot;,age:&quot;</span> + age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;王千金&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;王万两&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;王大锤&quot;</span>, <span class="number">19</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>方法：</p><p>1.被static修饰的方法被称为类方法，调用类方法时无须创建对象，可以通过 类名.方法名()来调用   </p><p>2.在static方法中，只能实现静态成员，不能使用非静态成员   </p><p>3.在static方法中，也不能使用this,super关键字   </p><p>static 返回值类型 方法名(){</p><p>&#x2F;&#x2F;方法体   </p><p>}</p></blockquote><h4 id="静态块"><a href="#静态块" class="headerlink" title="静态块"></a>静态块</h4><blockquote><p>static块</p><p>语法：</p><p>static{</p><p>&#x2F;&#x2F;代码   </p><p>}</p><p>什么时执行：当类加载，初使化时，会自动调用静态块中的代码，因为每个类只加载一次，因此static{}只</p><p>被调用一次   </p></blockquote><blockquote><p>加载顺序<br>静态成员和static块<br>👇<br>普通成员和非static块<br>👇<br>构造方法</p></blockquote><blockquote><p>加载顺寻<br>父类静态成员和static块<br>👇<br>子类静态成员和static块<br>👇<br>父类普通成员和非static块<br>👇<br>父类构造方法<br>👇<br>子类普通成员和非static块<br>👇<br>子类构造方法</p></blockquote><h4 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h4><blockquote><p>设计模式：Design partten</p><p>解决某些设计问题所采用的套路，有点类似于三十六计   </p><p>目前设计模式一共有23种   </p><p>一共分为三类   </p><p>1.创建型</p><p>2.结构型</p><p>3.行为型</p></blockquote><p><strong>单例模式：</strong>Singleton</p><blockquote><p>解决的问题：某个类，只允许产生唯一的实例   </p><p>解决的方法</p><p>1.将构造方法定义成私有   </p><p>2.定义一个同类型的静态的属性   </p><p>3.定义一个public的静态方法，用来返回唯一的实例   </p></blockquote><p><strong>单例模式 的两种类型</strong></p><blockquote><p>1.饿汉式   </p><p>2.懒汉式   （lazy）</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Singleton s=<span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line"><span class="comment">/*String name;</span></span><br><span class="line"><span class="comment">String time;*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">/*System.out.println(&quot;创建单例模式: &quot;);</span></span><br><span class="line"><span class="comment">System.out.println(&quot;进程分别有&quot;);</span></span><br><span class="line"><span class="comment">System.out.println(&quot;1&quot;);</span></span><br><span class="line"><span class="comment">System.out.println(&quot;2&quot;);</span></span><br><span class="line"><span class="comment">System.out.println(&quot;3&quot;);</span></span><br><span class="line"><span class="comment">System.out.println(&quot;4&quot;);*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getinstance</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*public void close() &#123;</span></span><br><span class="line"><span class="comment">System.out.println(&quot;关闭程序&quot;);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br></pre></td></tr></table></figure><h1 id="抽象类与接口"><a href="#抽象类与接口" class="headerlink" title="抽象类与接口"></a><strong>抽象类与接口</strong></h1><h2 id="abstract"><a href="#abstract" class="headerlink" title="abstract"></a>abstract</h2><blockquote><p>abstract是一个修饰符</p><p>可以修饰方法和类<br>类：抽象类，不能被实例化<br>方法：抽象方法，让子类重写   如果子类不重写，子类方法也是抽象方法<br>抽象方法没有具体的实现   </p><p>抽象方法只有定义，没有方法的实现<br>如果一个类有抽象方法，那这个类一定是抽象类<br>如果子类不重写方法，那这个子类还是抽象类</p></blockquote><h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><blockquote><p>1.java中不支持继承，但通过接口，可以实现多继承的效果   </p><p>2.接口是一个特殊的抽象类   接口中只能有抽象方法和public static final属性   </p><p>3.接口使用 interface来定义   </p></blockquote><h3 id="接口与类"><a href="#接口与类" class="headerlink" title="接口与类"></a>接口与类</h3><blockquote><p>接口通常代表一种能力，抽象类通常代表一个概念   </p><p>接口：able:</p><p>会飞的</p><p>发光的</p><p>吃肉的</p><p>抽象类：</p><p>动物</p><p>交通工具   </p><p>图形   </p><p>找你妹   </p><p>发光   </p><p>会飞的   </p><p>带尖的   </p><p>交通工具   </p><p>飞机   </p><p>会飞的 a&#x3D;new Plan();</p><p>&#x3D;new 天使();</p><p>&#x3D;new 蝙蝠();</p><p>&#x3D;new 萤火虫();</p></blockquote><h3 id="接口与抽象类的区别"><a href="#接口与抽象类的区别" class="headerlink" title="接口与抽象类的区别"></a><strong>接口与抽象类的区别</strong></h3><blockquote><p>1.接口是一个特殊的抽象类，只有public static final 属性及抽象方法   </p><p>2.一个类只能有一个父类，但一个类可以同时实现多个接口   </p><p>3.类和类之间是单继承 ，但接口和接口之间可以多继承</p><p>interface C extends A,B</p><p>4.抽象类通常表示一个概念，而接口则表示一种能力   </p></blockquote><h3 id="类和类之间的关系"><a href="#类和类之间的关系" class="headerlink" title="类和类之间的关系"></a><strong>类和类之间的关系</strong></h3><blockquote><p>主要有三种   </p><p>1.继承</p><p>2.关联</p><p>3.依赖   </p><p>关联又可以细分为</p><p>1.聚合</p><p>2.组合</p></blockquote><h4 id="继承-1"><a href="#继承-1" class="headerlink" title="继承"></a>继承</h4><blockquote><p>子类拥有父类的属性和方法   </p><p>判断两个类是否是继承关系 is 即 子类 is 父类   </p><p>代码： class 子类 extends 父类｛｝</p></blockquote><h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><blockquote><p>一个类可以实现多个接口   </p><p>代码： class 类 implements 接口   </p></blockquote><h4 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h4><blockquote><p>两个类之间关系是临时发生的，即做某一件事时才产生联系，这种关系就是依赖   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">判断方法 ： use;</span><br><span class="line">代码：</span><br><span class="line">两种形式</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        Spoon s=<span class="keyword">new</span> <span class="title class_">Spoon</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">(Weapon w)</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="关联"><a href="#关联" class="headerlink" title="关联"></a>关联</h4><blockquote><p>关联：一种强依赖，比依赖的关系更强，是一种稳定的关系   </p><p>判断： has</p><p>代码：作为别外一个类的属性来存在   </p></blockquote><h4 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h4><blockquote><p>聚合是关联的一种特例，体现整体和局部的关系    整体和局部之间没有共同的生命周期   </p></blockquote><h4 id="组合"><a href="#组合" class="headerlink" title="组合"></a>组合</h4><blockquote><p>聚合是关联的一种特例，体现整体和局部的关系    整体和局部之间有共同的生命周期   </p></blockquote><h4 id="设计思想"><a href="#设计思想" class="headerlink" title="设计思想"></a>设计思想</h4><blockquote><p>高内聚，低耦合   </p></blockquote><h3 id="内部类"><a href="#内部类" class="headerlink" title="内部类"></a>内部类</h3><p>可以将类的定义放在其它的类中，这种类叫内部类   </p><p>内部类一共有四种，分别是</p><ol><li><p>静态内部类</p></li><li><p>成员内部类</p></li><li><p>匿名内部类</p></li><li><p>方法内部类</p></li></ol><h4 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h4><p>静态内部类可以使用外部类的静态成员</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> a=<span class="number">9</span>;</span><br><span class="line">    String name=<span class="string">&quot;人&quot;</span>;</span><br><span class="line">    <span class="comment">//静态内部类</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">B</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getB</span><span class="params">()</span> &#123;System.out.println(a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestA</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//创建一个内部类的对象   </span></span><br><span class="line">        A.B b=<span class="keyword">new</span> <span class="title class_">A</span>.B();</span><br><span class="line">        b.getB();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="成员内部类"><a href="#成员内部类" class="headerlink" title="成员内部类"></a>成员内部类</h4><p>在一个类的内部定义另外一个类，内部类可以使用外部类的非静态成员</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">    String name=<span class="string">&quot;outer&quot;</span>;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Inner</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getInner</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestA</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//创建一个外部类的对象   </span></span><br><span class="line">        Outer o=<span class="keyword">new</span> <span class="title class_">Outer</span>();</span><br><span class="line"><span class="comment">//创建o的内部类对象</span></span><br><span class="line">        Outer.Inner i=o.<span class="keyword">new</span> <span class="title class_">Inner</span>();</span><br><span class="line">        i.getInner();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法内部类"><a href="#方法内部类" class="headerlink" title="方法内部类"></a>方法内部类</h4><h4 id="匿名内部类"><a href="#匿名内部类" class="headerlink" title="匿名内部类"></a>匿名内部类</h4><p>有时，我们定义了一个内部类，使用这个内部类时，只实例一个对象   此时，就可以将定义类和实例化</p><p>对象，两个操作合到一起，这个就是匿名内部类</p><p>使用匿名类的条件是，此类必须实现一个接口或继承一个抽象类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>定义一个类</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>()&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span>只实体化一次</span><br><span class="line">A a=<span class="keyword">new</span> <span class="title class_">A</span>();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Usb u=<span class="keyword">new</span> <span class="title class_">Usb</span>() &#123;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="keyword">public</span> String <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;这就是匿名内部类，看着有点不舒服。&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;;</span><br><span class="line">c.connect(u);</span><br></pre></td></tr></table></figure><h1 id="常用类"><a href="#常用类" class="headerlink" title="常用类"></a>常用类</h1><h2 id="lang包"><a href="#lang包" class="headerlink" title="lang包"></a>lang包</h2><blockquote><p>lang是java中使用最广泛的包，全称是java.lang  此包不需要手动导入，即可使用此包中的所有类   </p><p>此包中常用的类有   </p><p>System</p><p>Object</p><p>包装类</p><p>Math</p><p>字符串   </p><p>Thread等</p></blockquote><h2 id="System类"><a href="#System类" class="headerlink" title="System类"></a>System类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//System 类包含一些有用的类字段和方法。它不能被实例化。 final修饰的类不能被继承</span></span><br><span class="line"><span class="comment">//常用方法：</span></span><br><span class="line">System.out.println();</span><br><span class="line">System.err.println();</span><br><span class="line">System.in;</span><br><span class="line">System.exit(<span class="number">0</span>);</span><br><span class="line">System.arraycopy()</span><br><span class="line">System.gc()</span><br><span class="line">System.currentTimeMillis()</span><br></pre></td></tr></table></figure><h2 id="包装类"><a href="#包装类" class="headerlink" title="包装类"></a>包装类</h2><blockquote><p>java,为每个基本数据类型都定义了与之对对就的类，这些类就叫包装类   </p><p>Boolean</p><p>Byte,Short,Integer,Long</p><p>Float,Double</p><p>Character</p><p>包装类与基本数据类型是可以相互转换的   </p><p>基本数据类型-》包装类 ：装包</p><p>包装-》基本数据类型： 拆包   </p></blockquote><h2 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h2><blockquote><p>Math类：包含了所有用于几何和三角的浮点运算方法。Math类是final的，其中所有方法都是static的。</p></blockquote><h2 id="object类"><a href="#object类" class="headerlink" title="object类"></a>object类</h2><blockquote><p>Object类是所有类的类的父类   此类中下定义所有类都拥有的方法   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">equals():比较</span><br><span class="line">toString():转成字符串</span><br><span class="line">hashcode():哈希码</span><br><span class="line">getClass():获得当前对象的类   </span><br><span class="line">clone():克隆   </span><br><span class="line">finalize():垃圾回收前执行的方法   </span><br><span class="line">notify()</span><br><span class="line">notifyAll();</span><br><span class="line">wait();</span><br></pre></td></tr></table></figure><h3 id="hashcode方法"><a href="#hashcode方法" class="headerlink" title="hashcode方法"></a>hashcode方法</h3><blockquote><p>hashcode是一个int值   </p><p>即可将任何长度的对象转换成固定长度的数字   </p><p>hashcode的协定   </p><p>1.如一个对象不改变，那么多次调用hashcode()方法，返回的结果应该相同   </p><p>2.如果两个对象相等（equals()），那么两个对象的hashcode()一定相等</p><p>3.如果两对象不相等，那么hashcode也有可能相等，设计时，尽量不相等   </p></blockquote><h3 id="equals方法"><a href="#equals方法" class="headerlink" title="equals方法"></a>equals方法</h3><blockquote><p>boolean equals(Object obj);</p><p>四个特性   </p><p>1.自反性:a.equals(a);  true</p><p>2.对称性:a.equals(b)&#x3D;&#x3D;b.equals(a);</p><p>3.传递性:a.equals(b)&#x3D;true,b.equals(c)&#x3D;true,那么 a.equals(c)&#x3D;true</p><p>4.一致性:a.equasl(b)的值，多次调用时，应该相同   （前提是，a和b都不改变）</p><p>另外 a.equals(null),永远为false</p></blockquote><h3 id="toString方法"><a href="#toString方法" class="headerlink" title="toString方法"></a><em>toString</em>方法</h3><blockquote><p>将对象转成String   </p><p>注意：</p><p>1.如果不重写，那么将会调用父类的方法，内容是 类名@hashcode()的十六进制   </p><p>2.当调用System.out.println(s)方法，会自动调用s.toString()方法   </p></blockquote><h3 id="getClass-方法"><a href="#getClass-方法" class="headerlink" title="**getClass()**方法"></a>**getClass()**方法</h3><blockquote><p>获得对象的类   Class 即，所用同类型的对象返回的是同一个类   </p></blockquote><h3 id="String-类"><a href="#String-类" class="headerlink" title="String 类"></a>String 类</h3><blockquote><p>字符串   Java是常用的类<br>字符串的特点<br>1.字符串是常量，不能改变<br>2.为了提升使用率，java对字符串进行了优化处理，即字符串池（String Pool）</p></blockquote><p>常用的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">length</span><span class="params">()</span>:返回字符串的长度</span><br><span class="line"><span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(<span class="type">int</span>)</span>:返回某个字符位于串中的位置（下标）</span><br><span class="line"><span class="type">int</span> <span class="title function_">lastIndexOf</span><span class="params">(String)</span>:查找最后一个指定子串的位置   </span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>:判断某个字符串是否为空</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">startsWith</span><span class="params">(String)</span>:是否以某个字符串开头</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">endsWith</span><span class="params">(String)</span>:是否以某个字符串结尾</span><br><span class="line">String <span class="title function_">toUpperCase</span><span class="params">()</span>:转成大写</span><br><span class="line">String <span class="title function_">toLowerCase</span><span class="params">()</span>:转成小写   </span><br><span class="line">String <span class="title function_">trim</span><span class="params">()</span>:返回一个去掉前后空格的新串   </span><br><span class="line">String[] split(String);拆分字符串</span><br><span class="line"><span class="type">char</span> <span class="title function_">charAt</span><span class="params">(<span class="type">int</span>)</span>:根据索引找字符   </span><br><span class="line">String <span class="title function_">replaceAll</span><span class="params">(String a,String b)</span>:将字符串中的a都替换成b,并返回一个新的字符串</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(String)</span>:是否包含另外一个子串</span><br></pre></td></tr></table></figure><h3 id="字符串类"><a href="#字符串类" class="headerlink" title="字符串类"></a>字符串类</h3><h4 id="字符串比较方法"><a href="#字符串比较方法" class="headerlink" title="字符串比较方法"></a>字符串比较方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(String)</span> 比较</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">equalsIgnoreCase</span><span class="params">(String)</span> 比较（忽略大小写（英文））</span><br><span class="line"><span class="type">int</span> <span class="title function_">compareto</span><span class="params">(String)</span>  与另一个字符串比较大小</span><br><span class="line"><span class="type">int</span> <span class="title function_">comparetoignoreCase</span><span class="params">()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="字符串池"><a href="#字符串池" class="headerlink" title="字符串池"></a>字符串池</h4><blockquote><p>因为String是java最常用的类，同时此类是常量（一旦定义，不能改变），因此，为了提高效率（节省内存），java中使用字符串池   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String s=<span class="string">&quot;hello&quot;</span>; </span><br><span class="line">String s1=<span class="string">&quot;hello&quot;</span>;</span><br><span class="line">String s2=<span class="string">&quot;hello&quot;</span>; </span><br><span class="line">String s3=<span class="string">&quot;hello&quot;</span>;</span><br></pre></td></tr></table></figure><h4 id="字符串转换"><a href="#字符串转换" class="headerlink" title="字符串转换"></a>字符串转换</h4><blockquote><p>不同的类型之间是否能转换？</p><p>1 基本类型 （可转）c<br>2 不同类之间 需要有继承关系才能转<br>3 如果两个类型之间没有继承关系，有时也可以通过一些方法转换<br>integer parseInt()</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String s=<span class="string">&quot;123&quot;</span>;</span><br><span class="line"><span class="comment">//将String,s转成int类型</span></span><br><span class="line"><span class="type">int</span> i=Integer.parseInt(s);</span><br><span class="line">System.out.println(i);</span><br><span class="line"><span class="comment">//将int 类型的i转换成字符串</span></span><br><span class="line">String s2=String.valueOf(i);</span><br></pre></td></tr></table></figure><h4 id="StringBuffer"><a href="#StringBuffer" class="headerlink" title="StringBuffer"></a><strong>StringBuffer</strong></h4><blockquote><p>1.StringBuffer是字符串缓冲区，与String不同，内容是可以修改的   </p><p>2.StringBuffer支持链式编程</p><p>3.与StringBuilder不同，它是线程安全的   </p><p>4.StringBuffer与String是可以转换的</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StringBuffer-&gt;String; sb.toString();</span><br><span class="line">String-&gt;StringBuffer： StringBuffer sb=<span class="keyword">new</span> <span class="title class_">StringBuffer</span>(String);</span><br></pre></td></tr></table></figure><p>常用方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">StringBuffer <span class="title function_">append</span><span class="params">()</span>:追加</span><br><span class="line">StringBuffer <span class="title function_">insert</span><span class="params">()</span>:插入</span><br><span class="line">StringBuffer <span class="title function_">delete</span><span class="params">(start,end)</span>:删除指定的子串</span><br><span class="line">StringBuffer <span class="title function_">repalace</span><span class="params">(start,end,str)</span>:将指定位置的字符串替换成str</span><br><span class="line">StringBuffer <span class="title function_">reverse</span><span class="params">()</span>:翻转字符串</span><br></pre></td></tr></table></figure><h4 id="StringBuilder"><a href="#StringBuilder" class="headerlink" title="StringBuilder"></a><strong>StringBuilder</strong></h4><blockquote><p>与StringBuffer基本相同，只是线程不安全   </p></blockquote><h1 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h1><h2 id="异常概念"><a href="#异常概念" class="headerlink" title="异常概念"></a><strong>异常概念</strong></h2><blockquote><p>错误主要发生有两种<br>1 编译时发生错误<br>2 运行时错误 叫做异常 </p><p>java的异常分为两类<br>1 error jvm内部错误、资源耗尽<br>2 exception 其他编程错误或偶然的外在因素</p></blockquote><h2 id="异常的体系结构"><a href="#异常的体系结构" class="headerlink" title="异常的体系结构"></a><strong>异常的体系结构</strong></h2><blockquote><p>Throwable<br>Error:错误<br>Exception:异常<br>RuntimeException:运行时异常<br>NullPointerException:空指针异常<br>ClassCastException:类型转换异常<br>ArrayIndexOutOfBoundsException:数组下标越界<br>ArithmeticException:数字异常<br>受检查异常   </p></blockquote><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><blockquote><p>java中处理异常的机制是：抓抛模型   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>-<span class="keyword">catch</span>-<span class="keyword">finally</span></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="comment">//代码1;</span></span><br><span class="line"><span class="comment">//代码2   出现exceptin2;</span></span><br><span class="line"><span class="comment">//代码3：出现exception3;</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception1 e)&#123;</span><br><span class="line"><span class="comment">//处理代码1</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception2 e2)&#123;</span><br><span class="line"><span class="comment">//处理代码2</span></span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="comment">//finally</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h2 id="异常分类"><a href="#异常分类" class="headerlink" title="异常分类"></a>异常分类</h2><blockquote><p>1 运行时异常 runtimeException类和其子类<br>2 受检查异常 非runtimException</p><p>区别：<br>运行时异常编译时可以不处理<br>受检查异常必须得处理</p></blockquote><h2 id="throws"><a href="#throws" class="headerlink" title="throws"></a>throws</h2><blockquote><p>当我们定义一个方法时，如果正确调用，可以返回一个结果，如果错误的调用，则应该抛出一个异常，这时，</p><p>可以使用throws来抛出某种异常的类型   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getCircleArea</span><span class="params">(<span class="type">double</span> r)</span> thrwos Exception&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//MyArray; 10,11</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> <span class="keyword">throws</span> ArrayIndexOutOfBoundsException&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="throw关键字"><a href="#throw关键字" class="headerlink" title="throw关键字"></a>throw关键字</h2><blockquote><p>throw代表：手动抛出一个异常对象   格式是   </p><p>throw new Excpetion();</p><p>throw主要用在方法中   throw有点类似return </p></blockquote><h2 id="throw和throws的区别"><a href="#throw和throws的区别" class="headerlink" title="throw和throws的区别"></a>throw和throws的区别</h2><blockquote><p>throws与throw的区别</p><p>1.throws放在方法后，说明此方法可能抛出某种类型的异常   </p><p>2.throws后，放的是异常类型   </p><p>2.throw 放在方法体中，throw后面放置的是异常对象，说明要手动抛出一个异常   </p></blockquote><h1 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h1><blockquote><p>java.util包，被称为工具包，也是java最常用的一个包</p><p>此包中主要有集合框架，日期，编码解码，国际化等</p></blockquote><h2 id="random类"><a href="#random类" class="headerlink" title="random类"></a>random类</h2><blockquote><p>Random类是随机数生成器，提供了很多用于生成各种类型的随机数的方法</p></blockquote><h2 id="Date-类"><a href="#Date-类" class="headerlink" title="Date 类"></a>Date 类</h2><blockquote><p>Date类主用来存储时间，精确到毫秒，内部是通过一个long值来进行存储的</p></blockquote><h2 id="Calendar"><a href="#Calendar" class="headerlink" title="Calendar"></a><strong>Calendar</strong></h2><blockquote><p>日历类：主要用来处理时间，例如，获取时间的某个部分，改变时间的某个部分   对时间进行加减操作等 </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>实例化   </span><br><span class="line">Calendar c=Calendar.getInstance();</span><br><span class="line"><span class="number">2.</span>Date与Calendar的转换</span><br><span class="line">Calendar-&gt;Date c.getTime();</span><br><span class="line">date-&gt;Calendar c.setTime(date);</span><br><span class="line"><span class="number">3.</span>操作时间</span><br><span class="line">获得某个部分   </span><br><span class="line"><span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> )</span></span><br><span class="line">Calendar.YEAR=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="SimpleDateFormat"><a href="#SimpleDateFormat" class="headerlink" title="SimpleDateFormat"></a><strong>SimpleDateFormat</strong></h2><blockquote><p>SimpleDateFormat类是日期格式化的类，可以用来将指定格式的之符串转成Date，也可以将Date转换成指</p><p>定格式的字符串   </p><p>用法</p><p>1.先实例化一个对象</p><p>​     SimpleDateFormat sdf&#x3D;new SimpleDateFormat(“yyyy-MM-dd”);</p><p>2.使用 parse方法将字符串转成日期</p><p>​     Date d&#x3D;sdf.parse(str);</p><p>3.使用format方法将日期转成字符串</p><p>​     String str&#x3D;sdf.format(data);</p></blockquote><h1 id="集合框架"><a href="#集合框架" class="headerlink" title="集合框架"></a>集合框架</h1><h2 id="集合框架-1"><a href="#集合框架-1" class="headerlink" title="集合框架"></a>集合框架</h2><blockquote><p>集合：集合也被称为容器，也是一个对象，此对象中可以管理其它的对象（element）元素   例如数组就是一</p><p>个集合   </p><p>集合框架：java中给我提供了很多集合类，接口和算法类，作为一个整体，被称为集合框架</p></blockquote><p><img src="https://s3.bmp.ovh/imgs/2023/02/25/4736ba1bd8ccacc3.png"></p><p>集合框架有两个顶层接口，所有的集合类都是这两个接口的实现</p><h2 id="Collection接口"><a href="#Collection接口" class="headerlink" title="Collection接口"></a><strong>Collection</strong>接口</h2><blockquote><p>1.是集合框架的顶层接口之一，没有直接的实现类   </p><p>2.Collection有三个子接口，分别是List,Set,Queue;</p><p>3.三个子接口的特点如下   </p><p>List:有序（有索引），可重复   </p><p>Set:无序，不可重复   </p><p>Queue:先进先出</p></blockquote><p>Collection接口应该有什么方法？</p><blockquote><p>CURD</p><p>boolean add(E):增加一个元素</p><p>boolean addAll(Collection):增加多个元素</p><p>void clear():清空</p><p>boolean isEmpty():是否为空</p><p>int size():返回元素的个数</p><p>boolean remove(E):删除一个元素</p><p>boolean removeAll(Collection):删除多个元素</p><p>boolean retainAll(Collection):保留多个元素</p><p>boolean contains(E):是否包含某个元素</p><p>boolean containsAll(Collection):是否包含某些元素</p><p>Object[] toArray():将集合中的元素转成数组返回</p></blockquote><p>所有集合类中存储的不是对象本身，而是一个引用而已</p><h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><blockquote><p>泛型指的是数据类型的参数化   </p><p>泛型可以解决两个问题</p><p>1.类型安全检查</p><p>2.消除强制类型转换</p><p>java中，集合框架中的集合类都支持泛型</p></blockquote><p>如何使用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Person&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Person&gt;();</span><br></pre></td></tr></table></figure><h2 id="算法类"><a href="#算法类" class="headerlink" title="算法类"></a>算法类</h2><blockquote><p>集合框架中除了提供接口和实现类之外，还提供用于处理集合的算法类，算法类主要有</p><p>Collections:用于处理集合的算法类   </p><p>Arrays:用于处理数组的算法类   </p></blockquote><p>Collections常用的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(List)</span>:对List中的元素按自然顺序进行排序   </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(List)</span>:翻转集合中元素</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">shuffle</span><span class="params">(List)</span>:洗牌   （打乱顺序）</span><br><span class="line"><span class="keyword">static</span> E <span class="title function_">max</span><span class="params">(Collection)</span>:获取最大的元素</span><br><span class="line"><span class="keyword">static</span> E <span class="title function_">min</span><span class="params">(Collection)</span>:获取最小的元素   </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addAll</span><span class="params">(Collection coll,T...t)</span>:向coll中增加多个元素   </span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="title function_">binarySearch</span><span class="params">(List)</span>:二分查找   </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">copy</span><span class="params">(List desc,List src)</span>:复制</span><br></pre></td></tr></table></figure><p>Arrays常用的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> List <span class="title function_">asList</span><span class="params">(T...t)</span>:创建一个List，将添加多个元素</span><br><span class="line"><span class="keyword">static</span> T <span class="title function_">binarySearch</span><span class="params">()</span>:二分查找</span><br><span class="line"><span class="keyword">static</span> T[] copyRange(<span class="type">int</span>[],start,end);</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span>;</span><br><span class="line"><span class="keyword">static</span> String <span class="title function_">toString</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><h2 id="Comparable"><a href="#Comparable" class="headerlink" title="Comparable"></a><strong>Comparable</strong></h2><blockquote><p>Comparable是自然排序的接口，实现此接口的类，就拥有了比较大小的能力</p><p>此接口中的方法只有一个</p><p>public int comparareTo(T t){</p><p>}</p><p>返回值说明   </p><p>正数：当前对象与比t大</p><p>0：当前对象与t相等</p><p>负数：当前对象比t小</p></blockquote><h2 id="Comparator"><a href="#Comparator" class="headerlink" title="Comparator"></a><strong>Comparator</strong></h2><blockquote><p>自定义的比较器   </p><p>Comparator接口中包含一个方法</p></blockquote><blockquote><p>Comparator与Comparable的区别</p><p>1.Comparable为可排序的，也被称为自然排序或内部比较器，实现该接口的类的对象自动拥有可排序功能。</p><p>2.Comparator为比较器，也被称为外部比较器，实现该接口可以定义一个针对某个类的排序方式。</p><p>3.Comparator与Comparable同时存在的情况下，前者优先级高</p></blockquote><h2 id="ArrayList源码分析"><a href="#ArrayList源码分析" class="headerlink" title="ArrayList源码分析"></a><strong>ArrayList</strong>源码分析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Object[]elementData; <span class="comment">//定义一个Object数组，用来存储数组的元素，此数组可以扩</span></span><br><span class="line">容   </span><br><span class="line"><span class="comment">//2.构造方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.elementData=DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//给一个初使长度</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> initialCapacity)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(initialCapacity&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.elementData=<span class="keyword">new</span> <span class="title class_">Object</span>[initialCapacity];</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(initialCapacity==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.elementData=EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal Capacity: &quot;</span>+</span><br><span class="line">                initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3.add方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span>&#123;modCount++;</span><br><span class="line">    add(e,elementData,size);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e,Object[]elementData,<span class="type">int</span> s)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s==elementData.length)</span><br><span class="line">        elementData=grow();</span><br><span class="line">    elementData[s]=e;</span><br><span class="line">    size=s+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数组总结"><a href="#数组总结" class="headerlink" title="数组总结"></a>数组总结</h3><blockquote><p>数组的特点：元素之间的地址是连续的   </p><p>get(index):时间复杂度是O(1)</p><p>set(index,E):O(1)</p><p>add(index,E):时间复杂度是O(n)</p><p>remove(index):O(n)</p></blockquote><h2 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//内部结节</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt; &#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = element;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">        <span class="built_in">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a><strong>Stack</strong></h2><blockquote><p>Stack是栈  特点是先进后出 </p><p>​       LIFO：last in first out</p><p>方法:</p><p>​      push:压栈  </p><p>​      pop:弹出</p><p>​       peek:获得栈顶的元素</p><p>栈的用途：</p><p>悔棋</p><p>撤销</p><p>方法的调用</p></blockquote><h2 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a><strong>Queue</strong></h2><blockquote><p>Queue是一个队列，它的特点是先进先出（FIFO）</p></blockquote><h2 id="双端队列"><a href="#双端队列" class="headerlink" title="双端队列"></a>双端队列</h2><blockquote><p>Deque &#x3D;dubole ended queue</p><p>两端都可以插入和删除元素   </p><p>方法如下   </p><p>​    addFirst</p><p>​    addLast</p><p>​    removeFist</p><p>​    removeLast</p><p>​    offerFirst</p><p>​    offerLast</p><p>​    pollFirst</p><p>​    pollLast</p></blockquote><h1 id="集合框架2"><a href="#集合框架2" class="headerlink" title="集合框架2"></a>集合框架2</h1><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><blockquote><p>Set:是Collection的子接口，无序，不可重复</p><p>三个主要的实现类   </p><p>HashSet:hash</p><p>LinkedHashList:有顺序   </p><p>TreeSet:排序的，内部是树   </p></blockquote><h2 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a><strong>Iterator</strong></h2><blockquote><p>迭代器   用来从所有的Collection集合中遍历数组   提供三个方法   </p><p>boolean hasNext():是否有下一个未遍历到的元素   </p><p>E next():取出一个元素   </p><p>void remove():删除正在取出的元素   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码模版如下   </span></span><br><span class="line">Iteartor ite=collection.iterator();</span><br><span class="line">    <span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">    E e=ite.next();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LinkedHashSet"><a href="#LinkedHashSet" class="headerlink" title="LinkedHashSet"></a><strong>LinkedHashSet</strong></h2><blockquote><p>LinkedHashSet是对HashSet的扩展，内部也是一个HashSet,但是按存入的顺序进行排列的</p><p>LinkdeHashSet中的元素也是不可重复的</p></blockquote><h2 id="SortedSet"><a href="#SortedSet" class="headerlink" title="SortedSet"></a><strong>SortedSet</strong></h2><blockquote><p>SortedSet:是Set的子接口，具备排序的能力   </p><p>TreeSet：是SortedSet的实现类，内部是一个树结构</p></blockquote><p><img src="https://s3.bmp.ovh/imgs/2023/02/25/0f0daa7cf5dd4d9f.png"></p><h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a><strong>Map</strong></h2><blockquote><p>1.Map是集合框架中的另一个顶层接口  Map结构的特点是 kev-value</p><p>2.集合中，key 是不可以重复的</p><p>3.key 和 value的类型都是引用类型</p></blockquote><p>常用方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">put(k,v):增加一对元素</span><br><span class="line">putAll(Map):将map中的所有元素增加到集合中</span><br><span class="line">v <span class="title function_">get</span><span class="params">(k)</span>:根据key,来查找value</span><br><span class="line"><span class="title function_">remove</span><span class="params">(k)</span>:根据key,来删除元素（key-value）</span><br><span class="line"><span class="type">int</span> <span class="title function_">size</span><span class="params">()</span>:获取集合中元素的个数</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span>:是否为空</span><br><span class="line">clear():清空</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">containsKey</span><span class="params">(k)</span>:是否包含某个key</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">containsValue</span><span class="params">(v)</span>:是否包含某个value</span><br><span class="line">#遍历</span><br><span class="line">Set <span class="title function_">keySet</span><span class="params">()</span>:得到所有的key的集合</span><br><span class="line">Collection <span class="title function_">values</span><span class="params">()</span>:获得所有value的集合</span><br><span class="line">entrySet():获得所有的元素的集合（Entry(key,value)）</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//遍历的示例</span></span><br><span class="line">    Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Integer, String&gt;();</span><br><span class="line"><span class="comment">//增加</span></span><br><span class="line">   map.put(<span class="number">1</span>,<span class="string">&quot;james&quot;</span>);</span><br><span class="line">   map.put(<span class="number">2</span>,<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">   map.put(<span class="number">3</span>,<span class="string">&quot;james&quot;</span>);</span><br><span class="line">   map.put(<span class="number">4</span>,<span class="string">&quot;owen&quot;</span>);</span><br><span class="line">   map.put(<span class="number">3</span>,<span class="string">&quot;scott&quot;</span>);</span><br><span class="line">    <span class="comment">//1.如何遍历集合   keySet</span></span><br><span class="line">    Set&lt;Integer&gt; set = map.keySet();</span><br><span class="line">System.out.println(set);</span><br><span class="line"><span class="keyword">for</span>(</span><br><span class="line">    Integer k:set)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(k + <span class="string">&quot;:&quot;</span> + map.get(k));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.values</span></span><br><span class="line">    Collection&lt;String&gt; coll = map.values();</span><br><span class="line"><span class="keyword">for</span>(</span><br><span class="line">    String s:coll)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line">    <span class="comment">//3.key-value</span></span><br><span class="line">    Set&lt;Entry&lt;Integer, String&gt;&gt; es = map.entrySet();</span><br><span class="line"><span class="keyword">for</span>(</span><br><span class="line">    Entry&lt;Integer, String&gt; e:es)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(e.getKey() + <span class="string">&quot;:&quot;</span> + e.getValue());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="HashMap的内部结构"><a href="#HashMap的内部结构" class="headerlink" title="HashMap的内部结构"></a><strong>HashMap</strong>的内部结构</h2><blockquote><p>1.key-value在内部被封装成了一个内部类 Node</p><p>2.HashMap中定义了一个Node类型的数组用来保存元素</p><p>3.Node还是一个单向链表   当链表中的元素超过8时，则转换成红黑树</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K,V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>.Entry&lt;K,V&gt; &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key; <span class="comment">//key</span></span><br><span class="line">    V value; <span class="comment">//value</span></span><br><span class="line">    Node&lt;K,V&gt; next; <span class="comment">//下一个节点，Node是封装了key和value,同时也是一个单向链表   </span></span><br><span class="line">    Node(<span class="type">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.hash = hash;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table; <span class="comment">//将所有的key-value对，即node，都存在table中，table是一个数组</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//put方法</span></span><br><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent,</span></span><br><span class="line"><span class="params">                   <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line">        Node&lt;K, V&gt;[] tab; <span class="comment">//table的引用</span></span><br><span class="line">        Node&lt;K, V&gt; p; <span class="comment">//元素中的首个Node节点   </span></span><br><span class="line">        <span class="type">int</span> n; <span class="comment">//table的长度</span></span><br><span class="line">        <span class="type">int</span> i; <span class="comment">//元素的下标   通过hash后，模运行（实际是 (n - 1) &amp; hash]）</span></span><br><span class="line">        <span class="keyword">if</span> ((tab = table) == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">            n = (tab = resize()).length; <span class="comment">//重新分配长度，算出tal的长度</span></span><br><span class="line"><span class="comment">//如果元素中无值，则将Node放在索引为i的下标下   </span></span><br><span class="line">        <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="literal">null</span>)</span><br><span class="line">            tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;K, V&gt; e; <span class="comment">//如果有相同的key,e存储的是重复节点的引用   </span></span><br><span class="line">            K k;</span><br><span class="line"><span class="comment">//如果元素中的首Node与新节点相同   则</span></span><br><span class="line">            <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                e = p;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode) <span class="comment">//如果是树结点，则使用树节点的方式查找   </span></span><br><span class="line">                e = ((TreeNode&lt;K, V&gt;) p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line">            <span class="keyword">else</span> &#123;<span class="comment">//遍历链表，如果有重复的，将重复的节点赋值给e,并break,否则，将新节点加到</span></span><br><span class="line">                链表尾部</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;<span class="comment">//链表中最后一个结点</span></span><br><span class="line">                        p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line"><span class="comment">//如果长度大于8，则转成树</span></span><br><span class="line">                        <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                            treeifyBin(tab, hash);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"><span class="comment">//如果有重复的，则不再比较</span></span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                            ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    p = e;<span class="comment">//指向链表的下一个元素，用来遍历   </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123; <span class="comment">// existing mapping for key 如果有重复的，进行替换</span></span><br><span class="line">                <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">                <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>)<span class="comment">//根据onlyIfAbsend决定是否替</span></span><br><span class="line">                    换</span><br><span class="line">                e.value = value;</span><br><span class="line">                afterNodeAccess(e);</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ++modCount;</span><br><span class="line">        <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">            resize();</span><br><span class="line">        afterNodeInsertion(evict);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="Hashtable"><a href="#Hashtable" class="headerlink" title="Hashtable"></a><strong>Hashtable</strong></h2><blockquote><p>Hashtable 是一个古老的 Map 实现类，不建议使用</p><p>Hashtable 是一个线程安全的 Map 实现，但 HashMap 是线程不安全的。</p><p>Hashtable 不允许使用 null 作为 key 和 value，而 HashMap 可以</p></blockquote><h2 id="TreeMap"><a href="#TreeMap" class="headerlink" title="TreeMap"></a><strong>TreeMap</strong></h2><blockquote><p>TreeMap 存储 Key-Value 对时，需要根据 Key 对 key-value 对进行排序。TreeMap 内部是同红黑</p><p>树来实现的。</p><p>TreeMap 的 Key 的排序：</p><p>自然排序：TreeMap 的所有的 Key 必须实现 Comparable 接口，而且所有的 Key 应该是同一个类的对</p><p>象，否则将会抛出 ClasssCastException</p><p>定制排序：创建 TreeMap 时，传入一个 Comparator 对象，该对象负责对 TreeMap 中的所有 key 进</p><p>行排序。此时不需要 Map 的 Key 实现 Comparable 接口</p></blockquote><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elasticsearch 入门</title>
      <link href="/2023/02/24/Elasticsearch_%E5%85%A5%E9%97%A8/"/>
      <url>/2023/02/24/Elasticsearch_%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="Elasticsearch-入门"><a href="#Elasticsearch-入门" class="headerlink" title="Elasticsearch 入门"></a>Elasticsearch 入门</h2><p>由于工作需要，所以不得不接触es。而且还要我写相关的工具类，虽然说照葫芦画瓢容易，但是了解到这个东西之后，就想好好学习以下。当然了也算作我的个人笔记，大部分都是看官方文章的记录，所以不会标注版权什么的，官方链接下面会有，想深入了解可以去看看。</p><h3 id="es介绍"><a href="#es介绍" class="headerlink" title="es介绍"></a>es介绍</h3><blockquote><p>Elasticsearch是一个搜索引擎</p></blockquote><p>下面简称为es</p><blockquote><p>Elasticsearch 是一个分布式、免费和开放的搜索和分析引擎，适用于所有类型的数据，包括文本、数字、地理空间、结构化和非结构化数据。 Elasticsearch 基于 Apache Lucene 构建，并于 2010 年由 Elasticsearch N.V. 首次发布（现在称为 Elastic）。Elasticsearch 以其简单的 REST API、分布式特性、速度和可扩展性而闻名，是 Elastic Stack 的核心组件，Elastic Stack 是一组用于数据摄取、丰富、存储、分析和可视化的免费开放工具。 通常被称为 ELK Stack。</p></blockquote><p>上面是官方原话，感兴趣的可以去看看。链接贴在这里</p><p><a href="https://elasticstack.blog.csdn.net/article/details/98871531">Elasticsearch 简介</a></p><h3 id="es能做什么？"><a href="#es能做什么？" class="headerlink" title="es能做什么？"></a>es能做什么？</h3><blockquote><p>Elasticsearch 的速度和可扩展性及其为多种类型的内容编制索引的能力意味着它可用于多种用例：</p><p>应用搜索，比如我们常见的 github，linkedin，滴滴，美团，抖音，点评，音乐，视频，银行，证券，保险，电信 app 里的搜索<br>网站搜索<br>企业搜索<br>日志记录和日志分析<br>基础设施指标和容器监控<br>应用性能监控<br>地理空间数据分析和可视化<br>安全分析<br>商业分析</p></blockquote><p>公司平常就用这个存一些数据，比如日志什么。速度确实快</p><h4 id="es安装"><a href="#es安装" class="headerlink" title="es安装"></a>es安装</h4><p>公司用的是Linux，所以下面我会贴出win和Linux的安装方法。</p><h4 id="Java（JVM）版本"><a href="#Java（JVM）版本" class="headerlink" title="Java（JVM）版本"></a>Java（JVM）版本</h4><blockquote><p>Elasticsearch是使用Java构建的，包括JDK维护者的OpenJDK捆绑版本（GPLv2 + CE）。 在每个分布中。捆绑的 JVM 是推荐的 JVM 和 位于 Elasticsearch 主目录的目录中。jdk要使用您自己的 Java 版本，请设置环境变量。 如果必须使用与捆绑的 JVM 不同的 Java 版本。请看supported LTS version of Java</p></blockquote><p><img src="https://s3.bmp.ovh/imgs/2023/02/24/db05e724e6b8ad0e.png"></p><p>尽量选择LTS</p><h4 id="Windows安装"><a href="#Windows安装" class="headerlink" title="Windows安装"></a>Windows安装</h4><p>从该位置下载.zip 文件</p><p><a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.3.1-windows-x86_64.zip">地址</a></p><p>下载完找个舒服的地方解压就行惹</p><p><img src="https://s3.bmp.ovh/imgs/2023/02/24/a93cdd18e8c37f50.png"></p><p>在bin目录下找到 <code>elasticsearch.bat</code> 启动就好了。也可以通过cmd来启动，不过最好用管理员权限打开喔</p><p>然后我们在浏览器或者postman上面输入 <code>http://localhost:9200/</code> 会出现以下信息</p><p><img src="https://s3.bmp.ovh/imgs/2023/02/24/04571b8c08ba9a1b.png"></p><p>其中config里面的 <code>elasticsearch.yml</code> 是配置文件 里面的</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network.host:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure><p>如果你想让其他人访问es 可以改成0.0.0.0，这样会绑定成任意IP 而非localhost 。这里和redis改bind差不多</p><h4 id="Linux安装"><a href="#Linux安装" class="headerlink" title="Linux安装"></a>Linux安装</h4><p>下载：<a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-oss-7.3.0-linux-x86_64.tar.gz">地址</a></p><ol><li><p>创建用户</p><p>es禁止root用户启动，所以我们创建一个新用户es</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adduser es</span><br><span class="line"><span class="comment">#修改密码</span></span><br><span class="line">passwes</span><br></pre></td></tr></table></figure></li><li><p>创建es的数据、日志目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建日志目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /data/elasticsearch/logs</span><br><span class="line"></span><br><span class="line"><span class="comment">#授权</span></span><br><span class="line"><span class="built_in">chown</span> es:es -R /data/</span><br></pre></td></tr></table></figure></li><li><p>解压es安装包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf elasticsearch-oss-7.3.0-linux-x86_64.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>授权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> es:es -R /opt/elasticsearch-oss-7.3.0-linux-x86_64</span><br></pre></td></tr></table></figure><p>将权限都给es这个用户</p></li><li><p>修改yml</p><p>在elasticsearch.yml中修改下面属性</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 集群名称</span></span><br><span class="line"><span class="attr">cluster.name:</span> <span class="string">ihbe-cluster</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 节点名称,其余两个节点分别为node-2 和node-3，别一样 （集群）</span></span><br><span class="line"><span class="attr">node.name:</span> <span class="string">node-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定该节点是否有资格被选举成为master节点，默认为true （集群）</span></span><br><span class="line"><span class="attr">node.master:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># 允许该节点存储数据(默认开启)</span></span><br><span class="line"><span class="attr">node.data:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 索引数据的存储路径</span></span><br><span class="line"><span class="attr">path.data:</span> <span class="string">/data/elasticsearch/data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 日志文件的存储路径</span></span><br><span class="line"><span class="attr">path.logs:</span> <span class="string">/data/elasticsearch/logs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绑定当前机器节点的IP地址, 其他节点配置自己的IP地址</span></span><br><span class="line"><span class="attr">network.host:</span> <span class="string">*.*.*.*</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置对外服务的http端口，默认为9200</span></span><br><span class="line"><span class="attr">http.port:</span> <span class="number">9200</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置节点间交互的tcp端口,默认为9300</span></span><br><span class="line"><span class="attr">transport.tcp.port:</span> <span class="number">9300</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#集群的所有机器节点的IP地址</span></span><br><span class="line"><span class="string">discovery.zen.ping.unicast.hosts:[&quot;*.*.*.*&quot;,&quot;*.*.*.*&quot;,&quot;*.*.*.*&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过配置大多数节点(符合主节点数/ 2 + 1)来防止分裂。</span></span><br><span class="line"><span class="attr">discovery.zen.minimum_master_nodes:</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置为true锁住内存。因为内存交换到磁盘对服务器性能是致命的</span></span><br><span class="line"><span class="attr">bootstrap.memory_lock:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>修改jvm启动项</p><p>进入config，找到<code>jvm.options</code> vi进入编辑</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置ES占用物理内存大小，根据具体机器本身大小来定，一半物理内存</span></span><br><span class="line"><span class="attr">-Xms20g</span></span><br><span class="line"></span><br><span class="line"><span class="attr">-Xmx20g</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 修正CVE-2021-44228漏洞</span></span><br><span class="line"></span><br><span class="line"><span class="attr">-Dlog4j2.formatMsgNoLookups</span>=<span class="string">true   </span></span><br></pre></td></tr></table></figure></li><li><p>(集群) 拷贝目录到其他节点</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /opt/elasticsearch root@*.*.*.*:/opt/</span><br></pre></td></tr></table></figure><p>注意这里的文件夹，是你安装的文件夹名，我这里简写了。不要直接复制改一改名字。<br><code>同时重复第5步操作，将yml里面的network.host</code>改成当前服务器的ip，然后<code>找到node.name:</code>改成其他名字，（与其他节点不重复）</p></li><li><p>启动服务<br>到安装es的节点下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/elasticsearch -d -p pid</span><br></pre></td></tr></table></figure><p>使用jps看是否启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure></li><li><p>验证</p><p>在任意的服务器上面<br>验证集群</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET <span class="string">&#x27;http://*.*.*.*:9200/_cat/nodes?pretty&#x27;</span></span><br></pre></td></tr></table></figure><p>如果能正确显示每个节点ip则成功</p><p>查询集群状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET <span class="string">&#x27;http://*.*.*.*:9200/_cluster/nodes?pretty&#x27;</span></span><br></pre></td></tr></table></figure><p>在返回的json中，看<code>status</code>的值<br><code>-green</code>  正常，表示集群一切正常。<br><code>-yellow</code>  黄表示集群不可靠但可用，一般单节时候就是这个状态。<br><code>-red</code>  红表示集群不可用，有故障。</p><p>关闭es</p><p>使用jps查询进程ID<br>然后kill -9</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elasticsearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客基础用法</title>
      <link href="/2023/02/23/%E5%8D%9A%E5%AE%A2%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/"/>
      <url>/2023/02/23/%E5%8D%9A%E5%AE%A2%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>这一篇主要讲解写文章所需要的一些配置</p><p>1.运行<code>hexo new 博客名</code></p><p>2.复制显示的路径，使用 <code>xdg-open 路径</code> 来编辑它</p><p>3.运行<code>hexo generate</code></p><p>4.运行<code>hexo deploy</code> 然后就可以看新写的博客了</p><h2 id="Front-matter"><a href="#Front-matter" class="headerlink" title="Front-matter"></a>Front-matter</h2><ul><li><h3 id="Page-Front-matter-用于页面配置"><a href="#Page-Front-matter-用于页面配置" class="headerlink" title="Page Front-matter 用于页面配置"></a>Page Front-matter 用于页面配置</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">updated:</span><br><span class="line">type:</span><br><span class="line">comments:</span><br><span class="line">description:</span><br><span class="line">keywords:</span><br><span class="line">top<span class="emphasis">_img:</span></span><br><span class="line"><span class="emphasis">mathjax:</span></span><br><span class="line"><span class="emphasis">katex:</span></span><br><span class="line"><span class="emphasis">aside:</span></span><br><span class="line"><span class="emphasis">aplayer:</span></span><br><span class="line"><span class="emphasis">highlight_</span>shrink:</span><br><span class="line">---</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">解释</th><th align="center">用法</th></tr></thead><tbody><tr><td align="center">updated</td><td align="center">【可选】页面更新日期</td></tr><tr><td align="center">description</td><td align="center">【可选】页面描述</td></tr><tr><td align="center">keywords</td><td align="center">【可选】页面关键字</td></tr><tr><td align="center">comments</td><td align="center">【可选】显示页面评论模块(默认 true)</td></tr><tr><td align="center">top_img</td><td align="center">【可选】页面顶部图片</td></tr><tr><td align="center">mathjax</td><td align="center">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">kates</td><td align="center">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">aside</td><td align="center">【可选】显示侧边栏 (默认 true)</td></tr><tr><td align="center">aplayer</td><td align="center">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="center">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td></tr></tbody></table></li><li><h3 id="Post-Front-matter-用于页面配置"><a href="#Post-Front-matter-用于页面配置" class="headerlink" title="Post Front-matter 用于页面配置"></a>Post Front-matter 用于页面配置</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">updated:</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">keywords:</span><br><span class="line">description:</span><br><span class="line">top<span class="emphasis">_img:</span></span><br><span class="line"><span class="emphasis">comments:</span></span><br><span class="line"><span class="emphasis">cover:</span></span><br><span class="line"><span class="emphasis">toc:</span></span><br><span class="line"><span class="emphasis">toc_</span>number:</span><br><span class="line">toc<span class="emphasis">_style_</span>simple:</span><br><span class="line">copyright:</span><br><span class="line">copyright<span class="emphasis">_author:</span></span><br><span class="line"><span class="emphasis">copyright_</span>author<span class="emphasis">_href:</span></span><br><span class="line"><span class="emphasis">copyright_</span>url:</span><br><span class="line">copyright<span class="emphasis">_info:</span></span><br><span class="line"><span class="emphasis">mathjax:</span></span><br><span class="line"><span class="emphasis">katex:</span></span><br><span class="line"><span class="emphasis">aplayer:</span></span><br><span class="line"><span class="emphasis">highlight_</span>shrink:</span><br><span class="line"><span class="section">aside:</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure></li></ul><table><thead><tr><th align="center">解释</th><th align="center">用法</th></tr></thead><tbody><tr><td align="center">title</td><td align="center">【必需】文章标题</td></tr><tr><td align="center">date</td><td align="center">【必需】文章创建日期</td></tr><tr><td align="center">updated</td><td align="center">【可选】文章更新日期</td></tr><tr><td align="center">tags</td><td align="center">【可选】文章标籤</td></tr><tr><td align="center">categories</td><td align="center">【可选】文章分类</td></tr><tr><td align="center">keywords</td><td align="center">【可选】文章关键字</td></tr><tr><td align="center">description</td><td align="center">【可选】文章描述</td></tr><tr><td align="center">top_img</td><td align="center">【可选】文章顶部图片</td></tr><tr><td align="center">cover</td><td align="center">【可选】文章缩略图(如果没有设置top_img,文章页顶部将显示缩略图，可设为   false&#x2F;图片地址&#x2F;留空)</td></tr><tr><td align="center">comments</td><td align="center">【可选】显示文章评论模块(默认 true)</td></tr><tr><td align="center">toc</td><td align="center">【可选】显示文章TOC(默认为设置中toc的enable配置)</td></tr><tr><td align="center">toc_number</td><td align="center">【可选】显示toc_number(默认为设置中toc的number配置)</td></tr><tr><td align="center">toc_style_simple</td><td align="center">【可选】显示 toc 简洁模式</td></tr><tr><td align="center">copyright</td><td align="center">【可选】显示文章版权模块(默认为设置中post_copyright的enable配置)</td></tr><tr><td align="center">copyright_author</td><td align="center">【可选】文章版权模块的文章作者</td></tr><tr><td align="center">copyright_author_href</td><td align="center">【可选】文章版权模块的文章作者链接</td></tr><tr><td align="center">copyright_url</td><td align="center">【可选】文章版权模块的文章连结链接</td></tr><tr><td align="center">copyright_info</td><td align="center">【可选】文章版权模块的版权声明文字</td></tr><tr><td align="center">mathjax</td><td align="center">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">katex</td><td align="center">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">aplayer</td><td align="center">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="center">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td></tr><tr><td align="center">aside</td><td align="center">【可选】显示侧边栏 (默认 true)</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
